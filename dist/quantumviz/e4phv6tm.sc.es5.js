/*! Built with http://stenciljs.com */
quantumviz.loadBundle("e4phv6tm",["exports","./chunk-0497819c.js","./chunk-e262070a.js","./chunk-12ee72ee.js"],function(t,e,i,a){var s=window.quantumviz.h,n=function(){function t(){this.alone=!0,this.unit="",this.type="line",this.chartTitle="",this.responsive=!1,this.showLegend=!1,this.data="[]",this.hiddenData="[]",this.options="{}",this.width="",this.height="",this.config="{}",this.xView="{}",this.yView="{}",this._mapIndex={},this._xSlider={element:null,min:0,max:0},this._ySlider={element:null,min:0,max:0},this._config={rail:{class:""},cursor:{class:""}}}return t.prototype.toBase64Image=function(){return this._chart.toBase64Image()},t.prototype.redraw=function(t,e){e!==t&&this.drawChart()},t.prototype.changeScale=function(t,e){if(e!==t){var i=JSON.parse(t);"timestamp"===i.time.timeMode?(this._chart.options.scales.xAxes[0].time.stepSize=i.time.stepSize,this._chart.options.scales.xAxes[0].time.unit=i.time.unit,this._chart.options.scales.xAxes[0].time.displayFormats.millisecond=i.time.displayFormats,this._chart.update()):(this._chart.options.scales.xAxes[0].time.stepSize=i.time.stepSize,this._chart.options.scales.xAxes[0].time.unit=i.time.unit,this._chart.update())}},t.prototype.hideData=function(t,e){var a=this;if(e!==t){var s=i.GTSLib.cleanArray(JSON.parse(t));Object.keys(this._mapIndex).forEach(function(t){a._chart.getDatasetMeta(a._mapIndex[t]).hidden=!!s.find(function(e){return e===t})}),this._chart.update()}},t.prototype.changeXView=function(){var t=JSON.parse(this.xView);this._chart.options.scales.xAxes[0].time.min=e.moment(t.min,"x"),this._chart.options.scales.xAxes[0].time.max=e.moment(t.max,"x"),this._chart.update()},t.prototype.changeYView=function(){var t=JSON.parse(this.yView);this._chart.options.scales.yAxes[0].ticks.min=t.min,this._chart.options.scales.yAxes[0].ticks.max=t.max,this._chart.update()},t.prototype.drawChart=function(){var t=this.el.shadowRoot.querySelector("#myChart");if(JSON.parse(this.data)){var i=this.gtsToData(JSON.parse(this.data)),a=this,s={animation:!1,legend:{display:!1},tooltips:{mode:"x",position:"nearest",custom:function(t){t.opacity>0?a.pointHover.emit({x:t.dataPoints[0].x+15,y:this._eventPosition.y}):a.pointHover.emit({x:-100,y:this._eventPosition.y})}},scales:{xAxes:[{time:{min:e.moment(this.timeMin?this.timeMin:i.ticks[0],"x"),max:e.moment(this.timeMax?this.timeMax:i.ticks[i.ticks.length-1],"x"),unit:"day"},type:"time"}],yAxes:[{afterFit:function(t){t.width=100},scaleLabel:{display:!0,labelString:this.unit}}]},responsive:this.responsive,zoom:{enabled:!0,drag:!1,sensitivity:.5,mode:"x"}};"spline"===this.type&&(s.elements={line:{lineTension:0}}),"area"===this.type&&(s.elements={line:{fill:"start"}}),this._chart=new e.Chart(t,{type:"bar"===this.type?this.type:"line",data:{labels:i.ticks,datasets:i.datasets},options:s});var n=[],r=[];if(i.datasets.forEach(function(t){var e=Math.max.apply(Math,t.data);e&&e!=1/0&&n.push(e)}),i.datasets.forEach(function(t){var e=Math.min.apply(Math,t.data);(0==e||e&&e!=1/0)&&r.push(e)}),this._ySlider.min=Math.min.apply(Math,r),this._ySlider.max=1.05*Math.max.apply(Math,n),this._chart.options.scales.yAxes[0].ticks.min=this._ySlider.min,this._chart.options.scales.yAxes[0].ticks.max=this._ySlider.max,this._chart.update(),this._xSlider.min=i.ticks[0],this._xSlider.max=i.ticks[i.ticks.length-1],this.alone)console.log("Not alone");else{console.log("Alone");var o={xMin:i.ticks[0],xMax:i.ticks[i.ticks.length-1],yMin:Math.min.apply(Math,r),yMax:1.05*Math.max.apply(Math,n)};this.chartInfos.emit(o)}}},t.prototype.gtsToData=function(t){var e=this,a=[],s=[],n=0;if(t)return t.forEach(function(t){t.gts&&(t.gts=i.GTSLib.flatDeep(t.gts),t.gts.forEach(function(r,o){var h=[];if(r.v){r.v.forEach(function(t){s.push(t[0]/1e3),h.push(t[t.length-1])});var c=i.GTSLib.getColor(o);t.params&&t.params[o]&&t.params[o].color&&(c=t.params[o].color);var p=i.GTSLib.serializeGtsMetadata(r);e._mapIndex[p]=n,t.params&&t.params[o]&&t.params[o].key&&(p=t.params[o].key);var l={label:p,data:h,pointRadius:0,fill:!1,steppedLine:e.isStepped(),borderColor:c,borderWidth:1,backgroundColor:i.GTSLib.transparentize(c,.5)};if(t.params&&t.params[o]&&t.params[o].interpolate)switch(t.params[o].interpolate){case"line":l.lineTension=0;break;case"spline":break;case"area":l.fill=!0}else l.lineTension=0;a.push(l),n++}}))}),{datasets:a,ticks:i.GTSLib.unique(s)}},t.prototype.isStepped=function(){return!!this.type.startsWith("step")&&this.type.replace("step-","")},t.prototype.componentWillLoad=function(){this._config=i.GTSLib.mergeDeep(this._config,JSON.parse(this.config))},t.prototype.componentDidLoad=function(){this.drawChart()},t.prototype.render=function(){return s("div",null,s("h1",null,this.chartTitle),s("div",{class:"chart-container"},this.responsive?s("canvas",{id:"myChart"}):s("canvas",{id:"myChart",width:this.width,height:this.height})))},Object.defineProperty(t,"is",{get:function(){return"quantum-chart"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"encapsulation",{get:function(){return"shadow"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"properties",{get:function(){return{alone:{type:Boolean,attr:"alone"},chartTitle:{type:String,attr:"chart-title"},config:{type:String,attr:"config"},data:{type:String,attr:"data",watchCallbacks:["redraw"]},el:{elementRef:!0},height:{type:String,attr:"height"},hiddenData:{type:String,attr:"hidden-data",watchCallbacks:["hideData"]},options:{type:String,attr:"options",watchCallbacks:["changeScale"]},responsive:{type:Boolean,attr:"responsive"},showLegend:{type:Boolean,attr:"show-legend"},timeMax:{type:Number,attr:"time-max"},timeMin:{type:Number,attr:"time-min"},toBase64Image:{method:!0},type:{type:String,attr:"type"},unit:{type:String,attr:"unit"},width:{type:String,attr:"width"},xView:{type:String,attr:"x-view",watchCallbacks:["changeXView"]},yView:{type:String,attr:"y-view",watchCallbacks:["changeYView"]}}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"events",{get:function(){return[{name:"pointHover",method:"pointHover",bubbles:!0,cancelable:!0,composed:!0},{name:"boundsDidChange",method:"boundsDidChange",bubbles:!0,cancelable:!0,composed:!0},{name:"chartInfos",method:"chartInfos",bubbles:!0,cancelable:!0,composed:!0}]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"style",{get:function(){return"quantum-chart[data-quantum-chart]   .chart-container[data-quantum-chart]{width:var(--quantum-chart-width,100%);height:var(--quantum-chart-height,100%);position:relative}"},enumerable:!0,configurable:!0}),t}();t.QuantumChart=n,Object.defineProperty(t,"__esModule",{value:!0})});