{"version":3,"sources":["../../../node_modules/tslib/tslib.es6.js","../../../projects/warpview-ng/src/lib/model/dataModel.ts","../../../projects/warpview-ng/src/lib/utils/logger.ts","../../../projects/warpview-ng/src/lib/utils/gts.lib.ts","../../../projects/warpview-ng/src/lib/model/chartBounds.ts","../../../projects/warpview-ng/src/lib/utils/color-lib.ts","../../../projects/warpview-ng/src/lib/utils/chart-lib.ts","../../../projects/warpview-ng/src/lib/model/param.ts","../../../projects/warpview-ng/src/lib/services/resize.service.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-component.ts","../../../projects/warpview-ng/src/lib/utils/timsort.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-chart/warp-view-chart.component.ts","../../../projects/warpview-ng/src/lib/services/http-error-handler.service.ts","../../../projects/warpview-ng/src/lib/services/warp10.service.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-tile/warp-view-tile.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-spinner/warp-view-spinner.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-toggle/warp-view-toggle.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-bar/warp-view-bar.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-bubble/warp-view-bubble.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-datagrid/warp-view-datagrid.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-datagrid/warp-view-paginable/warp-view-paginable.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-display/warp-view-display.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-drill-down/warp-view-drill-down.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-drill-down/model/datum.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-drill-down/calendar-heatmap/calendar-heatmap.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-gts-popup/warp-view-gts-popup.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-modal/warp-view-modal.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-gts-tree/warp-view-gts-tree.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-gts-tree/warp-view-tree-view/warp-view-tree-view.component.ts","../../../projects/warpview-ng/src/lib/model/GTS.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-gts-tree/warp-view-chip/warp-view-chip.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-image/warp-view-image.component.ts","../../../projects/warpview-ng/src/lib/utils/map-lib.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-map/warp-view-map.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-map/warp-view-heatmap-sliders/warp-view-heatmap-sliders.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-pie/warp-view-pie.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-gauge/warp-view-gauge.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-annotation/warp-view-annotation.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-polar/warp-view-polar.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-radar/warp-view-radar.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-plot/warp-view-plot.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-resize/warp-view-resize.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-slider/warp-view-slider.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-range-slider/warp-view-range-slider.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-spectrum/warp-view-spectrum.component.ts","../../../projects/warpview-ng/src/lib/plotly/plotly.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-box/warp-view-box.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-3d-line/warp-view-3d-line.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-globe/warp-view-globe.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-event-drop/warp-view-event-drop.component.ts","../../../projects/warpview-ng/src/lib/elements/warp-view-result-tile/warp-view-result-tile.component.ts","../../../projects/warpview-ng/src/lib/warp-view-angular.module.ts"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","__","this","constructor","create","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","f","y","t","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","n","v","op","TypeError","pop","length","push","__read","o","m","r","i","ar","error","__spread","arguments","concat","LEVEL","DataModel","Logger","className","isDebug","name","setDebug","debug","log","level","methods","args","logChain","Date","toISOString","join","DEBUG","console","ERROR","INFO","WARN","warn","_i","info","GTSLib","cleanArray","actual","filter","unique","arr","u","a","l","isArray","splice","propertyIsEnumerable","formatElapsedTime","elapsed","toFixed","isValidResponse","data","response","JSON","parse","LOG","isEmbeddedImage","item","test","isEmbeddedImageObject","image","caption","isPositionArray","positions","isPositionsArrayWithValues","isPositionsArrayWithTwoValues","forEach","j","gtsFromJSON","json","id","gts","c","gtsFromJSONList","jsonList","prefixId","gtsList","undefined","isGts","content","flatDeep","arr1","reduce","acc","val","flattenGtsIdArray","res","walk","sanitizeNames","input","replace","serializeGtsMetadata","_this","serializedLabels","serializedAttributes","keys","key","isGtsToPlot","some","isGtsToPlotOnMap","isSingletonGTS","isGtsToAnnotate","gtsSort","isSorted","sort","getData","getDivider","timeUnit","timestampDivider","timestamp","divider","timeZone","moment","tz","format","formatLabel","serializedGTS","split","display","labels_1","substr","labels_2","ChartBounds","tsmin","tsmax","msmin","msmax","marginLeft","ColorLib","getColor","scheme","color","getColorGradient","transparentize","getBlendedColorGradient","bg","blend_colors","getColorScale","map","hexToRgb","hex","exec","parseInt","alpha","generateColors","num","generateTransparentColors","hsvGradientFromRgbColors","c1","c2","steps","c1hsv","rgb2hsv","c2hsv","h","s","gradient","hsvGradient","rgb","hsv2rgb","Math","floor","normR","normG","normB","M","max","min","distCCW","distCW","q","rgb2hex","componentToHex","toString","color1","color2","percentage","Error","substring","color3","color3Str","int_to_hex","round","COHESIVE","COHESIVE_2","BELIZE","VIRIDIS","MAGMA","INFERNO","PLASMA","YL_OR_RD","YL_GN_BU","BU_GN","WARP10","NINETEEN_EIGHTY_FOUR","ATLANTIS","DO_ANDROIDS_DREAM","DELOREAN","CTHULHU","ECTOPLASM","T_MAX_400_FILM","ChartLib","mergeDeep","base","extended","obj","assign","prop","DEFAULT_WIDTH","DEFAULT_HEIGHT","horizontal","stacked","showControls","showErrors","showStatus","showDots","tiles","showTimeSlider","showTimeRange","timeSliderMode","bounds","Size","width","height","SizeService","sizeChanged$","EventEmitter","change","size","emit","Injectable","WarpViewComponent","el","renderer","sizeService","ngZone","chartDraw","_options","Param","defOptions","dotsLimit","heatControls","timeMode","showRangeSelector","gridLineColor","_debug","_showLegend","_responsive","_unit","_autoResize","_hiddenData","tooltipPosition","top","left","loading","noData","layout","margin","plotlyConfig","responsive","showAxisDragHandles","scrollZoom","doubleClick","showTips","plotGlPixelRatio","staticPlot","displaylogo","modeBarButtonsToRemove","subscribe","nativeElement","parentElement","parentSize","getBoundingClientRect","graph","layout_1","setTimeout","resize","defineProperty","hiddenData","unit","update","showLegend","options","deepEqual","_data","isRefresh","legendFormatter","x","series","highlighted","displayedCurves","labeledData","text","line","marker","curveNumber","html","theta","sa","sb","slice","indexOf","orientation","initChart","dataModel","globalParams","plotlyData","convert","paper_bgcolor","plot_bgcolor","afterPlot","plotlyInstance","rect","hideTooltip","hideTooltipTimer","clearTimeout","toolTip","style","unhover","point","hover","setStyle","delta","Number","MAX_VALUE","curves","points","y_1","yvals","abs","x_1","xvals","event","offsetX","chartContainer","clientWidth","moveTooltip","getTooltipPosition","setProperty","relayout","$event","getLabelColor","getCSSColor","trim","getGridColor","property","defColor","getComputedStyle","getPropertyValue","Directive","ElementRef","Renderer2","NgZone","ViewChild","static","Input","Output","Timsort","array","compare","minGallop","DEFAULT_MIN_GALLOPING","tmpStorageLength","DEFAULT_TMP_STORAGE_LENGTH","stackLength","runStart","runLength","stackSize","tmp","log10","minRunLength","DEFAULT_MIN_MERGE","makeAscendingRun","lo","hi","runHi","reverseRun","binaryInsertionSort","start","pivot","right","mid","gallopLeft","hint","maxOffset","lastOffset","offset","gallopRight","alphabeticalCompare","al","bl","POWERS_OF_TEN","aStr","String","bStr","remaining","ts","minRun","force","pushRun","mergeRuns","forceMergeRuns","mergeAt","start1","length1","start2","length2","k","mergeLow","mergeHigh","cursor1","cursor2","dest","count1","count2","exit","customCursor","customDest","WarpViewChartComponent","_super","standalone","boundsDidChange","pointHover","warpViewChartResize","_type","visibility","maxTick","minTick","visibleGtsId","gtsId","dataHashset","chartBounds","visibilityStatus","afterBoundsUpdate","maxPlottable","parsing","unhighliteCurve","Subject","highliteCurve","showlegend","autosize","hovermode","hoverdistance","xaxis","font","yaxis","exponentformat","fixedrange","automargin","showline","previousVisibility","stringify","newVisibility","visible_1","hidden_1","restyleChart","visible","type","drawChart","refresh","ngOnInit","getTimeClip","newHeight","rangeslider","bgcolor","thickness","reparseNewData","minDate","gridcolor","zerolinecolor","pipe","throttleTime","opacity","off","on","emitNewBounds","source","maxDate","valueOf","tick0","range","dataset","NEGATIVE_INFINITY","POSITIVE_INFINITY","nonPlottable","timestampMode_1","tsLimit_1","ticks","params","datasetColor","mode","hoverinfo","connectgaps","fill","shape","fillcolor","values","plotEl","querySelector","getAttribute","sliderChange","updateBounds","autorange","setRealBounds","y_2","x_2","Component","selector","template","encapsulation","ViewEncapsulation","ShadowDom","HttpErrorHandler","createHandleError","serviceName","operation","handleError","statusText","message","status","of","Warp10Service","http","httpErrorHandler","warpScript","url","post","observe","responseType","tap","catchError","providedIn","HttpClient","WarpViewTileComponent","warp10Service","warpscriptResult","execStatus","execError","isAlone","loaderMessage","_gtsFilter","_warpScript","execUrl","gtsFilter","execute","ngAfterViewInit","warpRef","textContent","handleKeyDown","detectWarpScriptSpecialComments","extraParamsPattern","warpscriptLines","currentLine","search","lineOnMatch","re","RegExp","parameterName","parameterValue","toLowerCase","execResult","body_1","headers","get","fetched","_autoRefresh","autoRefresh","timer","window","clearInterval","setInterval","resultTile","setResult","chartDrawn","onWarpViewNewOptions","opts","providers","HostListener","WarpViewToggleComponent","text1","text2","stateChange","state","checked","switched","WarpViewBarComponent","buildGraph","series_1","columns","index","rows","unshift","barmode","WarpViewBubbleComponent","sizes","WarpViewDatagridComponent","elemsCount","_tabularData","getHeaderParam","def","dataList","parseData","parseCustomData","flatData","dataSet","title","formatDate","date","WarpViewPaginableComponent","windowed","page","pages","displayedValues","drawGridData","goto","prev","decodeURIComponent","str","WarpViewDisplayComponent","toDisplay","ngOnDestroy","flexFont","displayDuration","getStyle","background-color","bgColor","fontColor","wrapper","fitties","unsubscribe","fitty","maxSize","clientHeight","minSize","fit","now","duration","diff","humanize","WarpViewDrillDownComponent","parentWidth","onResize","resizeTimer","heatMapData","details","dates","reducer","accumulator","currentValue","refDate","utc","startOf","total","summary","Datum","CalendarHeatmapComponent","overview","handler","_minColor","DEF_MIN_COLOR","_maxColor","DEF_MAX_COLOR","gutter","gWidth","gHeight","itemSize","labelPadding","transitionDuration","inTransition","tooltipWidth","tooltipPadding","history","selected","getTooltip","tooltipHtml","calculateDimensions","minColor","maxColor","getNumberOfWeeks","dayIndex","subtract","trunc","chart","div","svg","select","append","attr","items","labels","buttons","tooltip","groupBy","xs","rv","updateDataSummary","uniques","project","unsortedSummary","drawGlobalOverview","end","drawYearOverview","endOf","drawMonthOverview","drawWeekOverview","drawDayOverview","startPeriod","endPeriod","yData","isBetween","group","ceil","asYears","scale","year","month","yearData","current","_summary","maxValue","yearLabels","yearScale","scaleBand","rangeRound","padding","domain","scaleLinear","selectAll","remove","enter","removeGlobalOverview","transition","ease","easeLinear","delay","callback","empty","each","yearLabel","startOfYear","endOfYear","calcItemX","calcItemSize","calcItemY","removeYearOverview","circle","currentTarget","repeat","cos","PI","random","asMonths","monthLabels","monthScale","selectedMonth","isSame","dayLabels","timeDays","toDate","dayScale","weekday","bandwidth","selectedDay","day","drawButton","startOfMonth","endOfMonth","monthData","det","hours","sum","weekLabels","incWeek","week","add","weekScale","calcItemXMonth","removeMonthOverview","startOfWeek","endOfWeek","weekData","hoursLabels","hourScale","removeWeekOverview","hour","startOfDay","endOfDay","dayData","gtsNames","gtsNameScale","hourLabels","textLength","node","getComputedTextLength","gtsName","hourIndex","button","removeDayOverview","hideBackButton","WarpViewGtsPopupComponent","maxToShow","warpViewSelectedGTS","warpViewModalOpen","warpViewModalClose","_gts","_kbdLastKeyPressed","displayed","modalOpenned","prepareData","_gtsList","kbdLastKeyPressed","showPopup","onWarpViewModalOpen","onWarpViewModalClose","isOpened","modal","open","close","isHidden","find","identify","WarpViewModalComponent","modalTitle","opened","zIndex","addEventListener","path","nodeName","WarpViewGtsTreeComponent","expand","initOpen","foldGTSTree","foldAll","doRender","root","toggleVisibility","requestAnimationFrame","warpViewSelectedGTSHandler","WarpViewTreeViewComponent","branch","hidden","hide","eventsSubscription","events","GTS","WarpViewChipComponent","param","_node","setState","colorizeChip","chip","toArray","switchPlotState","preventDefault","WarpViewImageComponent","imageTitle","MapLib","toLeafletMapPaths","paths","extractCommonParameters","gtsToPath","render","validateWeightedDotsPositionArray","validateWeightedColoredDotsPositionArray","lat","lon","borderColor","properties","baseRadius","isNaN","BASE_RADIUS","posArray","minValue","numSteps","pos","toLeafletMapPositionArray","this_1","startColor","endColor","maxColorValue","minColorValue","tests","numColorSteps","colorGradient","colorValue","getBoundsArray","positionsData","annotationsData","geoJson","pointsArray","position","annotation","geometry","coordinates","south","west","north","east","pathDataToLeaflet","pathData","toGeoJSON","defShapes","geoJsons","updatePositionArrayToLeaflet","positionArray","latLng","mapTypes","NONE","DEFAULT","link","attribution","HOT","TOPO","TOPO2","SURFER","HYDRA","HYDRA2","TONER","subdomains","TONER_LITE","TERRAIN","ESRI","SATELLITE","OCEANS","GRAY","attibs","GRAYSCALE","WATERCOLOR","CARTODB","CARTODB_DARK","WarpViewMapComponent","heatData","_firstDraw","animate","pointslayer","annotationsMarkers","positionArraysMarkers","_iconAnchor","_popupAnchor","positionData","firstDraw","finalHeight","pathDataLayer","Leaflet","featureGroup","positionDataLayer","tileLayerGroup","geoJsonLayer","_map","resizeMe","reZoom","startZoom","startLat","startLong","drawMap","timeSlider","timeRangeSlider","mapDiv","invalidateSize","heatRadiusDidChange","_heatLayer","setOptions","radius","detail","valueAsNumber","heatBlurDidChange","blur","heatOpacityDidChange","minOpacity","timeStart","setDefault","timeSpan","flattenGTS","displayMap","icon","iconUrl","iconAnchor","popupAnchor","patchMapTileGapBug","originalInitTile","GridLayer","_initTile","isPatched","include","tile","tileSize","getTileSize","reDraw","lowerTimeBound","timeSliderMin","upperTimeBound","timeSliderMax","mapType","mapOpts","maxZoom","maxNativeZoom","tilesLayer","tileLayer","clearLayers","preferCanvas","layers","zoomAnimation","bringToBack","getCenter","lng","currentLong","getZoom","currentZoom","currentLat","addTo","pathDataSize","updateGtsPath","positionsSize","updatePositionArray","addLayer","timeEnd","fillColor","pointToLayer","geoJsonPoint","latlng","geoShape","geoJSON","bindPopup","getBounds","isValid","setView","fitBounds","heatLayer","heatRadius","heatBlur","heatOpacity","getGTSDots","dots","addPopup","circleMarker","fillOpacity","weight","antPath","dashArray","pulseColor","paused","reverse","hardwareAccelerated","hardwareAcceleration","polyline","content_1","inStep","onRangeSliderChange","highValue","onRangeSliderWindowChange","onSliderChange","updateTimeSpan","target","None","WarpViewHeatmapSlidersComponent","radiusChanged","blurChanged","opacityChanged","WarpViewPieComponent","legend","textfont","plotData","pieData","colors","hoverlabel","bordercolor","dataStruct","MIN_VALUE","hole","WarpViewGaugeComponent","CHART_MARGIN","lineHeight","autoexpand","grid","pattern","xgap","ygap","count","calculatedHeight","overallMax","annotations","itemHeight","xref","yref","xanchor","yanchor","showarrow","align","reference","number","gauge","axis","tickcolor","tickfont","bar","WarpViewAnnotationComponent","displayExpander","gridwidth","showticklabels","showgrid","dtick","nticks","rangemode","tickson","zeroline","expanded","_standalone","isStandalone","trimmed","classList","handleKeyup","offsetY","paddingLeft","innerHTML","pointerEvents","timestampMode","tsLimit","symbol","toggle","WarpViewPolarComponent","familly","polar","angularaxis","radialaxis","minVal","maxVal","WarpViewRadarComponent","WarpViewPlotComponent","initialChartHeight","initialMapHeight","warpViewNewOptions","showGTSTree","_toHide","showChart","showMap","timeClipValue","warningMessage","gtsIdList","kbdCounter","gtsFilterCount","gtsBrowserIndex","preventDefaultKeyList","preventDefaultKeyListInModals","showLine","resizeArea","handleKeydown","ev","handleKeyPress","mainPlotDiv","focus","run","handleMouseMove","evt","pageX","handleMouseEnter","main","handleMouseOut","inputTextKeyboardEvents","stopImmediatePropagation","applyFilter","pushKbdEvent","tzSelected","tzSelector","setAttribute","resizeChart","timeClip","idListClicked","_b","_c","_a","gtsPopupModal","filterInput","tc","toLocaleString","getTZ","names","onChartDraw","component","GTSTree","controls","WarpViewResizeComponent","minHeight","initialHeight","dragging","handleDiv","moveListener","handleDraggingMove","bind","clickUpListener","handleDraggingEnd","document","removeEventListener","yTopParent","pageY","WarpViewSliderComponent","show","_step","loaded","manualRefresh","_min","_max","tmpVAl","slider","_uiSlider","updateSliderOptions","tooltips","getFormat","noUiSlider.create","set","updateOptions","to","from","WarpViewRangeSliderComponent","onChange","connect","WarpViewSpectrumComponent","histo","histnorm","histfunc","contours","showlabels","labelfont","colorbar","xpad","showscale","colorscale","autocolorscale","PlotlyComponent","iterableDiffers","keyValueDiffers","defaultClassName","revision","useResizeHandler","updateOnLayoutChange","updateOnDataChange","updateOnlyWithRevision","initialized","purge","afterExport","animated","animatingFrame","animationInterrupted","autoSize","beforeExport","buttonClicked","click","plotly_click","clickAnnotation","deselect","framework","legendClick","legendDoubleClick","restyle","redraw","selecting","sliderEnd","sliderStart","transitioning","transitionInterrupted","relayouting","eventNames","updatePlot","updateWindowResizeHandler","_layout","Plotlyjs.relayout","_config","config","createPlot","figure","createFigure","resizeHandler","getWindow","ngDoCheck","shouldUpdate","layoutDiffer","dataDiffer","dataDifferTrackBy","getClassName","classes","Plotlyjs.restyle","Plotlyjs.react","gd","eventName","err","frames","_transitionData","_frames","Plotlyjs.purge","Plots","uid","IterableDiffers","KeyValueDiffers","WarpViewBoxComponent","boxmode","lastIndexOf","boxmean","boxpoints","WarpView3dLineComponent","zaxis","z","WarpViewGlobeComponent","geo","projection","showframe","fitbounds","showocean","oceancolor","showland","landcolor","showlakes","lakecolor","showcountries","lonaxis","lataxis","geoData","geoData_1","WarpViewEventDropComponent","eventConf","d3","d3__namespace","verticalGrid","tickPadding","indicator","row","drop","onMouseOver","d3.event","d3\n                        .select","onMouseOut","elemChart","eventDrops","labelsSize","WarpViewResultTileComponent","graphs","spectrum","pie","radar","bubble","gts-tree","datagrid","drilldown","plot","box","line3d","globe","drops","onResized","newWidth","NgModule","declarations","WarpViewSpinnerComponent","imports","CommonModule","HttpClientModule","AngularResizedEventModule","FormsModule","exports","entryComponents"],"mappings":"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V,wBALhDmR,EAAAA,UAASpe,KAAA,CAAC,CACTqe,SAAU,uBACVC,SAAA,6sYAZiB9J,EAAAA,kBAAiDC,EAAAA,iBAEtD/H,SAFsCgI,EAAAA,yCAiBjDG,EAAAA,MAAK7U,KAAA,CAAC,4BAYN6U,EAAAA,MAAK7U,KAAA,CAAC,kCAEN8U,EAAAA,OAAM9U,KAAA,CAAC,2CACP8U,EAAAA,OAAM9U,KAAA,CAAC,0CACP8U,EAAAA,OAAM9U,KAAA,CAAC,sCACP8U,EAAAA,OAAM9U,KAAA,CAAC,+CACP8U,EAAAA,OAAM9U,KAAA,CAAC,gCCgJV,kCAvHC8yC,EAAAA,SAAQ9yC,KAAA,CAAC,CACR+yC,aAAc,CACZhzB,EACAnH,EACAo6B,EACApwB,GACAO,GACAQ,GACAE,GACAa,GACAU,GACAqB,GACAgB,GACAgJ,GACAsB,GACAO,GACAU,GACAO,GACAS,GACA4E,GACA4H,GACAI,GACAW,GACA0B,GACAwB,GACAO,GACAC,GACAqD,GACAc,GACAkB,GACAG,GACAY,GACAiE,GACAK,GACAG,GACAgB,GACAgB,IAEFmB,QAAS,CACPC,EAAAA,aACAC,EAAAA,iBACAC,EAAAA,0BACAC,EAAAA,aAEFC,QAAS,CACPvzB,EACAnH,EACAo6B,EACApwB,GACAO,GACAQ,GACAE,GACAa,GACAU,GACAqB,GACAgB,GACAgJ,GACAsB,GACAO,GACAU,GACAO,GACAS,GACA4E,GACA4H,GACAI,GACAW,GACA0B,GACAwB,GACAO,GACAC,GACAqD,GACAc,GACAkB,GACAG,GACA6E,GACAK,GACAG,GACAgB,GACAgB,IAEFpvB,UAAW,CAAChE,EAAkBhS,GAC9B6mC,gBAAiB,CACfxzB,EACAnH,EACAo6B,EACApwB,GACAO,GACAQ,GACAE,GACAa,GACAU,GACAqB,GACAgB,GACAgJ,GACAsB,GACAO,GACAU,GACAO,GACAS,GACA4E,GACA4H,GACAI,GACAW,GACA0B,GACAwB,GACAO,GACAC,GACAqD,GACAc,GACAkB,GACAG,GACAY,GACAiE,GACAK,GACAG,GACAgB,GACAgB","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Param} from './param';\n\nexport class DataModel {\n  data: any[] | string;\n  params?: Param[];\n  globalParams?: Param;\n  bounds?: {\n    xmin?: number,\n    xmax?: number,\n    ymin?: number,\n    ymax?: number\n  };\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\n/* tslint:disable:no-console */\n\nexport class Logger {\n\n  className: string;\n  isDebug = false;\n\n  constructor(className: any, isDebug: boolean = false) {\n    this.className = className.name;\n    this.isDebug = isDebug;\n  }\n\n  setDebug(debug: boolean) {\n    this.isDebug = debug;\n  }\n\n  log(level: LEVEL, methods: any[], args: any[]) {\n    let logChain = [];\n    logChain.push(`[${new Date().toISOString()} - [${this.className}] ${methods.join(' - ')}`);\n    logChain = logChain.concat(args);\n    switch (level) {\n      case LEVEL.DEBUG: {\n        if (this.isDebug) {\n          console.debug(...logChain);\n        }\n        break;\n      }\n      case LEVEL.ERROR: {\n        console.error(...logChain);\n        break;\n      }\n      case LEVEL.INFO: {\n        console.log(...logChain);\n        break;\n      }\n      case LEVEL.WARN: {\n        console.warn(...logChain);\n        break;\n      }\n      default: {\n        if (this.isDebug) {\n          console.log(...logChain);\n        }\n      }\n    }\n  }\n\n  debug(methods: any[], ...args: any[]) {\n    this.log(LEVEL.DEBUG, methods, args);\n  }\n\n  error(methods: any[], ...args: any[]) {\n    this.log(LEVEL.ERROR, methods, args);\n  }\n\n  warn(methods: any[], ...args: any[]) {\n    this.log(LEVEL.WARN, methods, args);\n  }\n\n  info(methods: any[], ...args: any[]) {\n    this.log(LEVEL.INFO, methods, args);\n  }\n}\n\nexport enum LEVEL {\n  DEBUG, ERROR, WARN, INFO\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {DataModel} from '../model/dataModel';\nimport {GTS} from '../model/GTS';\nimport {Logger} from './logger';\nimport moment from 'moment-timezone';\n\n// @dynamic\nexport class GTSLib {\n  private static LOG: Logger = new Logger(GTSLib);\n\n  static cleanArray(actual: any[]) {\n    return actual.filter((i) => !!i);\n  }\n\n  static unique(arr) {\n    const u = {};\n    const a = [];\n    for (let i = 0, l = arr.length; i < l; ++i) {\n      if (!u.hasOwnProperty(arr[i])) {\n        a.push(arr[i]);\n        u[arr[i]] = 1;\n      }\n    }\n    return a;\n  }\n\n  static isArray(value) {\n    return value && typeof value === 'object' && value instanceof Array && typeof value.length === 'number'\n      && typeof value.splice === 'function' && !(value.propertyIsEnumerable('length'));\n  }\n\n  static formatElapsedTime(elapsed: number) {\n    if (elapsed < 1000) {\n      return elapsed.toFixed(3) + ' ns';\n    }\n    if (elapsed < 1000000) {\n      return (elapsed / 1000).toFixed(3) + ' μs';\n    }\n    if (elapsed < 1000000000) {\n      return (elapsed / 1000000).toFixed(3) + ' ms';\n    }\n    if (elapsed < 1000000000000) {\n      return (elapsed / 1000000000).toFixed(3) + ' s ';\n    }\n    // Max exec time for nice output: 999.999 minutes (should be OK, timeout should happen before that).\n    return (elapsed / 60000000000).toFixed(3) + ' m ';\n  }\n\n  static isValidResponse(data) {\n    let response;\n    try {\n      response = JSON.parse(data);\n    } catch (e) {\n      this.LOG.error(['isValidResponse'], 'Response non JSON compliant', data);\n      return false;\n    }\n    if (!GTSLib.isArray(response)) {\n      this.LOG.error(['isValidResponse'], 'Response isn\\'t an Array', response);\n      return false;\n    }\n    return true;\n  }\n\n  static isEmbeddedImage(item) {\n    return !(typeof item !== 'string' || !/^data:image/.test(item));\n  }\n\n  static isEmbeddedImageObject(item) {\n    return !((item === null) || (item.image === null) ||\n      (item.caption === null) || !GTSLib.isEmbeddedImage(item.image));\n  }\n\n  static isPositionArray(item) {\n    if (!item || !item.positions) {\n      return false;\n    }\n    if (GTSLib.isPositionsArrayWithValues(item) || GTSLib.isPositionsArrayWithTwoValues(item)) {\n      return true;\n    }\n    (item.positions || []).forEach(p => {\n      if (p.length < 2 || p.length > 3) {\n        return false;\n      }\n      for (const j in p) {\n        if (typeof p[j] !== 'number') {\n          return false;\n        }\n      }\n    });\n    return true;\n  }\n\n  static isPositionsArrayWithValues(item) {\n    if ((item === null) || (item.positions === null)) {\n      return false;\n    }\n    (item.positions || []).forEach(p => {\n      if (p.length !== 3) {\n        return false;\n      }\n      for (const j in p) {\n        if (typeof p[j] !== 'number') {\n          return false;\n        }\n      }\n    });\n    return true;\n  }\n\n  static isPositionsArrayWithTwoValues(item) {\n    if ((item === null) || (item.positions === null)) {\n      return false;\n    }\n    (item.positions || []).forEach(p => {\n      if (p.length !== 4) {\n        return false;\n      }\n      for (const j in p) {\n        if (typeof p[j] !== 'number') {\n          return false;\n        }\n      }\n    });\n    return true;\n  }\n\n  static gtsFromJSON(json, id) {\n    return {gts: {c: json.c, l: json.l, a: json.a, v: json.v, id}};\n  }\n\n  static gtsFromJSONList(jsonList, prefixId) {\n    const gtsList = [];\n    let id;\n    (jsonList || []).forEach((item, i) => {\n      let gts = item;\n      if (item.gts) {\n        gts = item.gts;\n      }\n      if ((prefixId !== undefined) && (prefixId !== '')) {\n        id = prefixId + '-' + i;\n      } else {\n        id = i;\n      }\n      if (GTSLib.isArray(gts)) {\n        gtsList.push(GTSLib.gtsFromJSONList(gts, id));\n      }\n      if (GTSLib.isGts(gts)) {\n        gtsList.push(GTSLib.gtsFromJSON(gts, id));\n      }\n      if (GTSLib.isEmbeddedImage(gts)) {\n        gtsList.push({image: gts, caption: 'Image', id});\n      }\n      if (GTSLib.isEmbeddedImageObject(gts)) {\n        gtsList.push({image: gts.image, caption: gts.caption, id});\n      }\n    });\n    return {\n      content: gtsList || [],\n    };\n  }\n\n  static flatDeep(arr1: any[]): any[] {\n    if (!GTSLib.isArray(arr1)) {\n      arr1 = [arr1];\n    }\n    return arr1.reduce((acc, val) => Array.isArray(val) ? acc.concat(GTSLib.flatDeep(val)) : acc.concat(val), []);\n  }\n\n  static flattenGtsIdArray(a: any[], r: number): { res: any[], r: number } {\n    const res = [];\n    if (GTSLib.isGts(a)) {\n      a = [a];\n    }\n    (a || []).forEach(d => {\n      if (GTSLib.isArray(d)) {\n        const walk = GTSLib.flattenGtsIdArray(d, r);\n        res.push(walk.res);\n        r = walk.r;\n      } else if (d && d.v) {\n        d.id = r;\n        res.push(d);\n        r++;\n      }\n    });\n    return {res, r};\n  }\n\n  static sanitizeNames(input: string): string {\n    return (input || '').replace(/{/g, '&#123;')\n      .replace(/}/g, '&#125;')\n      .replace(/,/g, '&#44;')\n      .replace(/>/g, '&#62;')\n      .replace(/</g, '&#60;')\n      .replace(/\"/g, '&#34;')\n      .replace(/'/g, '&#39;');\n  }\n\n  static serializeGtsMetadata(gts) {\n    const serializedLabels = [];\n    const serializedAttributes = [];\n    if (gts.l) {\n      Object.keys(gts.l).forEach((key) => {\n        serializedLabels.push(this.sanitizeNames(key + '=' + gts.l[key]));\n      });\n    }\n    if (gts.a) {\n      Object.keys(gts.a).forEach((key) => {\n        serializedAttributes.push(this.sanitizeNames(key + '=' + gts.a[key]));\n      });\n    }\n    // tslint:disable-next-line:max-line-length\n    return `${this.sanitizeNames(gts.c)}{${serializedLabels.join(',')}${serializedAttributes.length > 0 ? ',' : ''}${serializedAttributes.join(',')}}`;\n  }\n\n  static isGts(item) {\n    return !!item && (item.c === '' || !!item.c) && !!item.v && GTSLib.isArray(item.v);\n  }\n\n  static isGtsToPlot(gts) {\n    if (!GTSLib.isGts(gts) || gts.v.length === 0) {\n      return false;\n    }\n    // We look at the first non-null value, if it's a String or Boolean it's an annotation GTS,\n    // if it's a number it's a GTS to plot\n    return (gts.v || []).some(v => {\n      // noinspection JSPotentiallyInvalidConstructorUsage\n      return typeof v[v.length - 1] === 'number' || !!v[v.length - 1].constructor.prototype.toFixed;\n    });\n  }\n\n  static isGtsToPlotOnMap(gts) {\n    if (!GTSLib.isGts(gts) || gts.v.length === 0) {\n      return false;\n    }\n    // We look at the first non-null value, if it's a String or Boolean it's an annotation GTS,\n    // if it's a number it's a GTS to plot\n    return (gts.v || []).some(v => {\n      return v.length >= 3;\n    });\n  }\n\n  static isSingletonGTS(gts) {\n    if (!GTSLib.isGts(gts) || gts.v.length === 0) {\n      return false;\n    }\n    return (gts.v || []).length === 1;\n  }\n\n  static isGtsToAnnotate(gts) {\n    if (!GTSLib.isGts(gts) || gts.v.length === 0) {\n      return false;\n    }\n    // We look at the first non-null value, if it's a String or Boolean it's an annotation GTS,\n    // if it's a number it's a GTS to plot\n    return (gts.v || []).some(v => {\n      if (v[v.length - 1] !== null) {\n        // noinspection JSPotentiallyInvalidConstructorUsage\n        return typeof (v[v.length - 1]) !== 'number' &&\n          (!!v[v.length - 1].constructor && v[v.length - 1].constructor.name !== 'Big') &&\n          v[v.length - 1].constructor.prototype.toFixed === undefined;\n      }\n    });\n  }\n\n  static gtsSort(gts) {\n    if (gts.isSorted) {\n      return;\n    }\n    gts.v = gts.v.sort((a, b) => a[0] - b[0]);\n    gts.isSorted = true;\n  }\n\n  static getData(data: any): DataModel {\n    if (typeof data === 'string') {\n      return GTSLib.getData(JSON.parse(data as string));\n    } else if (data && data.hasOwnProperty('data')) {\n      if (!GTSLib.isArray(data.data)) {\n        data.data = [data.data];\n      }\n      return data as DataModel;\n    } else if (GTSLib.isArray(data) && data.length > 0 && data[0].data) {\n      return data[0] as DataModel;\n    } else if (GTSLib.isArray(data)) {\n      return {data: data as GTS[]} as DataModel;\n    }\n    return new DataModel();\n  }\n\n  static getDivider(timeUnit: string): number {\n    let timestampDivider = 1000; // default for µs timeunit\n    if (timeUnit === 'ms') {\n      timestampDivider = 1;\n    }\n    if (timeUnit === 'ns') {\n      timestampDivider = 1000000;\n    }\n    return timestampDivider;\n  }\n\n  static formatLabel = (data: string): string => {\n    const serializedGTS = data.split('{');\n    let display = `<span class=\"gtsInfo\"><span class='gts-classname'>${serializedGTS[0]}</span>`;\n    if (serializedGTS.length > 1) {\n      display += `<span class='gts-separator'>{</span>`;\n      const labels = serializedGTS[1].substr(0, serializedGTS[1].length - 1).split(',');\n      if (labels.length > 0) {\n        labels.forEach((l, i) => {\n          const label = l.split('=');\n          if (l.length > 1) {\n            display += `<span><span class='gts-labelname'>${label[0]}</span>\n<span class='gts-separator'>=</span><span class='gts-labelvalue'>${label[1]}</span>`;\n            if (i !== labels.length - 1) {\n              display += `<span>, </span>`;\n            }\n          }\n        });\n      }\n      display += `<span class='gts-separator'>}</span>`;\n    }\n    if (serializedGTS.length > 2) {\n      display += `<span class='gts-separator'>{</span>`;\n      const labels = serializedGTS[2].substr(0, serializedGTS[2].length - 1).split(',');\n      if (labels.length > 0) {\n        labels.forEach((l, i) => {\n          const label = l.split('=');\n          if (l.length > 1) {\n            display += `<span><span class='gts-attrname'>${label[0]}</span>\n<span class='gts-separator'>=</span><span class='gts-attrvalue'>${label[1]}</span>`;\n            if (i !== labels.length - 1) {\n              display += `<span>, </span>`;\n            }\n          }\n        });\n      }\n      display += `<span class='gts-separator'>}</span>`;\n    }\n    display += '</span>';\n    return display;\n  }\n\n  static toISOString(timestamp: number, divider: number, timeZone: string) {\n    if(timeZone !== 'UTC') {\n      return moment.tz(timestamp / divider, timeZone).format();\n    } else {\n      return moment(timestamp / divider).toISOString();\n    }\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nexport class ChartBounds {\n  tsmin = 0;\n  tsmax = 0;\n  msmin = '';\n  msmax = '';\n  marginLeft = 0;\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n// @dynamic\nexport class ColorLib {\n  static color = {\n    COHESIVE: [\n      '#F2D354',\n      '#E4612F',\n      '#D32C2E',\n      '#6D2627',\n      '#6C7F55',\n      '#934FC6',\n      '#F07A5D',\n      '#ED8371',\n      '#94E751',\n      '#C457F7',\n      '#973AF7',\n      '#B6FF7A',\n      '#C7FFD5',\n      '#90E4D0',\n      '#E09234',\n      '#D2FF91',\n      '#17B201'\n    ],\n    COHESIVE_2: [\n      '#6F694E',\n      '#65D0B2',\n      '#D8F546',\n      '#FF724B',\n      '#D6523E',\n      '#F9F470',\n      '#F4BC78',\n      '#B1D637',\n      '#FFCFC8',\n      '#56CDAB',\n      '#CFDD22',\n      '#B3F5D2',\n      '#97DB29',\n      '#9DC5EE',\n      '#CFC0F5',\n      '#EDEA29',\n      '#5EC027',\n      '#386C94'\n    ],\n    BELIZE: [\n      '#5899DA',\n      '#E8743B',\n      '#19A979',\n      '#ED4A7B',\n      '#945ECF',\n      '#13A4B4',\n      '#525DF4',\n      '#BF399E',\n      '#6C8893',\n      '#EE6868',\n      '#2F6497'\n    ],\n    VIRIDIS: [\n      '#440154',\n      '#481f70',\n      '#443983',\n      '#3b528b',\n      '#31688e',\n      '#287c8e',\n      '#21918c',\n      '#20a486',\n      '#35b779',\n      '#5ec962',\n      '#90d743',\n      '#c8e020',\n    ],\n    MAGMA: [\n      '#000004',\n      '#100b2d',\n      '#2c115f',\n      '#51127c',\n      '#721f81',\n      '#932b80',\n      '#b73779',\n      '#d8456c',\n      '#f1605d',\n      '#fc8961',\n      '#feb078',\n      '#fed799',\n    ],\n    INFERNO: [\n      '#000004',\n      '#110a30',\n      '#320a5e',\n      '#57106e',\n      '#781c6d',\n      '#9a2865',\n      '#bc3754',\n      '#d84c3e',\n      '#ed6925',\n      '#f98e09',\n      '#fbb61a',\n      '#f4df53',\n    ],\n    PLASMA: [\n      '#0d0887',\n      '#3a049a',\n      '#5c01a6',\n      '#7e03a8',\n      '#9c179e',\n      '#b52f8c',\n      '#cc4778',\n      '#de5f65',\n      '#ed7953',\n      '#f89540',\n      '#fdb42f',\n      '#fbd524',\n    ],\n    YL_OR_RD: [\n      '#ffffcc',\n      '#ffeda0',\n      '#fed976',\n      '#feb24c',\n      '#fd8d3c',\n      '#fc4e2a',\n      '#e31a1c',\n      '#bd0026',\n      '#800026',\n    ],\n    YL_GN_BU: [\n      '#ffffd9',\n      '#edf8b1',\n      '#c7e9b4',\n      '#7fcdbb',\n      '#41b6c4',\n      '#1d91c0',\n      '#225ea8',\n      '#253494',\n      '#081d58',\n    ],\n    BU_GN: [\n      '#f7fcfd',\n      '#ebf7fa',\n      '#dcf2f2',\n      '#c8eae4',\n      '#aadfd2',\n      '#88d1bc',\n      '#68c2a3',\n      '#4eb485',\n      '#37a266',\n      '#228c49',\n      '#0d7635',\n      '#025f27',\n    ],\n    WARP10: [\n      '#ff9900',\n      '#004eff',\n      '#E53935',\n      '#7CB342',\n      '#F4511E',\n      '#039BE5',\n      '#D81B60',\n      '#C0CA33',\n      '#6D4C41',\n      '#8E24AA',\n      '#00ACC1',\n      '#FDD835',\n      '#5E35B1',\n      '#00897B',\n      '#FFB300',\n      '#3949AB',\n      '#43A047',\n      '#1E88E5',\n    ],\n    NINETEEN_EIGHTY_FOUR: ['#31C0F6', '#A500A5', '#FF7E27'],\n    ATLANTIS: ['#74D495', '#3F3FBA', '#FF4D9E'],\n    DO_ANDROIDS_DREAM: ['#8F8AF4', '#A51414', '#F4CF31'],\n    DELOREAN: ['#FD7A5D', '#5F1CF2', '#4CE09A'],\n    CTHULHU: ['#FDC44F', '#007C76', '#8983FF'],\n    ECTOPLASM: ['#DA6FF1', '#00717A', '#ACFF76'],\n    T_MAX_400_FILM: ['#F6F6F8', '#A4A8B6', '#545667']\n  };\n\n  static getColor(i: number, scheme: string) {\n    return ColorLib.color[scheme][i % ColorLib.color[scheme].length];\n  }\n\n  static getColorGradient(id: number, scheme: string) {\n    return [\n      [0, ColorLib.transparentize(ColorLib.getColor(id, scheme), 0)],\n      [1, ColorLib.transparentize(ColorLib.getColor(id, scheme), 0.7)]\n    ];\n  }\n\n  static getBlendedColorGradient(id: number, scheme: string, bg = '#000000') {\n    return [\n      [0, ColorLib.blend_colors(bg, ColorLib.getColor(id, scheme), 0)],\n      [1, ColorLib.blend_colors(bg, ColorLib.getColor(id, scheme), 1)]\n    ];\n  }\n\n  static getColorScale(scheme: string) {\n    return ColorLib.color[scheme].map((c, i) => [i, c]);\n  }\n\n  static hexToRgb(hex) {\n    const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    return result ? [\n      parseInt(result[1], 16),\n      parseInt(result[2], 16),\n      parseInt(result[3], 16)\n    ] : null;\n  }\n\n  static transparentize(color, alpha = 0.5): string {\n    return 'rgba(' + ColorLib.hexToRgb(color).concat(alpha).join(',') + ')';\n  }\n\n  static generateColors(num, scheme) {\n    const color = [];\n    for (let i = 0; i < num; i++) {\n      color.push(ColorLib.getColor(i, scheme));\n    }\n    return color;\n  }\n\n  static generateTransparentColors(num, scheme) {\n    const color = [];\n    for (let i = 0; i < num; i++) {\n      color.push(ColorLib.transparentize(ColorLib.getColor(i, scheme)));\n    }\n    return color;\n  }\n\n  static hsvGradientFromRgbColors(c1, c2, steps) {\n    const c1hsv = ColorLib.rgb2hsv(c1.r, c1.g, c1.b);\n    const c2hsv = ColorLib.rgb2hsv(c2.r, c2.g, c2.b);\n    c1.h = c1hsv[0];\n    c1.s = c1hsv[1];\n    c1.v = c1hsv[2];\n    c2.h = c2hsv[0];\n    c2.s = c2hsv[1];\n    c2.v = c2hsv[2];\n    const gradient = ColorLib.hsvGradient(c1, c2, steps);\n    for (const i in gradient) {\n      if (gradient[i]) {\n        gradient[i].rgb = ColorLib.hsv2rgb(gradient[i].h, gradient[i].s, gradient[i].v);\n        gradient[i].r = Math.floor(gradient[i].rgb[0]);\n        gradient[i].g = Math.floor(gradient[i].rgb[1]);\n        gradient[i].b = Math.floor(gradient[i].rgb[2]);\n      }\n    }\n    return gradient;\n  }\n\n  private static rgb2hsv(r: number, g: number, b: number) {\n    // Normalize\n    const normR = r / 255.0;\n    const normG = g / 255.0;\n    const normB = b / 255.0;\n    const M = Math.max(normR, normG, normB);\n    const m = Math.min(normR, normG, normB);\n    const d = M - m;\n    let h;\n    let s;\n    let v;\n    v = M;\n    if (d === 0) {\n      h = 0;\n      s = 0;\n    } else {\n      s = d / v;\n      switch (M) {\n        case normR:\n          h = ((normG - normB) + d * (normG < normB ? 6 : 0)) / 6 * d;\n          break;\n        case normG:\n          h = ((normB - normR) + d * 2) / 6 * d;\n          break;\n        case normB:\n          h = ((normR - normG) + d * 4) / 6 * d;\n          break;\n      }\n    }\n    return [h, s, v];\n  }\n\n  private static hsvGradient(c1: any, c2: any, steps: any) {\n    const gradient = new Array(steps);\n    // determine clockwise and counter-clockwise distance between hues\n    const distCCW = (c1.h >= c2.h) ? c1.h - c2.h : 1 + c1.h - c2.h;\n    const distCW = (c1.h >= c2.h) ? 1 + c2.h - c1.h : c2.h - c1.h;\n    // make gradient for this part\n    for (let i = 0; i < steps; i++) {\n      // interpolate h, s, b\n      let h = (distCW <= distCCW) ? c1.h + (distCW * i / (steps - 1)) : c1.h - (distCCW * i / (steps - 1));\n      if (h < 0) {\n        h = 1 + h;\n      }\n      if (h > 1) {\n        h = h - 1;\n      }\n      const s = (1 - i / (steps - 1)) * c1.s + i / (steps - 1) * c2.s;\n      const v = (1 - i / (steps - 1)) * c1.v + i / (steps - 1) * c2.v;\n      // add to gradient array\n      gradient[i] = {h, s, v};\n    }\n    return gradient;\n  }\n\n  private static hsv2rgb(h: any, s: any, v: any) {\n    let r;\n    let g;\n    let b;\n    const i = Math.floor(h * 6);\n    const f = h * 6 - i;\n    const p = v * (1 - s);\n    const q = v * (1 - f * s);\n    const t = v * (1 - (1 - f) * s);\n    switch (i % 6) {\n      case 0:\n        r = v;\n        g = t;\n        b = p;\n        break;\n      case 1:\n        r = q;\n        g = v;\n        b = p;\n        break;\n      case 2:\n        r = p;\n        g = v;\n        b = t;\n        break;\n      case 3:\n        r = p;\n        g = q;\n        b = v;\n        break;\n      case 4:\n        r = t;\n        g = p;\n        b = v;\n        break;\n      case 5:\n        r = v;\n        g = p;\n        b = q;\n        break;\n    }\n    return [r * 255, g * 255, b * 255];\n  }\n\n  static rgb2hex(r, g, b) {\n    function componentToHex(c) {\n      const hex = c.toString(16);\n      return hex.length === 1 ? '0' + hex : hex;\n    }\n\n    return '#' + componentToHex(r) + componentToHex(g) + componentToHex(b);\n  }\n\n  static blend_colors(color1, color2, percentage) {\n    // check input\n    color1 = color1 || '#000000';\n    color2 = color2 || '#ffffff';\n    percentage = percentage || 0.5;\n    // 1: validate input, make sure we have provided a valid hex\n    if (color1.length !== 4 && color1.length !== 7) {\n      throw new Error('colors must be provided as hexes');\n    }\n    if (color2.length !== 4 && color2.length !== 7) {\n      throw new Error('colors must be provided as hexes');\n    }\n    if (percentage > 1 || percentage < 0) {\n      throw new Error('percentage must be between 0 and 1');\n    }\n    // 2: check to see if we need to convert 3 char hex to 6 char hex, else slice off hash\n    //      the three character hex is just a representation of the 6 hex where each character is repeated\n    //      ie: #060 => #006600 (green)\n    if (color1.length === 4) {\n      color1 = color1[1] + color1[1] + color1[2] + color1[2] + color1[3] + color1[3];\n    } else {\n      color1 = color1.substring(1);\n    }\n    if (color2.length === 4) {\n      color2 = color2[1] + color2[1] + color2[2] + color2[2] + color2[3] + color2[3];\n    } else {\n      color2 = color2.substring(1);\n    }\n    console.log('valid: c1 => ' + color1 + ', c2 => ' + color2);\n    // 3: we have valid input, convert colors to rgb\n    color1 = [parseInt(color1[0] + color1[1], 16), parseInt(color1[2] + color1[3], 16), parseInt(color1[4] + color1[5], 16)];\n    color2 = [parseInt(color2[0] + color2[1], 16), parseInt(color2[2] + color2[3], 16), parseInt(color2[4] + color2[5], 16)];\n    console.log('hex -> rgba: c1 => [' + color1.join(', ') + '], c2 => [' + color2.join(', ') + ']');\n    // 4: blend\n    const color3 = [\n      (1 - percentage) * color1[0] + percentage * color2[0],\n      (1 - percentage) * color1[1] + percentage * color2[1],\n      (1 - percentage) * color1[2] + percentage * color2[2]\n    ];\n    const color3Str = '#' + ColorLib.int_to_hex(color3[0]) + ColorLib.int_to_hex(color3[1]) + ColorLib.int_to_hex(color3[2]);\n    console.log(color3Str);\n    // return hex\n    return color3Str;\n  }\n\n  /*\n      convert a Number to a two character hex string\n      must round, or we will end up with more digits than expected (2)\n      note: can also result in single digit, which will need to be padded with a 0 to the left\n      @param: num         => the number to conver to hex\n      @returns: string    => the hex representation of the provided number\n  */\n  static int_to_hex(num: number) {\n    let hex = Math.round(num).toString(16);\n    if (hex.length === 1) {\n      hex = '0' + hex;\n    }\n    return hex;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\n// @dynamic\nexport class ChartLib {\n\n  static DEFAULT_WIDTH = 640;\n  static DEFAULT_HEIGHT = 480;\n\n  static mergeDeep<T>(base: T, extended: any) {\n    const obj = {... base} as T;\n    for (const prop in extended || {}) {\n      // If property is an object, merge properties\n      if (Object.prototype.toString.call(extended[prop]) === '[object Object]') {\n        obj[prop] = ChartLib.mergeDeep<T>(obj[prop], extended[prop]);\n      } else {\n        obj[prop] = extended[prop];\n      }\n    }\n    return obj as T;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\nexport class Param {\n  scheme = 'WARP10';\n  bgColor?: string;\n  datasetColor?: string;\n  fontColor?: string;\n  borderColor?: string;\n  showLegend?: boolean;\n  responsive?: boolean;\n  horizontal = false;\n  stacked = false;\n  key?: string;\n  unit?: string;\n  type?: string;\n  showRangeSelector?: boolean;\n  autoRefresh?: number;\n  showControls = true;\n  showErrors = true;\n  showStatus = true;\n  showGTSTree?: boolean;\n  foldGTSTree?: boolean;\n  timeMode?: 'timestamp' | 'date' | 'custom' | 'duration';\n  showDots = false;\n  delta?: number;\n  timeUnit: 'us' | 'ms' | 'ns' = 'us';\n  minColor?: string;\n  maxColor?: string;\n  startColor?: string;\n  endColor?: string;\n  numColorSteps?: number;\n  split?: 'Y' | 'M' | 'D' | 'h' | 'm' | 's';\n  popupButtonValidateClass?: string;\n  popupButtonValidateLabel?: string;\n  timeZone = 'UTC';\n  properties?: any;\n  map?: {\n    tiles?: string[];\n    heatRadius?: number;\n    heatBlur?: number;\n    heatOpacity?: number;\n    heatControls?: boolean;\n    mapType?: string;\n    showTimeSlider?: boolean;\n    showTimeRange?: boolean;\n    timeSliderMin?: number;\n    timeSliderMax?: number;\n    timeSliderStep?: number;\n    timeSliderMode?: 'timestamp' | 'date' | 'custom';\n    timeStart?: number,\n    timeSpan?: number,\n    startLat?: number;\n    startLong?: number;\n    startZoom?: number;\n    timeSpanList?: any[],\n    animate?: boolean;\n  } = {\n    tiles: [],\n    showTimeSlider: false,\n    showTimeRange: false,\n    timeSliderMode: 'timestamp'\n  };\n  bounds: {\n    minDate?: number;\n    maxDate?: number;\n    yRanges?: [number, number];\n  } = {};\n  histo?: {\n    histnorm: 'percent' | 'probability' | 'density' | 'probability density';\n    histfunc: 'count' | 'sum' | 'avg' | 'min' | 'max';\n  };\n  maxValue: number;\n  isRefresh?: boolean;\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport { EventEmitter, Injectable } from '@angular/core';\n\nexport class Size {\n  constructor(public width: number, public height: number) {\n  }\n}\n\n\n@Injectable()\nexport class SizeService {\n  public sizeChanged$: EventEmitter<Size>;\n\n  constructor() {\n    this.sizeChanged$ = new EventEmitter();\n  }\n\n  public change(size: Size): void {\n    this.sizeChanged$.emit(size);\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {ChartLib} from '../utils/chart-lib';\nimport {Param} from '../model/param';\nimport {Logger} from '../utils/logger';\nimport {DataModel} from '../model/dataModel';\nimport {GTS} from '../model/GTS';\nimport {GTSLib} from '../utils/gts.lib';\nimport {Directive, ElementRef, EventEmitter, Input, NgZone, Output, Renderer2, ViewChild} from '@angular/core';\nimport deepEqual from 'deep-equal';\nimport {Size, SizeService} from '../services/resize.service';\nimport {PlotlyComponent} from '../plotly/plotly.component';\nimport {Config} from 'plotly.js';\n\nexport type VisibilityState = 'unknown' | 'nothingPlottable' | 'plottablesAllHidden' | 'plottableShown';\n\n@Directive()\n// tslint:disable-next-line:directive-class-suffix\nexport abstract class WarpViewComponent {\n  @ViewChild('toolTip', {static: true}) toolTip: ElementRef;\n  @ViewChild('graph') graph: PlotlyComponent;\n  @ViewChild('chartContainer', {static: true}) chartContainer: ElementRef;\n\n  @Input('width') width = ChartLib.DEFAULT_WIDTH;\n  @Input('height') height = ChartLib.DEFAULT_HEIGHT;\n\n  @Input('hiddenData') set hiddenData(hiddenData: number[]) {\n    this._hiddenData = hiddenData;\n  }\n\n  get hiddenData(): number[] {\n    return this._hiddenData;\n  }\n\n  @Input('unit') set unit(unit: string) {\n    this._unit = unit;\n    this.update(undefined, false);\n  }\n\n  get unit() {\n    return this._unit;\n  }\n\n  @Input('debug') set debug(debug: boolean | string) {\n    if (typeof debug === 'string') {\n      debug = 'true' === debug;\n    }\n    this._debug = debug;\n    this.LOG.setDebug(debug);\n  }\n\n  get debug() {\n    return this._debug;\n  }\n\n  @Input('showLegend') set showLegend(showLegend: boolean | string) {\n    if (typeof showLegend === 'string') {\n      showLegend = 'true' === showLegend;\n    }\n    this._showLegend = showLegend;\n  }\n\n  get showLegend() {\n    return this._showLegend;\n  }\n\n  @Input('responsive') set responsive(responsive: boolean | string) {\n    if (typeof responsive === 'string') {\n      responsive = 'true' === responsive;\n    }\n    this._responsive = responsive;\n  }\n\n  get responsive() {\n    return this._responsive;\n  }\n\n  @Input('options') set options(options: Param | string) {\n    this.LOG.debug(['onOptions'], options);\n    if (typeof options === 'string') {\n      options = JSON.parse(options);\n    }\n    if (!deepEqual(options, this._options)) {\n      this.LOG.debug(['onOptions', 'changed'], options);\n      this._options = options as Param;\n      this.update(this._options, false);\n    }\n  }\n\n  @Input('data') set data(data: string | DataModel | GTS[]) {\n    this.LOG.debug(['onData'], data);\n    if (data) {\n      this._data = GTSLib.getData(data);\n      this.update(this._options, this._options.isRefresh);\n      this.LOG.debug(['onData'], this._data);\n    }\n  }\n\n  @Output('chartDraw') chartDraw = new EventEmitter<any>();\n\n  _options: Param = new Param();\n  protected LOG: Logger;\n  protected defOptions = ChartLib.mergeDeep(new Param(), {\n    dotsLimit: 1000,\n    heatControls: false,\n    timeMode: 'date',\n    showRangeSelector: true,\n    gridLineColor: '#8e8e8e',\n    showDots: false,\n    timeZone: 'UTC',\n    timeUnit: 'us',\n    showControls: true,\n    // bounds: {}\n  }) as Param;\n\n  protected _debug = false;\n  protected _showLegend = false;\n  protected _responsive = true;\n  protected _unit = '';\n  protected _data: DataModel;\n  protected _autoResize = true;\n  protected _hiddenData: number[] = [];\n  protected divider: number;\n\n  tooltipPosition: any = {top: '-10000px', left: '-1000px'};\n  loading = true;\n  noData = false;\n  layout: Partial<any> = {\n    margin: {\n      t: 10,\n      b: 25,\n      r: 10,\n      l: 10\n    }\n  };\n  plotlyConfig: Partial<Config> = {\n    responsive: true,\n    showAxisDragHandles: true,\n    scrollZoom: true,\n    doubleClick: 'reset+autosize',\n    showTips: true,\n    plotGlPixelRatio: 1,\n    staticPlot: false,\n    displaylogo: false,\n    modeBarButtonsToRemove: [\n      'lasso2d', 'select2d', 'toggleSpikelines', 'toggleHover', 'hoverClosest3d', 'autoScale2d',\n      'hoverClosestGeo', 'hoverClosestGl2d', 'hoverClosestPie', 'toggleHover',\n      'hoverClosestCartesian', 'hoverCompareCartesian'\n    ]\n  };\n  plotlyData: Partial<any>[];\n  private hideTooltipTimer: any;\n  private rect: any;\n\n  protected constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    this.sizeService.sizeChanged$.subscribe((size: Size) => {\n      if ((el.nativeElement as HTMLElement).parentElement) {\n        const parentSize = (el.nativeElement as HTMLElement).parentElement.getBoundingClientRect();\n        if (this._responsive) {\n          this.height = parentSize.height;\n          this.width = parentSize.width;\n        }\n        if (!!this.graph && this._responsive && parentSize.height > 0) {\n          const layout = {\n            width: parentSize.width,\n            height: this._autoResize ? parentSize.height : this.layout.height\n          };\n          if (this.layout.width !== layout.width || this.layout.height !== layout.height) {\n            setTimeout(() => this.layout = {...this.layout, ...layout});\n            this.LOG.debug(['sizeChanged$'], this.layout.width, this.layout.height);\n            this.graph.resize(layout);\n          }\n        }\n      }\n    });\n  }\n\n  protected abstract update(options: Param, refresh: boolean): void;\n\n  protected abstract convert(data: DataModel): Partial<any>[];\n\n  protected legendFormatter(x, series, highlighted = -1): string {\n    const displayedCurves = [];\n    if (x === null) {\n      // This happens when there's no selection and {legend: 'always'} is set.\n      return `<br>\n      ${series.map(s => {\n        // FIXME :  if (!s.isVisible) return;\n        let labeledData = GTSLib.formatLabel(s.data.text || '') + ': ' + ((this._options.horizontal ? s.x : s.y) || s.r || '');\n        let color = s.data.line.color;\n        if (!!s.data.marker) {\n          if (GTSLib.isArray(s.data.marker.color)) {\n            color = s.data.marker.color[0];\n          } else {\n            color = s.data.marker.color;\n          }\n        }\n        if (s.curveNumber === highlighted) {\n          labeledData = `<i class=\"chip\"\n    style=\"background-color: ${color};border: 2px solid ${color};\"></i> ${labeledData}`;\n        }\n        return labeledData;\n      }).join('<br>')}`;\n    }\n\n    let html = '';\n    if (!!series[0]) {\n      x = series[0].x || series[0].theta;\n    }\n    html += `<b>${x}</b><br />`;\n    // put the highlighted one(s?) first, keep only visibles, keep only 50 first ones.\n    series = series.sort((sa, sb) => (sa.curveNumber === highlighted) ? -1 : 1);\n    series\n      // .filter(s => s.isVisible && s.yHTML)\n      .slice(0, 50)\n      .forEach((s, i) => {\n        if (displayedCurves.indexOf(s.curveNumber) <= -1) {\n          displayedCurves.push(s.curveNumber);\n          let value = series[0].data.orientation === 'h' ? s.x : s.y;\n          if (!value && value !== 0) {\n            value = s.r;\n          }\n          let labeledData = GTSLib.formatLabel(s.data.text || '') + ': ' + value;\n          if (s.curveNumber === highlighted) {\n            labeledData = `<b>${labeledData}</b>`;\n          }\n          let color = s.data.line ? s.data.line.color : '';\n          if (!!s.data.marker) {\n            if (GTSLib.isArray(s.data.marker.color)) {\n              color = s.data.marker.color[0];\n            } else {\n              color = s.data.marker.color;\n            }\n          }\n          html += `<i class=\"chip\" style=\"background-color: ${color};border: 2px solid ${color};\"></i>&nbsp;${labeledData}`;\n          if (i < series.length) {\n            html += '<br>';\n          }\n        }\n      });\n    return html;\n  }\n\n  protected initChart(el: ElementRef, resize = true): boolean {\n    this.noData = false;\n    const parentSize = (el.nativeElement as HTMLElement).parentElement.parentElement.getBoundingClientRect();\n    if (this._responsive) {\n      if (resize) {\n        if (\n          this._autoResize && (parentSize.height === 0 || this.height !== parentSize.height)\n          || parentSize.width === 0 || this.width !== parentSize.width) {\n          if (this._autoResize) {\n            this.height = parentSize.height;\n          }\n          this.width = parentSize.width;\n          setTimeout(() => this.initChart(el), 100);\n          return;\n        } else {\n          if (this._autoResize) {\n            this.height = parentSize.height;\n          }\n          this.width = parentSize.width;\n        }\n      }\n    }\n    this.LOG.debug(['initiChart', 'this._data'], this._data, this._options);\n    if (!this._data || !this._data.data || this._data.data.length === 0 || !this._options) {\n      this.loading = false;\n      this.LOG.debug(['initiChart', 'nodata']);\n      this.noData = true;\n      this.chartDraw.emit();\n      return false;\n    }\n    this._options = ChartLib.mergeDeep<Param>(this.defOptions, this._options || {}) as Param;\n    const dataModel = this._data;\n    this._options = ChartLib.mergeDeep<Param>(this._options || {} as Param, this._data.globalParams) as Param;\n    this._options.timeMode = this._options.timeMode || 'date';\n    this.loading = !this._options.isRefresh;\n    this.divider = GTSLib.getDivider(this._options.timeUnit);\n    this.plotlyData = this.convert(dataModel);\n    this.plotlyConfig.responsive = this._responsive;\n    this.layout.paper_bgcolor = 'rgba(0,0,0,0)';\n    this.layout.plot_bgcolor = 'rgba(0,0,0,0)';\n    if (!this._responsive) {\n      this.layout.width = this.width || ChartLib.DEFAULT_WIDTH;\n      this.layout.height = this.height || ChartLib.DEFAULT_HEIGHT;\n    } else {\n      this.layout.width = this.width || parentSize.width;\n      this.layout.height = this.height || parentSize.height;\n    }\n    this.layout.showLegend = !!this._options.showLegend;\n    this.LOG.debug(['initiChart', 'plotlyData'], this.plotlyData);\n    this.loading = false;\n    this.chartDraw.emit();\n    return !(!this.plotlyData || this.plotlyData.length === 0);\n  }\n\n  afterPlot(plotlyInstance?: any) {\n    this.LOG.debug(['afterPlot', 'plotlyInstance'], plotlyInstance);\n    this.loading = false;\n    this.rect = this.graph.getBoundingClientRect();\n    this.chartDraw.emit();\n  }\n\n  hideTooltip() {\n    if (!!this.hideTooltipTimer) {\n      clearTimeout(this.hideTooltipTimer);\n    }\n    this.hideTooltipTimer = setTimeout(() => {\n      this.toolTip.nativeElement.style.display = 'none';\n    }, 1000);\n  }\n\n  unhover(data?: any, point?: any) {\n    this.LOG.debug(['unhover'], data);\n    if (!!this.hideTooltipTimer) {\n      clearTimeout(this.hideTooltipTimer);\n    }\n  }\n\n  hover(data: any, point?: any) {\n    this.renderer.setStyle(this.toolTip.nativeElement, 'display', 'block');\n    if (!!this.hideTooltipTimer) {\n      clearTimeout(this.hideTooltipTimer);\n    }\n    let delta = Number.MAX_VALUE;\n    const curves = [];\n    if (!point) {\n      if (data.points[0] && data.points[0].data.orientation !== 'h') {\n        const y = (data.yvals || [''])[0];\n        data.points.forEach(p => {\n          curves.push(p.curveNumber);\n          const d = Math.abs((p.y || p.r) - y);\n          if (d < delta) {\n            delta = d;\n            point = p;\n          }\n        });\n      } else {\n        const x: number = (data.xvals || [''])[0];\n        data.points.forEach(p => {\n          curves.push(p.curveNumber);\n          const d = Math.abs((p.x || p.r) - x);\n          if (d < delta) {\n            delta = d;\n            point = p;\n          }\n        });\n      }\n    }\n    if (point && !!data.event) {\n      const content = this.legendFormatter(\n        this._options.horizontal ?\n          (data.yvals || [''])[0] :\n          (data.xvals || [''])[0]\n        , data.points, point.curveNumber);\n      let left = (data.event.offsetX + 20) + 'px';\n      if (data.event.offsetX > this.chartContainer.nativeElement.clientWidth / 2) {\n        left = Math.max(0, data.event.offsetX - this.toolTip.nativeElement.clientWidth - 20) + 'px';\n      }\n      const top = Math.min(\n        this.el.nativeElement.getBoundingClientRect().height - this.toolTip.nativeElement.getBoundingClientRect().height - 20,\n        data.event.y - 20 - this.el.nativeElement.getBoundingClientRect().top) + 'px';\n      this.moveTooltip(top, left, content);\n    }\n  }\n\n  getTooltipPosition() {\n    return {\n      top: this.tooltipPosition.top,\n      left: this.tooltipPosition.left,\n    };\n  }\n\n  private moveTooltip(top, left, content) {\n    this.tooltipPosition = {top, left};\n    this.renderer.setProperty(this.toolTip.nativeElement, 'innerHTML', content);\n    this.LOG.debug(['hover - moveTooltip'], new Date().toISOString());\n  }\n\n  relayout($event: any) {\n\n  }\n\n  protected getLabelColor(el: HTMLElement) {\n    return this.getCSSColor(el, '--warp-view-chart-label-color', '#8e8e8e').trim();\n  }\n\n  protected getGridColor(el: HTMLElement) {\n    return this.getCSSColor(el, '--warp-view-chart-grid-color', '#8e8e8e').trim();\n  }\n\n  protected getCSSColor(el: HTMLElement, property: string, defColor: string) {\n    const color = getComputedStyle(el).getPropertyValue(property).trim();\n    return color === '' ? defColor : color;\n  }\n}\n","/* tslint:disable:no-bitwise */\n\n/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nexport class Timsort {\n\n  /**\n   * Default minimum size of a run.\n   */\n  private static DEFAULT_MIN_MERGE = 32;\n\n  /**\n   * Minimum ordered subsequece required to do galloping.\n   */\n  private static DEFAULT_MIN_GALLOPING = 7;\n\n  /**\n   * Default tmp storage length. Can increase depending on the size of the\n   * smallest run to merge.\n   */\n  private static DEFAULT_TMP_STORAGE_LENGTH = 256;\n\n  /**\n   * Pre-computed powers of 10 for efficient lexicographic comparison of\n   * small integers.\n   */\n  private static POWERS_OF_TEN = [1e0, 1e1, 1e2, 1e3, 1e4, 1e5, 1e6, 1e7, 1e8, 1e9];\n\n  private readonly array = null;\n  private readonly compare = null;\n  private minGallop = Timsort.DEFAULT_MIN_GALLOPING;\n  private readonly length = 0;\n  private readonly tmpStorageLength = Timsort.DEFAULT_TMP_STORAGE_LENGTH;\n  private readonly stackLength: number = 0;\n  private readonly runStart = null;\n  private readonly runLength = null;\n  private stackSize = 0;\n  private readonly tmp: any;\n\n  constructor(array, compare) {\n    this.array = array;\n    this.compare = compare;\n    this.length = array.length;\n    if (this.length < 2 * Timsort.DEFAULT_TMP_STORAGE_LENGTH) {\n      this.tmpStorageLength = this.length >>> 1;\n    }\n    this.tmp = new Array(this.tmpStorageLength);\n    this.stackLength = (this.length < 120 ? 5 : this.length < 1542 ? 10 : this.length < 119151 ? 19 : 40);\n    this.runStart = new Array(this.stackLength);\n    this.runLength = new Array(this.stackLength);\n  }\n\n  private static log10(x) {\n    if (x < 1e5) {\n      if (x < 1e2) {\n        return x < 1e1 ? 0 : 1;\n      }\n      if (x < 1e4) {\n        return x < 1e3 ? 2 : 3;\n      }\n      return 4;\n    }\n    if (x < 1e7) {\n      return x < 1e6 ? 5 : 6;\n    }\n    if (x < 1e9) {\n      return x < 1e8 ? 7 : 8;\n    }\n    return 9;\n  }\n\n  private static minRunLength(n) {\n    let r = 0;\n    while (n >= Timsort.DEFAULT_MIN_MERGE) {\n      r |= (n & 1);\n      n >>= 1;\n    }\n    return n + r;\n  }\n\n  private static makeAscendingRun(array, lo, hi, compare) {\n    let runHi = lo + 1;\n    if (runHi === hi) {\n      return 1;\n    }\n    // Descending\n    if (compare(array[runHi++], array[lo]) < 0) {\n      while (runHi < hi && compare(array[runHi], array[runHi - 1]) < 0) {\n        runHi++;\n      }\n      Timsort.reverseRun(array, lo, runHi);\n      // Ascending\n    } else {\n      while (runHi < hi && compare(array[runHi], array[runHi - 1]) >= 0) {\n        runHi++;\n      }\n    }\n    return runHi - lo;\n  }\n\n  private static reverseRun(array, lo, hi) {\n    hi--;\n    while (lo < hi) {\n      const t = array[lo];\n      array[lo++] = array[hi];\n      array[hi--] = t;\n    }\n  }\n\n  private static binaryInsertionSort(array, lo, hi, start, compare) {\n    if (start === lo) {\n      start++;\n    }\n    for (; start < hi; start++) {\n      const pivot = array[start];\n      // Ranges of the array where pivot belongs\n      let left = lo;\n      let right = start;\n      while (left < right) {\n        const mid = (left + right) >>> 1;\n        if (compare(pivot, array[mid]) < 0) {\n          right = mid;\n        } else {\n          left = mid + 1;\n        }\n      }\n      let n = start - left;\n      // Switch is just an optimization for small arrays\n      switch (n) {\n        case 3:\n          array[left + 3] = array[left + 2];\n        /* falls through */\n        case 2:\n          array[left + 2] = array[left + 1];\n        /* falls through */\n        case 1:\n          array[left + 1] = array[left];\n          break;\n        default:\n          while (n > 0) {\n            array[left + n] = array[left + n - 1];\n            n--;\n          }\n      }\n      array[left] = pivot;\n    }\n  }\n\n  private static gallopLeft(value, array, start, length, hint, compare) {\n    let lastOffset = 0;\n    let maxOffset;\n    let offset = 1;\n    if (compare(value, array[start + hint]) > 0) {\n      maxOffset = length - hint;\n      while (offset < maxOffset && compare(value, array[start + hint + offset]) > 0) {\n        lastOffset = offset;\n        offset = (offset << 1) + 1;\n        if (offset <= 0) {\n          offset = maxOffset;\n        }\n      }\n      if (offset > maxOffset) {\n        offset = maxOffset;\n      }\n      // Make offsets relative to start\n      lastOffset += hint;\n      offset += hint;\n      // value <= array[start + hint]\n    } else {\n      maxOffset = hint + 1;\n      while (offset < maxOffset && compare(value, array[start + hint - offset]) <= 0) {\n        lastOffset = offset;\n        offset = (offset << 1) + 1;\n        if (offset <= 0) {\n          offset = maxOffset;\n        }\n      }\n      if (offset > maxOffset) {\n        offset = maxOffset;\n      }\n      // Make offsets relative to start\n      const tmp = lastOffset;\n      lastOffset = hint - offset;\n      offset = hint - tmp;\n    }\n    lastOffset++;\n    while (lastOffset < offset) {\n      const m = lastOffset + ((offset - lastOffset) >>> 1);\n      if (compare(value, array[start + m]) > 0) {\n        lastOffset = m + 1;\n      } else {\n        offset = m;\n      }\n    }\n    return offset;\n  }\n\n  private static gallopRight(value, array, start, length, hint, compare) {\n    let lastOffset = 0;\n    let maxOffset;\n    let offset = 1;\n    if (compare(value, array[start + hint]) < 0) {\n      maxOffset = hint + 1;\n      while (offset < maxOffset && compare(value, array[start + hint - offset]) < 0) {\n        lastOffset = offset;\n        offset = (offset << 1) + 1;\n        if (offset <= 0) {\n          offset = maxOffset;\n        }\n      }\n      if (offset > maxOffset) {\n        offset = maxOffset;\n      }\n      // Make offsets relative to start\n      const tmp = lastOffset;\n      lastOffset = hint - offset;\n      offset = hint - tmp;\n      // value >= array[start + hint]\n    } else {\n      maxOffset = length - hint;\n      while (offset < maxOffset && compare(value, array[start + hint + offset]) >= 0) {\n        lastOffset = offset;\n        offset = (offset << 1) + 1;\n        if (offset <= 0) {\n          offset = maxOffset;\n        }\n      }\n      if (offset > maxOffset) {\n        offset = maxOffset;\n      }\n      // Make offsets relative to start\n      lastOffset += hint;\n      offset += hint;\n    }\n    lastOffset++;\n    while (lastOffset < offset) {\n      const m = lastOffset + ((offset - lastOffset) >>> 1);\n      if (compare(value, array[start + m]) < 0) {\n        offset = m;\n      } else {\n        lastOffset = m + 1;\n      }\n    }\n    return offset;\n  }\n\n  private static alphabeticalCompare(a, b) {\n    if (a === b) {\n      return 0;\n    }\n    if (~~a === a && ~~b === b) {\n      if (a === 0 || b === 0) {\n        return a < b ? -1 : 1;\n      }\n      if (a < 0 || b < 0) {\n        if (b >= 0) {\n          return -1;\n        }\n        if (a >= 0) {\n          return 1;\n        }\n        a = -a;\n        b = -b;\n      }\n      const al = Timsort.log10(a);\n      const bl = Timsort.log10(b);\n      let t = 0;\n      if (al < bl) {\n        a *= Timsort.POWERS_OF_TEN[bl - al - 1];\n        b /= 10;\n        t = -1;\n      } else if (al > bl) {\n        b *= Timsort.POWERS_OF_TEN[al - bl - 1];\n        a /= 10;\n        t = 1;\n      }\n      if (a === b) {\n        return t;\n      }\n      return a < b ? -1 : 1;\n    }\n    const aStr = String(a);\n    const bStr = String(b);\n    if (aStr === bStr) {\n      return 0;\n    }\n    return aStr < bStr ? -1 : 1;\n  }\n\n  public static sort(array: any[], compare?: (a: any, b: any) => number, lo?: number, hi?: number) {\n    if (!Array.isArray(array)) {\n      throw new TypeError('Can only sort arrays');\n    }\n    if (!compare) {\n      compare = Timsort.alphabeticalCompare;\n    } else if (typeof compare !== 'function') {\n      hi = lo;\n      lo = compare;\n      compare = Timsort.alphabeticalCompare;\n    }\n    if (!lo) {\n      lo = 0;\n    }\n    if (!hi) {\n      hi = array.length;\n    }\n    let remaining = hi - lo;\n    // The array is already sorted\n    if (remaining < 2) {\n      return;\n    }\n    let runLength = 0;\n    // On small arrays binary sort can be used directly\n    if (remaining < Timsort.DEFAULT_MIN_MERGE) {\n      runLength = Timsort.makeAscendingRun(array, lo, hi, compare);\n      Timsort.binaryInsertionSort(array, lo, hi, lo + runLength, compare);\n      return;\n    }\n    const ts = new Timsort(array, compare);\n    const minRun = Timsort.minRunLength(remaining);\n    do {\n      runLength = Timsort.makeAscendingRun(array, lo, hi, compare);\n      if (runLength < minRun) {\n        let force = remaining;\n        if (force > minRun) {\n          force = minRun;\n        }\n        Timsort.binaryInsertionSort(array, lo, lo + force, lo + runLength, compare);\n        runLength = force;\n      }\n      // Push new run and merge if necessary\n      ts.pushRun(lo, runLength);\n      ts.mergeRuns();\n      // Go find next run\n      remaining -= runLength;\n      lo += runLength;\n    } while (remaining !== 0);\n    // Force merging of remaining runs\n    ts.forceMergeRuns();\n  }\n\n  pushRun(runStart, runLength) {\n    this.runStart[this.stackSize] = runStart;\n    this.runLength[this.stackSize] = runLength;\n    this.stackSize += 1;\n  }\n\n  mergeRuns() {\n    while (this.stackSize > 1) {\n      let n = this.stackSize - 2;\n      if ((n >= 1 && this.runLength[n - 1] <= this.runLength[n] + this.runLength[n + 1])\n        || (n >= 2 && this.runLength[n - 2] <= this.runLength[n] + this.runLength[n - 1])) {\n        if (this.runLength[n - 1] < this.runLength[n + 1]) {\n          n--;\n        }\n      } else if (this.runLength[n] > this.runLength[n + 1]) {\n        break;\n      }\n      this.mergeAt(n);\n    }\n  }\n\n  forceMergeRuns() {\n    while (this.stackSize > 1) {\n      let n = this.stackSize - 2;\n      if (n > 0 && this.runLength[n - 1] < this.runLength[n + 1]) {\n        n--;\n      }\n      this.mergeAt(n);\n    }\n  }\n\n  mergeAt(i) {\n    const compare = this.compare;\n    const array = this.array;\n    let start1 = this.runStart[i];\n    let length1 = this.runLength[i];\n    const start2 = this.runStart[i + 1];\n    let length2 = this.runLength[i + 1];\n    this.runLength[i] = length1 + length2;\n    if (i === this.stackSize - 3) {\n      this.runStart[i + 1] = this.runStart[i + 2];\n      this.runLength[i + 1] = this.runLength[i + 2];\n    }\n    this.stackSize--;\n    const k = Timsort.gallopRight(array[start2], array, start1, length1, 0, compare);\n    start1 += k;\n    length1 -= k;\n    if (length1 === 0) {\n      return;\n    }\n    length2 = Timsort.gallopLeft(array[start1 + length1 - 1], array, start2, length2, length2 - 1, compare);\n    if (length2 === 0) {\n      return;\n    }\n    if (length1 <= length2) {\n      this.mergeLow(start1, length1, start2, length2);\n\n    } else {\n      this.mergeHigh(start1, length1, start2, length2);\n    }\n  }\n\n  mergeLow(start1, length1, start2, length2) {\n    const compare = this.compare;\n    const array = this.array;\n    const tmp = this.tmp;\n    let i;\n    for (i = 0; i < length1; i++) {\n      tmp[i] = array[start1 + i];\n    }\n    let cursor1 = 0;\n    let cursor2 = start2;\n    let dest = start1;\n    array[dest++] = array[cursor2++];\n    if (--length2 === 0) {\n      for (i = 0; i < length1; i++) {\n        array[dest + i] = tmp[cursor1 + i];\n      }\n      return;\n    }\n    if (length1 === 1) {\n      for (i = 0; i < length2; i++) {\n        array[dest + i] = array[cursor2 + i];\n      }\n      array[dest + length2] = tmp[cursor1];\n      return;\n    }\n    let minGallop = this.minGallop;\n    while (true) {\n      let count1 = 0;\n      let count2 = 0;\n      let exit = false;\n      do {\n        if (compare(array[cursor2], tmp[cursor1]) < 0) {\n          array[dest++] = array[cursor2++];\n          count2++;\n          count1 = 0;\n          if (--length2 === 0) {\n            exit = true;\n            break;\n          }\n        } else {\n          array[dest++] = tmp[cursor1++];\n          count1++;\n          count2 = 0;\n          if (--length1 === 1) {\n            exit = true;\n            break;\n          }\n        }\n      } while ((count1 | count2) < minGallop);\n      if (exit) {\n        break;\n      }\n      do {\n        count1 = Timsort.gallopRight(array[cursor2], tmp, cursor1, length1, 0, compare);\n        if (count1 !== 0) {\n          for (i = 0; i < count1; i++) {\n            array[dest + i] = tmp[cursor1 + i];\n          }\n          dest += count1;\n          cursor1 += count1;\n          length1 -= count1;\n          if (length1 <= 1) {\n            exit = true;\n            break;\n          }\n        }\n        array[dest++] = array[cursor2++];\n        if (--length2 === 0) {\n          exit = true;\n          break;\n        }\n        count2 = Timsort.gallopLeft(tmp[cursor1], array, cursor2, length2, 0, compare);\n        if (count2 !== 0) {\n          for (i = 0; i < count2; i++) {\n            array[dest + i] = array[cursor2 + i];\n          }\n          dest += count2;\n          cursor2 += count2;\n          length2 -= count2;\n          if (length2 === 0) {\n            exit = true;\n            break;\n          }\n        }\n        array[dest++] = tmp[cursor1++];\n        if (--length1 === 1) {\n          exit = true;\n          break;\n        }\n        minGallop--;\n      } while (count1 >= Timsort.DEFAULT_MIN_GALLOPING || count2 >= Timsort.DEFAULT_MIN_GALLOPING);\n      if (exit) {\n        break;\n      }\n      if (minGallop < 0) {\n        minGallop = 0;\n      }\n      minGallop += 2;\n    }\n    this.minGallop = minGallop;\n    if (minGallop < 1) {\n      this.minGallop = 1;\n    }\n    if (length1 === 1) {\n      for (i = 0; i < length2; i++) {\n        array[dest + i] = array[cursor2 + i];\n      }\n      array[dest + length2] = tmp[cursor1];\n    } else if (length1 === 0) {\n      throw new Error('mergeLow preconditions were not respected');\n    } else {\n      for (i = 0; i < length1; i++) {\n        array[dest + i] = tmp[cursor1 + i];\n      }\n    }\n  }\n\n  mergeHigh(start1, length1, start2, length2) {\n    const compare = this.compare;\n    const array = this.array;\n    const tmp = this.tmp;\n    let i;\n    for (i = 0; i < length2; i++) {\n      tmp[i] = array[start2 + i];\n    }\n    let cursor1 = start1 + length1 - 1;\n    let cursor2 = length2 - 1;\n    let dest = start2 + length2 - 1;\n    let customCursor = 0;\n    let customDest = 0;\n    array[dest--] = array[cursor1--];\n    if (--length1 === 0) {\n      customCursor = dest - (length2 - 1);\n      for (i = 0; i < length2; i++) {\n        array[customCursor + i] = tmp[i];\n      }\n      return;\n    }\n    if (length2 === 1) {\n      dest -= length1;\n      cursor1 -= length1;\n      customDest = dest + 1;\n      customCursor = cursor1 + 1;\n      for (i = length1 - 1; i >= 0; i--) {\n        array[customDest + i] = array[customCursor + i];\n      }\n      array[dest] = tmp[cursor2];\n      return;\n    }\n    let minGallop = this.minGallop;\n    while (true) {\n      let count1 = 0;\n      let count2 = 0;\n      let exit = false;\n      do {\n        if (compare(tmp[cursor2], array[cursor1]) < 0) {\n          array[dest--] = array[cursor1--];\n          count1++;\n          count2 = 0;\n          if (--length1 === 0) {\n            exit = true;\n            break;\n          }\n        } else {\n          array[dest--] = tmp[cursor2--];\n          count2++;\n          count1 = 0;\n          if (--length2 === 1) {\n            exit = true;\n            break;\n          }\n        }\n      } while ((count1 | count2) < minGallop);\n      if (exit) {\n        break;\n      }\n      do {\n        count1 = length1 - Timsort.gallopRight(tmp[cursor2], array, start1, length1, length1 - 1, compare);\n        if (count1 !== 0) {\n          dest -= count1;\n          cursor1 -= count1;\n          length1 -= count1;\n          customDest = dest + 1;\n          customCursor = cursor1 + 1;\n          for (i = count1 - 1; i >= 0; i--) {\n            array[customDest + i] = array[customCursor + i];\n          }\n          if (length1 === 0) {\n            exit = true;\n            break;\n          }\n        }\n        array[dest--] = tmp[cursor2--];\n        if (--length2 === 1) {\n          exit = true;\n          break;\n        }\n        count2 = length2 - Timsort.gallopLeft(array[cursor1], tmp, 0, length2, length2 - 1, compare);\n        if (count2 !== 0) {\n          dest -= count2;\n          cursor2 -= count2;\n          length2 -= count2;\n          customDest = dest + 1;\n          customCursor = cursor2 + 1;\n          for (i = 0; i < count2; i++) {\n            array[customDest + i] = tmp[customCursor + i];\n          }\n          if (length2 <= 1) {\n            exit = true;\n            break;\n          }\n        }\n        array[dest--] = array[cursor1--];\n        if (--length1 === 0) {\n          exit = true;\n          break;\n        }\n        minGallop--;\n      } while (count1 >= Timsort.DEFAULT_MIN_GALLOPING || count2 >= Timsort.DEFAULT_MIN_GALLOPING);\n      if (exit) {\n        break;\n      }\n      if (minGallop < 0) {\n        minGallop = 0;\n      }\n      minGallop += 2;\n    }\n    this.minGallop = minGallop;\n    if (minGallop < 1) {\n      this.minGallop = 1;\n    }\n    if (length2 === 1) {\n      dest -= length1;\n      cursor1 -= length1;\n      customDest = dest + 1;\n      customCursor = cursor1 + 1;\n      for (i = length1 - 1; i >= 0; i--) {\n        array[customDest + i] = array[customCursor + i];\n      }\n      array[dest] = tmp[cursor2];\n    } else if (length2 === 0) {\n      throw new Error('mergeHigh preconditions were not respected');\n    } else {\n      customCursor = dest - (length2 - 1);\n      for (i = 0; i < length2; i++) {\n        array[customCursor + i] = tmp[i];\n      }\n    }\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, EventEmitter, Input, NgZone, OnInit, Output, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {DataModel} from '../../model/dataModel';\nimport {GTS} from '../../model/GTS';\nimport {GTSLib} from '../../utils/gts.lib';\nimport moment from 'moment-timezone';\nimport {ChartBounds} from '../../model/chartBounds';\nimport {ColorLib} from '../../utils/color-lib';\nimport {VisibilityState, WarpViewComponent} from '../warp-view-component';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {Subject} from 'rxjs';\nimport {throttleTime} from 'rxjs/operators';\nimport {Timsort} from '../../utils/timsort';\n\n@Component({\n  selector: 'warpview-chart',\n  templateUrl: './warp-view-chart.component.html',\n  styleUrls: ['./warp-view-chart.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewChartComponent extends WarpViewComponent implements OnInit {\n\n  @Input('hiddenData') set hiddenData(hiddenData: number[]) {\n    const previousVisibility = JSON.stringify(this.visibility);\n    this.LOG.debug(['hiddenData', 'previousVisibility'], previousVisibility);\n    this._hiddenData = hiddenData;\n    this.visibility = [];\n    this.visibleGtsId.forEach(id => this.visibility.push(hiddenData.indexOf(id) < 0 && (id !== -1)));\n    this.LOG.debug(['hiddenData', 'hiddendygraphfullv'], this.visibility);\n    const newVisibility = JSON.stringify(this.visibility);\n    this.LOG.debug(['hiddenData', 'json'], previousVisibility, newVisibility, this._hiddenData);\n    if (previousVisibility !== newVisibility) {\n      const visible = [];\n      const hidden = [];\n      (this.gtsId || []).forEach((id, i) => {\n        if (this._hiddenData.indexOf(id) > -1) {\n          hidden.push(i);\n        } else {\n          visible.push(i);\n        }\n      });\n      if (visible.length > 0) {\n        this.graph.restyleChart({visible: true}, visible);\n      }\n      if (hidden.length > 0) {\n        this.graph.restyleChart({visible: false}, hidden);\n      }\n      this.LOG.debug(['hiddendygraphtrig', 'destroy'], 'redraw by visibility change', visible, hidden);\n    }\n  }\n\n  @Input('type') set type(type: string) {\n    this._type = type;\n    this.drawChart();\n  }\n\n  @Input('standalone') standalone = true;\n  @Output('boundsDidChange') boundsDidChange = new EventEmitter<any>();\n  @Output('pointHover') pointHover = new EventEmitter<any>();\n  @Output('warpViewChartResize') warpViewChartResize = new EventEmitter<any>();\n\n  // tslint:disable-next-line:variable-name\n  private _type = 'line';\n  private visibility: boolean[] = [];\n  private maxTick = 0;\n  private minTick = 0;\n  private visibleGtsId = [];\n  private gtsId = [];\n  private dataHashset = {};\n  private chartBounds: ChartBounds = new ChartBounds();\n  private visibilityStatus: VisibilityState = 'unknown';\n  private afterBoundsUpdate = false;\n  private marginLeft: number;\n  private maxPlottable = 10000;\n  parsing = false;\n  unhighliteCurve = new Subject<number[]>();\n  highliteCurve = new Subject<{ on: number[], off: number[] }>();\n  layout: Partial<any> = {\n    showlegend: false,\n    autosize: true,\n    hovermode: 'x',\n    hoverdistance: 20,\n    xaxis: {\n      font: {}\n    },\n    yaxis: {\n      exponentformat: 'none',\n      fixedrange: true,\n      automargin: true,\n      showline: true,\n      font: {}\n    },\n    margin: {\n      t: 0,\n      b: 30,\n      r: 10,\n      l: 50\n    },\n  };\n  private highlighted: any;\n\n  update(options, refresh): void {\n    this.drawChart(refresh);\n  }\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewChartComponent, this._debug);\n  }\n\n  ngOnInit(): void {\n    this._options = this._options || this.defOptions;\n  }\n\n  public async getTimeClip(): Promise<ChartBounds> {\n    return new Promise<ChartBounds>(resolve => {\n      this.LOG.debug(['getTimeClip'], this.chartBounds);\n      resolve(this.chartBounds);\n    });\n  }\n\n  public resize(newHeight: number) {\n    this.LOG.debug(['resize'], newHeight);\n    this.height = newHeight;\n    this.layout.height = this.height;\n    if (this._options.showRangeSelector) {\n      this.layout.xaxis.rangeslider = {\n        bgcolor: 'transparent',\n        thickness: 40 / this.height\n      };\n    }\n  }\n\n  drawChart(reparseNewData: boolean = false) {\n    this.LOG.debug(['drawChart', 'this.layout', 'this.options'], this.layout, this._options, (this._options.bounds || {}).minDate);\n    if (!this.initChart(this.el)) {\n      this.LOG.debug(['drawChart', 'initChart', 'empty'], this._options);\n      return;\n    }\n    this.plotlyConfig.scrollZoom = true;\n    this.layout.yaxis.gridcolor = this.getGridColor(this.el.nativeElement);\n    this.layout.xaxis.gridcolor = this.getGridColor(this.el.nativeElement);\n    this.layout.yaxis.zerolinecolor = this.getGridColor(this.el.nativeElement);\n    this.layout.xaxis.zerolinecolor = this.getGridColor(this.el.nativeElement);\n    this.layout.margin.t = this.standalone ? 20 : 10;\n    this.layout.showlegend = this._showLegend;\n    if (!this._responsive) {\n      this.layout.width = this.width;\n      this.layout.height = this.height;\n    }\n\n    this.LOG.debug(['drawChart', 'this.options'], this.layout, this._options);\n    this.LOG.debug(['drawChart', 'this.layout'], this.layout);\n    this.LOG.debug(['drawChart', 'this.plotlyConfig'], this.plotlyConfig);\n    if (!!this._options.showRangeSelector) {\n      this.resize(this.height);\n    } else {\n      this.layout.margin.b = 30;\n    }\n    this.layout = {...this.layout};\n    this.highliteCurve.pipe(throttleTime(200)).subscribe(value => {\n      this.graph.restyleChart({opacity: 0.4}, value.off);\n      this.graph.restyleChart({opacity: 1}, value.on);\n    });\n    this.unhighliteCurve.pipe(throttleTime(200)).subscribe(value => {\n      this.graph.restyleChart({opacity: 1}, value);\n    });\n    this.loading = false;\n  }\n\n  private emitNewBounds(min, max, marginLeft) {\n    if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n      this.boundsDidChange.emit({bounds: {min, max, marginLeft}, source: 'chart'});\n      this._options.bounds = this._options.bounds || {};\n      this._options.bounds.minDate = min;\n      this._options.bounds.maxDate = max;\n    } else {\n      const minDate = moment.tz(min, this._options.timeZone).valueOf();\n      const maxDate = moment.tz(max, this._options.timeZone).valueOf();\n      this._options.bounds = this._options.bounds || {};\n      this._options.bounds.minDate = minDate;\n      this._options.bounds.maxDate = maxDate;\n      this.boundsDidChange.emit({bounds: {min: minDate, max: maxDate, marginLeft}, source: 'chart'});\n    }\n  }\n\n  protected initChart(el: ElementRef): boolean {\n    const res = super.initChart(el);\n    const x: any = {\n      tick0: undefined,\n      range: [],\n    };\n    this.LOG.debug(['initChart', 'updateBounds'], this.chartBounds, this._options.bounds);\n    const min = (this._options.bounds || {}).minDate || this.chartBounds.tsmin || this.minTick;\n    const max = (this._options.bounds || {}).maxDate || this.chartBounds.tsmax || this.maxTick;\n    this.LOG.debug(['initChart', 'updateBounds'], [min, max]);\n\n    if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n      x.tick0 = min;\n      x.range = [min, max];\n    } else {\n      x.tick0 = GTSLib.toISOString(min, this.divider, this._options.timeZone);\n      x.range = [\n        GTSLib.toISOString(min, this.divider, this._options.timeZone),\n        GTSLib.toISOString(max, this.divider, this._options.timeZone)\n      ];\n    }\n    this.layout.xaxis = x;\n    if (!!res) {\n      this.resize(this.height);\n    }\n    return res;\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    this.parsing = !this._options.isRefresh;\n    this.chartBounds.tsmin = undefined;\n    this.chartBounds.tsmax = undefined;\n    const dataset: Partial<any>[] = [];\n    this.LOG.debug(['convert'], this._options.timeMode);\n    this.LOG.debug(['convert', 'this._hiddenData'], this._hiddenData);\n    this.LOG.debug(['convert', 'this._options.timezone'], this._options.timeZone);\n    if (GTSLib.isArray(data.data)) {\n      let gtsList = GTSLib.flatDeep(GTSLib.flattenGtsIdArray(data.data as any[], 0).res);\n      this.maxTick = Number.NEGATIVE_INFINITY;\n      this.minTick = Number.POSITIVE_INFINITY;\n      this.visibleGtsId = [];\n      this.gtsId = [];\n      const nonPlottable = gtsList.filter(g => (g.v && !GTSLib.isGtsToPlot(g)));\n      gtsList = gtsList.filter(g => g.v && GTSLib.isGtsToPlot(g));\n      // initialize visibility status\n      if (this.visibilityStatus === 'unknown') {\n        this.visibilityStatus = gtsList.length > 0 ? 'plottableShown' : 'nothingPlottable';\n      }\n\n      let timestampMode = true;\n      const tsLimit = 100 * GTSLib.getDivider(this._options.timeUnit);\n      gtsList.forEach((gts: GTS) => {\n        const ticks = gts.v.map(t => t[0]);\n        const size = gts.v.length;\n        timestampMode = timestampMode && (ticks[0] > -tsLimit && ticks[0] < tsLimit);\n        timestampMode = timestampMode && (ticks[size - 1] > -tsLimit && ticks[size - 1] < tsLimit);\n      });\n      if (timestampMode || this._options.timeMode === 'timestamp') {\n        this.layout.xaxis.type = 'linear';\n      } else {\n        this.layout.xaxis.type = 'date';\n      }\n      gtsList.forEach((gts: GTS, i) => {\n        if (gts.v && GTSLib.isGtsToPlot(gts)) {\n          Timsort.sort(gts.v, (a, b) => a[0] - b[0]);\n          const size = gts.v.length;\n          const label = GTSLib.serializeGtsMetadata(gts);\n          const c = ColorLib.getColor(gts.id, this._options.scheme);\n          const color = ((data.params || [])[i] || {datasetColor: c}).datasetColor || c;\n          const type = ((data.params || [])[i] || {type: this._type}).type || this._type;\n          const series: Partial<any> = {\n            type: type === 'spline' ? 'scatter' : 'scattergl',\n            mode: type === 'scatter' ? 'markers' : size > this.maxPlottable ? 'lines' : 'lines+markers',\n            // name: label,\n            text: label,\n            x: [],\n            y: [],\n            line: {color},\n            hoverinfo: 'none',\n            connectgaps: false,\n            visible: !(this._hiddenData.filter(h => h === gts.id).length > 0),\n          };\n          if (type === 'scatter' || size < this.maxPlottable) {\n            series.marker = {\n              size: 3,\n              color: new Array(size).fill(color),\n              line: {color, width: 3},\n              opacity: new Array(size).fill(this._type === 'scatter' || this._options.showDots ? 1 : 0)\n            };\n          }\n          switch (type) {\n            case 'spline':\n              series.line.shape = 'spline';\n              break;\n            case 'area':\n              series.fill = 'tozeroy';\n              series.fillcolor = ColorLib.transparentize(color, 0.3);\n              break;\n            case 'step':\n              series.line.shape = 'hvh';\n              break;\n            case 'step-before':\n              series.line.shape = 'vh';\n              break;\n            case 'step-after':\n              series.line.shape = 'hv';\n              break;\n          }\n          this.visibleGtsId.push(gts.id);\n          this.gtsId.push(gts.id);\n          //  this.LOG.debug(['convert'], 'forEach value');\n          const ticks = gts.v.map(t => t[0]);\n          const values = gts.v.map(t => t[t.length - 1]);\n\n          if (size > 0) {\n            this.minTick = this.minTick || ticks[0];\n            this.maxTick = this.maxTick || ticks[0];\n            for (let v = 1; v < size; v++) {\n              const val = ticks[v];\n              this.minTick = val <= this.minTick ? val : this.minTick;\n              this.maxTick = val >= this.maxTick ? val : this.maxTick;\n            }\n          }\n          if (timestampMode || this._options.timeMode === 'timestamp') {\n            series.x = ticks;\n          } else {\n            series.x = ticks.map(t => GTSLib.toISOString(t, this.divider, this._options.timeZone));\n          }\n          series.y = values;\n          dataset.push(series);\n        }\n      });\n      if (nonPlottable.length > 0 && gtsList.length === 0) {\n        nonPlottable.forEach(g => {\n          g.v.forEach(value => {\n            const ts = value[0];\n            if (ts < this.minTick) {\n              this.minTick = ts;\n            }\n            if (ts > this.maxTick) {\n              this.maxTick = ts;\n            }\n          });\n        });\n        // if there is not any plottable data, we must add a fake one with id -1. This one will always be hidden.\n        if (0 === gtsList.length) {\n          if (!this.dataHashset[this.minTick]) {\n            this.dataHashset[this.minTick] = [0];\n          }\n          if (!this.dataHashset[this.maxTick]) {\n            this.dataHashset[this.maxTick] = [0];\n          }\n          this.visibility.push(false);\n          this.visibleGtsId.push(-1);\n        }\n      }\n    }\n    this.LOG.debug(['convert'], 'end', dataset);\n    this.noData = dataset.length === 0;\n    this.parsing = false;\n    return dataset;\n  }\n\n  afterPlot(plotlyInstance) {\n    super.afterPlot(plotlyInstance);\n    this.marginLeft = parseInt((this.graph.plotEl.nativeElement as HTMLElement).querySelector('g.bglayer > rect').getAttribute('x'), 10);\n\n    this.LOG.debug(['afterPlot', 'marginLeft'], this.marginLeft);\n    if (this.chartBounds.tsmin !== this.minTick || this.chartBounds.tsmax !== this.maxTick) {\n      this.chartBounds.tsmin = this.minTick;\n      this.chartBounds.tsmax = this.maxTick;\n      this.chartBounds.marginLeft = this.marginLeft;\n      this.chartDraw.emit(this.chartBounds);\n      if (this.afterBoundsUpdate || this.standalone) {\n        this.LOG.debug(['afterPlot', 'updateBounds'], this.minTick, this.maxTick);\n        this.emitNewBounds(this.minTick, this.maxTick, this.marginLeft);\n        this.loading = false;\n        this.afterBoundsUpdate = false;\n      }\n    } else {\n      this.loading = false;\n    }\n  }\n\n  relayout(data: any) {\n    let change = false;\n    if (data['xaxis.range'] && data['xaxis.range'].length === 2) {\n      if (this.chartBounds.msmin !== data['xaxis.range'][0] || this.chartBounds.msmax !== data['xaxis.range'][1]) {\n        this.LOG.debug(['relayout', 'updateBounds', 'xaxis.range'], data['xaxis.range']);\n        change = true;\n        this.chartBounds.msmin = data['xaxis.range'][0];\n        this.chartBounds.msmax = data['xaxis.range'][1];\n        this.chartBounds.tsmin = moment.tz(moment(this.chartBounds.msmin), this._options.timeZone).valueOf() * this.divider;\n        this.chartBounds.tsmax = moment.tz(moment(this.chartBounds.msmax), this._options.timeZone).valueOf() * this.divider;\n      }\n    } else if (data['xaxis.range[0]'] && data['xaxis.range[1]']) {\n      if (this.chartBounds.msmin !== data['xaxis.range[0]'] || this.chartBounds.msmax !== data['xaxis.range[1]']) {\n        this.LOG.debug(['relayout', 'updateBounds', 'xaxis.range[x]'], data['xaxis.range[0]']);\n        change = true;\n        this.chartBounds.msmin = data['xaxis.range[0]'];\n        this.chartBounds.msmax = data['xaxis.range[1]'];\n        this.chartBounds.tsmin = moment.tz(moment(this.chartBounds.msmin), this._options.timeZone).valueOf() * this.divider;\n        this.chartBounds.tsmax = moment.tz(moment(this.chartBounds.msmax), this._options.timeZone).valueOf() * this.divider;\n      }\n    } else if (data['xaxis.autorange']) {\n      if (this.chartBounds.tsmin !== this.minTick || this.chartBounds.tsmax !== this.maxTick) {\n        this.LOG.debug(['relayout', 'updateBounds', 'autorange'], data, this.minTick, this.maxTick);\n        change = true;\n        this.chartBounds.tsmin = this.minTick;\n        this.chartBounds.tsmax = this.maxTick;\n      }\n    }\n    if (change) {\n      this.LOG.debug(['relayout', 'updateBounds'], this.chartBounds);\n      this.emitNewBounds(this.chartBounds.tsmin, this.chartBounds.tsmax, this.marginLeft);\n    }\n    this.loading = false;\n    this.afterBoundsUpdate = false;\n  }\n\n  sliderChange($event: any) {\n    this.LOG.debug(['sliderChange'], $event);\n  }\n\n  updateBounds(min, max) {\n    this.LOG.debug(['updateBounds'], min, max, this._options);\n    min = min || this.minTick / this.divider;\n    max = max || this.maxTick / this.divider;\n    this.layout.xaxis.autorange = false;\n    if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n      this.layout.xaxis.range = [min, max];\n      this.layout.xaxis.tick0 = min;\n    } else {\n      this.layout.xaxis.range = [\n        GTSLib.toISOString(min, this.divider, this._options.timeZone),\n        GTSLib.toISOString(max, this.divider, this._options.timeZone)\n      ];\n      this.layout.xaxis.tick0 = GTSLib.toISOString(min, this.divider, this._options.timeZone);\n    }\n    this.layout = {...this.layout};\n    this.LOG.debug(['updateBounds'], this.layout);\n    this.afterBoundsUpdate = true;\n  }\n\n\n  setRealBounds(chartBounds: ChartBounds) {\n    this.afterBoundsUpdate = true;\n    this.minTick = chartBounds.tsmin;\n    this.maxTick = chartBounds.tsmax;\n    this._options.bounds = this._options.bounds || {};\n    this._options.bounds.minDate = this.minTick;\n    this._options.bounds.maxDate = this.maxTick;\n    const x: any = {\n      tick0: undefined,\n      range: [],\n    };\n    if (this._options.showRangeSelector) {\n      x.rangeslider = {\n        bgcolor: 'transparent',\n        thickness: 40 / this.height\n      };\n    }\n    if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n      x.tick0 = this.minTick / this.divider;\n      x.range = [this.minTick, this.maxTick];\n    } else {\n      x.tick0 = GTSLib.toISOString(this.minTick, this.divider, this._options.timeZone);\n      x.range = [\n        GTSLib.toISOString(this.minTick, this.divider, this._options.timeZone),\n        GTSLib.toISOString(this.maxTick, this.divider, this._options.timeZone)\n      ];\n    }\n    this.layout.xaxis = x;\n    this.layout = {...this.layout};\n  }\n\n  hover(data: any) {\n    this.LOG.debug(['hover'], data);\n    let delta = Number.MAX_VALUE;\n    // tslint:disable-next-line:no-shadowed-variable\n    let point;\n    const curves = [];\n    this.toolTip.nativeElement.style.display = 'block';\n    if (data.points[0] && data.points[0].data.orientation !== 'h') {\n      const y = (data.yvals || [''])[0];\n      data.points.forEach(p => {\n        curves.push(p.curveNumber);\n        const d = Math.abs(p.y - y);\n        if (d < delta) {\n          delta = d;\n          point = p;\n        }\n      });\n    } else {\n      const x: number = (data.xvals || [''])[0];\n      data.points.forEach(p => {\n        curves.push(p.curveNumber);\n        const d = Math.abs(p.x - x);\n        if (d < delta) {\n          delta = d;\n          point = p;\n        }\n      });\n    }\n    super.hover(data, point);\n    if (point && this.highlighted !== point.curveNumber) {\n      this.highliteCurve.next({on: [point.curveNumber], off: curves});\n      this.highlighted = point.curveNumber;\n    }\n    this.pointHover.emit(data.event);\n    /*setTimeout(() => {\n      let pn = -1;\n      let tn = -1;\n      let color = [];\n      let line = {};\n      let opacity = [];\n      data.points.forEach(p => {\n        if (!!p.data.marker) {\n          color = p.data.marker.color;\n          opacity = p.data.marker.opacity;\n          line = p.data.marker.line;\n          pn = p.pointNumber;\n          tn = p.curveNumber;\n          if (pn >= 0) {\n            color[pn] = 'transparent';\n            opacity[pn] = 1;\n            const update = {marker: {color, opacity, line, size: 15}};\n            this.graph.restyleChart(update, [tn]);\n            this.LOG.debug(['hover'], 'restyleChart inner', update, [tn]);\n          }\n        }\n      });\n    })*/\n  }\n\n  unhover(data: any) {\n    let delta = Number.MAX_VALUE;\n    // tslint:disable-next-line:no-shadowed-variable\n    let point;\n    if (data.points[0] && data.points[0].data.orientation !== 'h') {\n      const y = (data.yvals || [''])[0];\n      data.points.forEach(p => {\n        const d = Math.abs(p.y - y);\n        if (d < delta) {\n          delta = d;\n          point = p;\n        }\n      });\n    } else {\n      const x: number = (data.xvals || [''])[0];\n      data.points.forEach(p => {\n        const d = Math.abs(p.x - x);\n        if (d < delta) {\n          delta = d;\n          point = p;\n        }\n      });\n    }\n    if (!!point && this.highlighted !== point.curveNumber) {\n      this.unhighliteCurve.next([this.highlighted]);\n      this.highlighted = undefined;\n    }\n    super.unhover(data, point);\n    /*setTimeout(() => {\n      let pn = -1;\n      let tn = -1;\n      let color = [];\n      let line = {};\n      let opacity = [];\n      data.points.forEach(p => {\n        if (!!p.data.marker) {\n          pn = p.pointNumber;\n          tn = p.curveNumber;\n          color = p.data.marker.color;\n          opacity = p.data.marker.opacity;\n          line = p.data.marker.line;\n          if (pn >= 0) {\n            color[pn] = p.data.line.color;\n            opacity[pn] = this._options.showDots ? 1 : 0;\n            const update = {marker: {color, opacity, line, size: 15}};\n            this.graph.restyleChart(update, [tn]);\n          }\n        }\n      });\n    })*/\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Injectable} from '@angular/core';\nimport {HttpErrorResponse} from '@angular/common/http';\n\nimport {Observable} from 'rxjs/internal/Observable';\nimport {of} from 'rxjs/internal/observable/of';\nimport {Logger} from '../utils/logger';\n\n\n/** Type of the handleError function returned by HttpErrorHandler.createHandleError */\nexport type HandleError = (operation?: string) => (error: HttpErrorResponse) => Observable<string>;\n\n// noinspection UnterminatedStatementJS\n/** Handles HttpClient errors */\n@Injectable()\nexport class HttpErrorHandler {\n  private LOG: Logger;\n\n  /**\n   */\n  constructor() {\n    this.LOG = new Logger(HttpErrorHandler, true);\n  }\n\n  createHandleError = (serviceName = '') =>\n    // tslint:disable-next-line:semicolon\n    (operation = 'operation') => this.handleError(serviceName, operation);\n\n  handleError(serviceName = '', operation = 'operation') {\n    return (error: HttpErrorResponse): Observable<string> => {\n      this.LOG.error([serviceName], error);\n      this.LOG.error([serviceName], `${operation} failed: ${error.statusText}`);\n      const message = ((error.error || {}).message)\n        ? error.error.message\n        : error.status ? error.statusText : 'Server error';\n      this.LOG.error([serviceName], message);\n      return of(message);\n    };\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {HttpClient, HttpResponse} from '@angular/common/http';\nimport {Injectable} from '@angular/core';\nimport {catchError, tap} from 'rxjs/operators';\nimport {HandleError, HttpErrorHandler} from './http-error-handler.service';\nimport {Logger} from '../utils/logger';\nimport {Observable} from 'rxjs';\n\n@Injectable({providedIn: 'root'})\nexport class Warp10Service {\n\n  private LOG: Logger;\n  private readonly handleError: HandleError;\n\n  constructor(\n    private http: HttpClient,\n    private httpErrorHandler: HttpErrorHandler) {\n    this.LOG = new Logger(Warp10Service, true);\n    this.handleError = httpErrorHandler.createHandleError('Warp10Service');\n  }\n\n  exec(warpScript: string, url: string): Observable<HttpResponse<string>> {\n    this.LOG.debug(['exec', 'warpScript'], url, warpScript);\n    return this.http.post<string>(url, warpScript, {\n      // @ts-ignore\n      observe: 'response',\n      // @ts-ignore\n      responseType: 'text'\n    })\n      .pipe(\n        tap(r => this.LOG.debug(['exec', 'result'], r)),\n        catchError(this.handleError('exec'))\n      ) as Observable<HttpResponse<string>>;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {\n  AfterViewInit,\n  Component,\n  ElementRef,\n  EventEmitter,\n  HostListener,\n  Input,\n  NgZone,\n  OnInit,\n  Output,\n  Renderer2,\n  ViewChild\n} from '@angular/core';\nimport {Param} from '../../model/param';\nimport {DataModel} from '../../model/dataModel';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {HttpErrorHandler} from '../../services/http-error-handler.service';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {SizeService} from '../../services/resize.service';\nimport {Warp10Service} from '../../services/warp10.service';\nimport {Logger} from '../../utils/logger';\nimport {HttpResponse} from '@angular/common/http';\nimport {WarpViewResultTileComponent} from '../warp-view-result-tile/warp-view-result-tile.component';\n\n@Component({\n  selector: 'warpview-tile',\n  templateUrl: './warp-view-tile.component.html',\n  styleUrls: ['./warp-view-tile.component.scss'],\n  providers: [HttpErrorHandler]\n})\nexport class WarpViewTileComponent extends WarpViewComponent implements OnInit, AfterViewInit {\n  @ViewChild('warpRef', {static: true}) warpRef: ElementRef;\n  @ViewChild('resultTile') resultTile: WarpViewResultTileComponent;\n\n  @Output('warpscriptResult') warpscriptResult = new EventEmitter<any>();\n  @Output('execStatus') execStatus = new EventEmitter<any>();\n  @Output('execError') execError = new EventEmitter<any>();\n\n  @Input('type') type = 'line';\n  @Input('chartTitle') chartTitle;\n  @Input('url') url = '';\n  @Input('isAlone') isAlone = false; // used by plot to manage its keyboard events\n  @Input('gtsFilter') set gtsFilter(gtsFilter: string) {\n    this._gtsFilter = gtsFilter;\n  }\n\n  @Input()\n  set warpscript(warpScript: string) {\n    if (!!warpScript && this._warpScript !== warpScript) {\n      this._warpScript = warpScript;\n      this.execute(true);\n    }\n  }\n\n  get warpscript(): string {\n    return this._warpScript;\n  }\n\n  loaderMessage = '';\n  error: any;\n  status: string;\n  loading = false;\n  execResult: string;\n\n  private timer: any;\n  private _autoRefresh;\n  private _gtsFilter = '';\n  private _warpScript = '';\n  private execUrl = '';\n  private timeUnit = 'us';\n\n  constructor(\n    public el: ElementRef,\n    public sizeService: SizeService,\n    public renderer: Renderer2,\n    public ngZone: NgZone,\n    private warp10Service: Warp10Service,\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewTileComponent, this._debug);\n  }\n\n  ngOnInit(): void {\n    this._options = this._options || this.defOptions;\n  }\n\n  ngAfterViewInit() {\n    this._warpScript = this._warpScript || this.warpRef.nativeElement.textContent.trim();\n    this.LOG.debug(['ngAfterViewInit', 'warpScript'], this._warpScript);\n    this.el.nativeElement.style.opacity = '1';\n    if (this.warpRef.nativeElement.textContent.trim() !== '') {\n      this.execute(false);\n    }\n  }\n\n  update(options: Param): void {\n    this.LOG.debug(['update', 'options'], options);\n  }\n\n  /* Listeners */\n  @HostListener('document:keyup', ['$event'])\n  // @HostListener('keydown', ['$event'])\n  handleKeyDown(event: KeyboardEvent) {\n    if (event.key === 'r') {\n      this.execute(false);\n    }\n  }\n\n  /** detect some VSCode special modifiers in the beginnig of the code:\n   * @endpoint xxxURLxxx\n   * @timeUnit ns\n   * warning : the first line is empty (to confirm with other browsers)\n   */\n  private detectWarpScriptSpecialComments() {\n    // analyse the first warpScript lines starting with //\n    const extraParamsPattern = /\\s*\\/\\/\\s*@(\\w*)\\s*(.*)$/g;\n    const warpscriptLines = this._warpScript.split('\\n');\n    for (let l = 1; l < warpscriptLines.length; l++) {\n      const currentLine = warpscriptLines[l];\n      if (currentLine === '' || currentLine.search('//') >= 0) {\n        // find and extract\n        let lineOnMatch: RegExpMatchArray | null;\n        const re = RegExp(extraParamsPattern);\n        while (lineOnMatch = re.exec(currentLine)) {\n          const parameterName = lineOnMatch[1];\n          const parameterValue = lineOnMatch[2];\n          switch (parameterName) {\n            case 'endpoint':        //        // @endpoint http://mywarp10server/api/v0/exec\n              this.execUrl = parameterValue;\n              break;\n            case 'timeUnit':\n              this.timeUnit = parameterValue.toLowerCase();   // set the time unit for graphs\n              break;\n            default:\n              break;\n          }\n        }\n      } else {\n        break; // no more comments at the beginning of the file\n      }\n    }\n  }\n\n  private execute(isRefresh: boolean) {\n    if (!!this._warpScript && this._warpScript.trim() !== '') {\n      this.LOG.debug(['execute'], isRefresh);\n      this.error = undefined;\n      this.loading = !isRefresh;\n      this.execResult = undefined;\n      this.loaderMessage = 'Requesting data';\n      this.execUrl = this.url;\n      this.detectWarpScriptSpecialComments();\n      this.LOG.debug(['execute', 'warpScript'], this._warpScript);\n      this.warp10Service.exec(this._warpScript, this.execUrl).subscribe((response: HttpResponse<string> | string) => {\n        this.loading = false;\n        this.LOG.debug(['execute'], response);\n        if ((response as HttpResponse<string>).body) {\n          try {\n            const body = (response as HttpResponse<string>).body;\n            this.warpscriptResult.emit(body);\n            const headers = (response as HttpResponse<string>).headers;\n            this.status = `Your script execution took\n ${GTSLib.formatElapsedTime(parseInt(headers.get('x-warp10-elapsed'), 10))}\n serverside, fetched\n ${headers.get('x-warp10-fetched')} datapoints and performed\n ${headers.get('x-warp10-ops')}  WarpScript operations.`;\n            this.execStatus.emit({\n              message: this.status,\n              ops: parseInt(headers.get('x-warp10-ops'), 10),\n              elapsed: parseInt(headers.get('x-warp10-elapsed'), 10),\n              fetched: parseInt(headers.get('x-warp10-fetched'), 10),\n            });\n            if (this._autoRefresh !== this._options.autoRefresh) {\n              this._autoRefresh = this._options.autoRefresh;\n              if (this.timer) {\n                window.clearInterval(this.timer);\n              }\n              if (this._autoRefresh && this._autoRefresh > 0) {\n                this.timer = window.setInterval(() => {\n                  this.execute(true);\n                }, this._autoRefresh * 1000);\n              }\n            }\n            setTimeout(() => {\n              this.execResult = body;\n              this.resultTile.setResult(this.execResult, isRefresh);\n              this._options.bounds = {};\n              this._options = {...this._options};\n              this.loading = false;\n            });\n          } catch (e) {\n            this.LOG.error(['execute'], e);\n            this.loading = false;\n          }\n        } else {\n          this.LOG.error(['execute'], response);\n          this.error = response;\n          this.loading = false;\n          this.execError.emit(response);\n        }\n      }, e => {\n        this.loading = false;\n        this.execError.emit(e);\n        this.LOG.error(['execute'], e);\n      });\n    }\n  }\n\n  protected convert(data: DataModel): any[] {\n    return [];\n  }\n\n  chartDrawn(event) {\n    this.chartDraw.emit(event);\n  }\n\n  onWarpViewNewOptions(opts: any) {\n    this._options = opts;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, Input, ViewEncapsulation} from '@angular/core';\n\n@Component({\n  selector: 'warpview-spinner',\n  templateUrl: './warp-view-spinner.component.html',\n  styleUrls: ['./warp-view-spinner.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewSpinnerComponent {\n  @Input('message') message = 'Loading and parsing data...';\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, EventEmitter, Input, OnInit, Output} from '@angular/core';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-toggle',\n  templateUrl: './warp-view-toggle.component.html',\n  styleUrls: ['./warp-view-toggle.component.scss']\n})\nexport class WarpViewToggleComponent implements OnInit {\n  @Input('checked') set checked(state: boolean) {\n    this.state = state;\n  }\n\n  get checked(): boolean {\n    return this.state;\n  }\n\n  @Input('text1') text1 = '';\n  @Input('text2') text2 = '';\n\n  @Output('stateChange') stateChange = new EventEmitter<any>();\n\n  state = false;\n\n  constructor(public el: ElementRef) {\n  }\n\n  ngOnInit() {\n    this.state = this.checked;\n  }\n\n  switched() {\n    this.state = !this.state;\n    this.stateChange.emit({state: this.state, id: this.el.nativeElement.id});\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, NgZone, OnInit, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {Param} from '../../model/param';\nimport {DataModel} from '../../model/dataModel';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {ColorLib} from '../../utils/color-lib';\nimport moment from 'moment-timezone';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {Timsort} from '../../utils/timsort';\n\n@Component({\n  selector: 'warpview-bar',\n  templateUrl: './warp-view-bar.component.html',\n  styleUrls: ['./warp-view-bar.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewBarComponent extends WarpViewComponent implements OnInit {\n\n  layout: Partial<any> = {\n    showlegend: false,\n    xaxis: {},\n    yaxis: {\n      exponentformat: 'none',\n      fixedrange: true,\n      showline: true\n    },\n    margin: {\n      t: 10,\n      b: 40,\n      r: 10,\n      l: 50\n    }\n  };\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewBarComponent, this._debug);\n  }\n\n  ngOnInit() {\n    this.drawChart();\n  }\n\n  update(options: Param): void {\n    this.drawChart();\n  }\n\n  private drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.plotlyConfig.scrollZoom = true;\n    this.buildGraph();\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    let gtsList = [];\n    if (GTSLib.isArray(data.data)) {\n      data.data = GTSLib.flatDeep(data.data as any[]);\n      this.LOG.debug(['convert', 'isArray']);\n      if (data.data.length > 0 && GTSLib.isGts(data.data[0])) {\n        this.LOG.debug(['convert', 'isArray 2']);\n        gtsList = GTSLib.flattenGtsIdArray(data.data as any[], 0).res;\n      } else {\n        this.LOG.debug(['convert', 'isArray 3']);\n        gtsList = data.data as any[];\n      }\n    } else {\n      this.LOG.debug(['convert', 'not array']);\n      gtsList = [data.data];\n    }\n    this.LOG.debug(['convert', 'gtsList'], gtsList);\n    const dataset = [];\n    gtsList.forEach((gts, i) => {\n      this.LOG.debug(['convert', 'gts item'], gts);\n      if (gts.v) {\n        Timsort.sort(gts.v, (a, b) => a[0] - b[0]);\n        const label = GTSLib.serializeGtsMetadata(gts);\n        const c = ColorLib.getColor(gts.id || i, this._options.scheme);\n        const color = ((data.params || [])[i] || {datasetColor: c}).datasetColor || c;\n        const series: Partial<any> = {\n          type: 'bar',\n          mode: 'lines+markers',\n          name: label,\n          text: label,\n          orientation: this._options.horizontal ? 'h' : 'v',\n          x: [],\n          y: [],\n          hoverinfo: 'none',\n          marker: {\n            color: ColorLib.transparentize(color),\n            line: {\n              color,\n              width: 1\n            }\n          }\n        };\n        gts.v.forEach(value => {\n          const ts = value[0];\n          if (!this._options.horizontal) {\n            series.y.push(value[value.length - 1]);\n            if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n              series.x.push(ts);\n            } else {\n              series.x.push(GTSLib.toISOString(ts, this.divider, this._options.timeZone));\n            }\n          } else {\n            series.x.push(value[value.length - 1]);\n            if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n              series.y.push(ts);\n            } else {\n              series.y.push(GTSLib.toISOString(ts, this.divider, this._options.timeZone));\n            }\n          }\n        });\n        dataset.push(series);\n      } else {\n        this._options.timeMode = 'custom';\n        this.LOG.debug(['convert', 'gts'], gts);\n        (gts.columns || []).forEach((label, index) => {\n          const c = ColorLib.getColor(gts.id || index, this._options.scheme);\n          const color = ((data.params || [])[index] || {datasetColor: c}).datasetColor || c;\n          const series: Partial<any> = {\n            type: 'bar',\n            mode: 'lines+markers',\n            name: label,\n            text: label,\n            orientation: this._options.horizontal ? 'h' : 'v',\n            x: [],\n            y: [],\n            hoverinfo: 'none',\n            marker: {\n              color: ColorLib.transparentize(color),\n              line: {\n                color,\n                width: 1\n              }\n            }\n          };\n          if (this._options.horizontal) {\n            (gts.rows || []).forEach(r => {\n              series.y.unshift(r[0]);\n              series.x.push(r[index + 1]);\n            });\n          } else {\n            (gts.rows || []).forEach(r => {\n              series.x.push(r[0]);\n              series.y.push(r[index + 1]);\n            });\n          }\n          dataset.push(series);\n        });\n      }\n    });\n    this.LOG.debug(['convert', 'dataset'], dataset, this._options.horizontal);\n    return dataset;\n  }\n\n  private buildGraph() {\n    this.LOG.debug(['buildGraph', 'this.layout'], this.responsive);\n    this.LOG.debug(['buildGraph', 'this.layout'], this.layout);\n    this.LOG.debug(['buildGraph', 'this.plotlyConfig'], this.plotlyConfig);\n    this.layout.showlegend = this._showLegend;\n    this.layout.barmode = this._options.stacked ? 'stack' : 'group';\n    this.layout.yaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.xaxis.color = this.getGridColor(this.el.nativeElement);\n    this.loading = false;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, NgZone, OnInit, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {Param} from '../../model/param';\nimport {DataModel} from '../../model/dataModel';\nimport {ColorLib} from '../../utils/color-lib';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {GTSLib} from '../../utils/gts.lib';\n\n@Component({\n  selector: 'warpview-bubble',\n  templateUrl: './warp-view-bubble.component.html',\n  styleUrls: ['./warp-view-bubble.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewBubbleComponent extends WarpViewComponent implements OnInit {\n\n  layout: Partial<any> = {\n    showlegend: false,\n    xaxis: {},\n    hovermode: 'closest',\n    hoverdistance: 20,\n    yaxis: {},\n    margin: {\n      t: 10,\n      b: 25,\n      r: 10,\n      l: 50\n    }\n  };\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewBubbleComponent, this._debug);\n  }\n\n  ngOnInit() {\n    this.drawChart();\n  }\n\n  update(options: Param): void {\n    this.drawChart();\n  }\n\n  private drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.plotlyConfig.scrollZoom = true;\n    this.buildGraph();\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    const dataset = [];\n    GTSLib.flatDeep(data.data as any []).forEach((gts, i) => {\n      const label = Object.keys(gts)[0];\n      const c = ColorLib.getColor(gts.id || i, this._options.scheme);\n      const color = ((data.params || [])[i] || {datasetColor: c}).datasetColor || c;\n      const series: Partial<any> = {\n        type: 'scattergl',\n        mode: 'markers',\n        name: label,\n        text: label,\n        x: [],\n        y: [],\n        hoverinfo: 'none',\n        marker: {\n          color: ColorLib.transparentize(color),\n          line: {\n            color\n          },\n          size: []\n        }\n      };\n      if (GTSLib.isGts(gts)) {\n        const ticks = gts.v.map(t => t[0]);\n        const values = gts.v.map(t => t[t.length - 1]);\n        const sizes = new Array(gts.v.length).fill(10);\n        if (this._options.timeMode === 'timestamp') {\n          series.x = ticks;\n        } else {\n          series.x = ticks.map(t => GTSLib.toISOString(t, this.divider, this._options.timeZone));\n        }\n        series.y = values;\n        series.marker.size = sizes;\n      } else {\n        gts[label].forEach(value => {\n          series.y.push(value[0]);\n          series.x.push(value[1]);\n          series.marker.size.push(value[2]);\n        });\n      }\n      dataset.push(series);\n    });\n    this.noData = dataset.length === 0;\n    this.LOG.debug(['convert', 'dataset'], dataset);\n    return dataset;\n  }\n\n  private buildGraph() {\n    this.LOG.debug(['drawChart', 'this.responsive'], this._responsive);\n    this.LOG.debug(['drawChart', 'this.layout'], this.layout);\n    this.LOG.debug(['drawChart', 'this.plotlyConfig'], this.plotlyConfig);\n    this.layout.showlegend = this.showLegend;\n    this.layout.yaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.xaxis.color = this.getGridColor(this.el.nativeElement);\n    this.loading = false;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, Input, NgZone, OnInit, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {Param} from '../../model/param';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {DataModel} from '../../model/dataModel';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\n\n@Component({\n  selector: 'warpview-datagrid',\n  templateUrl: './warp-view-datagrid.component.html',\n  styleUrls: ['./warp-view-datagrid.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewDatagridComponent extends WarpViewComponent implements OnInit {\n\n\n  @Input('elemsCount') elemsCount = 15;\n\n  // tslint:disable-next-line:variable-name\n  _tabularData: { name: string, values: any[], headers: string[] }[] = [];\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewDatagridComponent, this._debug);\n  }\n\n  ngOnInit() {\n    this.drawChart();\n  }\n\n  update(options: Param): void {\n    this.drawChart();\n  }\n\n  private drawChart() {\n    this.loading = false;\n    this.chartDraw.emit();\n    if (!this.initChart(this.el)) {\n      return;\n    }\n  }\n\n  private getHeaderParam(i: number, j: number, key: string, def: string): string {\n    return this._data.params && this._data.params[i] && this._data.params[i][key] && this._data.params[i][key][j]\n      ? this._data.params[i][key][j]\n      : this._data.globalParams && this._data.globalParams[key] && this._data.globalParams[key][j]\n        ? this._data.globalParams[key][j]\n        : def;\n  }\n\n  protected convert(data: DataModel): any[] {\n    if (GTSLib.isArray(data.data)) {\n      const dataList = GTSLib.flatDeep(this._data.data as any[]);\n      this.LOG.debug(['convert', 'isArray'], dataList);\n      if (data.data.length > 0 && GTSLib.isGts(dataList[0])) {\n        this._tabularData = this.parseData(dataList);\n      } else {\n        this._tabularData = this.parseCustomData(dataList);\n      }\n    } else {\n      this._tabularData = this.parseCustomData([data.data as any]);\n    }\n    return [];\n  }\n\n  private parseCustomData(data: any[]): { name: string, values: any[], headers: string[] }[] {\n    const flatData: { name: string, values: any[], headers: string[] }[] = [];\n    data.forEach(d => {\n      const dataSet: { name: string, values: any[], headers: string[] } = {\n        name: d.title || '',\n        values: d.rows,\n        headers: d.columns,\n      };\n      flatData.push(dataSet);\n    });\n    this.LOG.debug(['parseCustomData', 'flatData'], flatData);\n    return flatData;\n  }\n\n  protected parseData(data: any[]): { name: string, values: any[], headers: string[] }[] {\n    const flatData: { name: string, values: any[], headers: string[] }[] = [];\n    this.LOG.debug(['parseData'], data);\n    data.forEach((d, i) => {\n      const dataSet: { name: string, values: any[], headers: string[] } = {\n        name: '',\n        values: [],\n        headers: []\n      };\n      if (GTSLib.isGts(d)) {\n        this.LOG.debug(['parseData', 'isGts'], d);\n        dataSet.name = GTSLib.serializeGtsMetadata(d);\n        dataSet.values = d.v.map(v => [this.formatDate(v[0])].concat(v.slice(1, v.length)));\n      } else {\n        this.LOG.debug(['parseData', 'is not a Gts'], d);\n        dataSet.values = GTSLib.isArray(d) ? d : [d];\n      }\n      dataSet.headers = [this.getHeaderParam(i, 0, 'headers', 'Date')];\n      if (d.v && d.v.length > 0 && d.v[0].length > 2) {\n        dataSet.headers.push(this.getHeaderParam(i, 1, 'headers', 'Latitude'));\n      }\n      if (d.v && d.v.length > 0 && d.v[0].length > 3) {\n        dataSet.headers.push(this.getHeaderParam(i, 2, 'headers', 'Longitude'));\n      }\n      if (d.v && d.v.length > 0 && d.v[0].length > 4) {\n        dataSet.headers.push(this.getHeaderParam(i, 3, 'headers', 'Elevation'));\n      }\n      if (d.v && d.v.length > 0) {\n        dataSet.headers.push(this.getHeaderParam(i, d.v[0].length - 1, 'headers', 'Value'));\n      }\n      if (dataSet.values.length > 0) {\n        flatData.push(dataSet);\n      }\n    });\n    this.LOG.debug(['parseData', 'flatData'], flatData, this._options.timeMode);\n    return flatData;\n  }\n\n  formatDate(date: number): string {\n    return this._options.timeMode === 'date' ? GTSLib.toISOString(date, this.divider, this._options.timeZone) : date.toString();\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, Input, OnInit, ViewEncapsulation} from '@angular/core';\nimport {Logger} from '../../../utils/logger';\nimport {Param} from '../../../model/param';\nimport {ChartLib} from '../../../utils/chart-lib';\nimport deepEqual from 'deep-equal';\nimport {GTSLib} from '../../../utils/gts.lib';\n\n@Component({\n  selector: 'warpview-paginable',\n  templateUrl: './warp-view-paginable.component.html',\n  styleUrls: ['./warp-view-paginable.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewPaginableComponent implements OnInit {\n  constructor() {\n    this.LOG = new Logger(WarpViewPaginableComponent, this.debug);\n  }\n\n  @Input('debug') set debug(debug: boolean) {\n    this._debug = debug;\n    this.LOG.setDebug(debug);\n  }\n\n  get debug() {\n    return this._debug;\n  }\n\n  @Input('options') set options(options: Param) {\n    if (!deepEqual(options, this._options)) {\n      this.drawGridData();\n    }\n  }\n\n  @Input('data') set data(data: { name: string, values: any[], headers: string[] }) {\n    if (data) {\n      this._data = data;\n      this.drawGridData();\n    }\n  }\n\n  @Input('elemsCount') elemsCount = 15;\n  @Input('windowed') windowed = 5;\n\n  page = 0;\n  pages: number[] = [];\n  // tslint:disable-next-line:variable-name\n  _data: { name: string, values: any[], headers: string[] };\n  displayedValues: any[] = [];\n  private LOG: Logger;\n  // tslint:disable-next-line:variable-name\n  private _debug = false;\n  // tslint:disable-next-line:variable-name\n  private _options: Param = {\n    ...new Param(), ...{\n      timeMode: 'date',\n      timeZone: 'UTC',\n      timeUnit: 'us',\n      bounds: {}\n    }\n  };\n\n  goto(page: number) {\n    this.page = page;\n    this.drawGridData();\n  }\n\n  next() {\n    this.page = Math.min(this.page + 1, this._data.values.length - 1);\n    this.drawGridData();\n  }\n\n  prev() {\n    this.page = Math.max(this.page - 1, 0);\n    this.drawGridData();\n  }\n\n  private drawGridData() {\n    this._options = ChartLib.mergeDeep(this._options, this.options) as Param;\n    this.LOG.debug(['drawGridData', '_options'], this._options);\n    if (!this._data) {\n      return;\n    }\n    this.pages = [];\n    for (let i = 0; i < (this._data.values || [] ).length / this.elemsCount; i++) {\n      this.pages.push(i);\n    }\n    this.displayedValues = (this._data.values || [] ).slice(\n      Math.max(0, this.elemsCount * this.page),\n      Math.min(this.elemsCount * (this.page + 1), (this._data.values || [] ).length)\n    );\n    this.LOG.debug(['drawGridData', '_data'], this._data);\n  }\n\n  decodeURIComponent(str: string): string {\n    return decodeURIComponent(str);\n  }\n\n  ngOnInit() {\n    this.drawGridData();\n  }\n\n  formatLabel(name: string) {\n    return GTSLib.formatLabel(name);\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, NgZone, OnDestroy, OnInit, Renderer2, ViewChild, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {Param} from '../../model/param';\nimport {ChartLib} from '../../utils/chart-lib';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {DataModel} from '../../model/dataModel';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport fitty, {FittyInstance} from 'fitty';\nimport moment from 'moment-timezone';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-display',\n  templateUrl: './warp-view-display.component.html',\n  styleUrls: ['./warp-view-display.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewDisplayComponent extends WarpViewComponent implements OnInit, OnDestroy {\n  @ViewChild('wrapper', {static: true}) wrapper: ElementRef;\n  toDisplay = '';\n  defOptions = {\n    timeMode: 'custom'\n  } as Param;\n\n  private fitties: FittyInstance;\n  private timer;\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewDisplayComponent, this._debug);\n  }\n\n  ngOnInit() {\n    this.drawChart();\n  }\n\n  ngOnDestroy(): void {\n    if (this.timer) {\n      clearInterval(this.timer);\n    }\n  }\n\n  update(options: Param, refresh: boolean): void {\n    this.drawChart();\n    this.flexFont();\n  }\n\n  private drawChart() {\n    this.LOG.debug(['drawChart'], this._options, this.defOptions);\n    this.initChart(this.el);\n    this._options = ChartLib.mergeDeep(this.defOptions, this._options);\n    this.LOG.debug(['drawChart', 'afterInit'], this._options, this.defOptions, this.height);\n    this.LOG.debug(['drawChart'], this._data, this.toDisplay);\n    this.flexFont();\n    this.chartDraw.emit();\n  }\n\n  protected convert(data: DataModel): any[] {\n    this._options = ChartLib.mergeDeep(this.defOptions, this._options);\n    this.LOG.debug(['convert'], this._options.timeMode);\n    let display: string;\n    if (this._data.data) {\n      display = GTSLib.isArray(this._data.data) ? this._data.data[0] : this._data.data;\n    } else {\n      display = GTSLib.isArray(this._data) ? this._data[0] : this._data;\n    }\n    switch (this._options.timeMode) {\n      case 'date':\n        this.toDisplay = GTSLib.toISOString(parseInt(display, 10), this.divider, this._options.timeZone);\n        break;\n      case 'duration':\n        const start = GTSLib.toISOString(parseInt(display, 10), this.divider, this._options.timeZone);\n        this.displayDuration(moment(start));\n        break;\n      case 'custom':\n      case 'timestamp':\n        this.toDisplay = display;\n    }\n    return [];\n  }\n\n  getStyle() {\n    if (!this._options) {\n      return {};\n    } else {\n      const style: any = {'background-color': this._options.bgColor || 'transparent'};\n      if (this._options.fontColor) {\n        style.color = this._options.fontColor;\n      }\n      return style;\n    }\n  }\n\n  flexFont() {\n    if (!!this.wrapper) {\n      this.LOG.debug(['flexFont'], this.height);\n      if (this.fitties) {\n        this.fitties.unsubscribe();\n      }\n      this.fitties = fitty(this.wrapper.nativeElement, {\n        maxSize: (this.el.nativeElement as HTMLElement).parentElement.clientHeight * 0.80,\n        minSize: 14\n      });\n      this.LOG.debug(['flexFont'], 'ok', (this.el.nativeElement as HTMLElement).parentElement.clientHeight);\n      this.fitties.fit();\n      this.loading = false;\n    }\n  }\n\n  private displayDuration(start: any) {\n    this.timer = setInterval(() => {\n      const now = moment();\n      this.toDisplay = moment.duration(start.diff(now)).humanize(true);\n    }, 1000);\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {AfterViewInit, Component, ElementRef, HostListener, NgZone, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {Param} from '../../model/param';\nimport moment from 'moment';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {ColorLib} from '../../utils/color-lib';\nimport {DataModel} from '../../model/dataModel';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-drill-down',\n  templateUrl: './warp-view-drill-down.component.html',\n  styleUrls: ['./warp-view-drill-down.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewDrillDownComponent extends WarpViewComponent implements AfterViewInit {\n\n  heatMapData: any;\n  private parentWidth = -1;\n  private resizeTimer;\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewDrillDownComponent, this._debug);\n  }\n\n  ngAfterViewInit() {\n    this.drawChart();\n  }\n\n  update(options: Param, refresh: boolean): void {\n    this.drawChart();\n  }\n\n  @HostListener('window:resize')\n  onResize() {\n    if (this.el.nativeElement.parentElement.clientWidth !== this.parentWidth || this.parentWidth <= 0) {\n      this.parentWidth = this.el.nativeElement.parentElement.clientWidth;\n      clearTimeout(this.resizeTimer);\n      this.resizeTimer = setTimeout(() => {\n        if (this.el.nativeElement.parentElement.clientWidth > 0) {\n          this.LOG.debug(['onResize'], this.el.nativeElement.parentElement.clientWidth);\n          this.drawChart();\n        } else {\n          this.onResize();\n        }\n      }, 150);\n    }\n  }\n\n  private drawChart() {\n    this.loading = false;\n    this.chartDraw.emit();\n    if (!this.initChart(this.el)) {\n      return;\n    }\n  }\n\n  protected convert(data: DataModel): any[] {\n    const dataList = this._data.data as any[];\n    this.heatMapData = this.parseData(GTSLib.flatDeep(dataList));\n    return [];\n  }\n\n  private parseData(dataList: any[]) {\n    const details = [];\n    const values = [];\n    const dates = [];\n    const data = {};\n    const reducer = (accumulator, currentValue) => accumulator + parseInt(currentValue, 10);\n    this.LOG.debug(['parseData'], dataList);\n    dataList.forEach((gts, i) => {\n      const name = GTSLib.serializeGtsMetadata(gts);\n      gts.v.forEach(v => {\n        const refDate = moment.utc(v[0] / 1000).startOf('day').toISOString();\n        if (!data[refDate]) {\n          data[refDate] = [];\n        }\n        if (!values[refDate]) {\n          values[refDate] = [];\n        }\n        dates.push(v[0] / 1000);\n        values[refDate].push(v[v.length - 1]);\n        data[refDate].push({\n          name,\n          date: v[0] / 1000,\n          value: v[v.length - 1],\n          color: ColorLib.getColor(i, this._options.scheme),\n          id: i\n        });\n      });\n    });\n    Object.keys(data).forEach((d: string) => {\n      details.push({\n        date: moment.utc(d),\n        total: values[d].reduce(reducer),\n        details: data[d],\n        summary: []\n      });\n    });\n    return details;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Moment} from 'moment';\n\n/**\n *\n */\nexport class Datum {\n  date: Moment;\n  summary?: Summary[];\n  total?: number;\n  details?: Detail[];\n}\n\n/**\n *\n */\nexport class Summary {\n  color?: string;\n  id?: number;\n  name: string;\n  total: number;\n  date?: Moment;\n}\n\n/**\n *\n */\nexport class Detail {\n  color?: string;\n  date: number;\n  id: number;\n  name: string;\n  value: number;\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\nimport {AfterViewInit, Component, ElementRef, EventEmitter, HostListener, Input, Output, ViewChild, ViewEncapsulation} from '@angular/core';\nimport {Logger} from '../../../utils/logger';\nimport {Datum, Detail, Summary} from '../model/datum';\nimport {ChartLib} from '../../../utils/chart-lib';\nimport {easeLinear, max, range, scaleBand, scaleLinear, Selection, sum, timeDays} from 'd3';\nimport {event, select} from 'd3-selection';\nimport {ColorLib} from '../../../utils/color-lib';\nimport {GTSLib} from '../../../utils/gts.lib';\nimport moment, {Moment} from 'moment';\n\n@Component({\n  selector: 'calendar-heatmap',\n  templateUrl: './calendar-heatmap.component.html',\n  styleUrls: ['./calendar-heatmap.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class CalendarHeatmapComponent implements AfterViewInit {\n\n  @Input('debug') set debug(debug: boolean) {\n    this._debug = debug;\n    this.LOG.setDebug(debug);\n  }\n\n  get debug() {\n    return this._debug;\n  }\n\n  @Input('data') set data(data: Datum[]) {\n    this.LOG.debug(['data'], data);\n    if (data) {\n      this._data = data;\n      this.calculateDimensions();\n    }\n  }\n\n  get data(): Datum[] {\n    return this._data;\n  }\n\n  @Input('minColor') set minColor(minColor: string) {\n    this._minColor = minColor;\n    this.calculateDimensions();\n  }\n\n  get minColor() {\n    return this._minColor;\n  }\n\n  @Input('maxColor') set maxColor(maxColor: string) {\n    this._maxColor = maxColor;\n    this.calculateDimensions();\n  }\n\n  get maxColor() {\n    return this._maxColor;\n  }\n\n  private static DEF_MIN_COLOR = '#ffffff';\n  private static DEF_MAX_COLOR = '#333333';\n\n  constructor(private el: ElementRef) {\n    this.LOG = new Logger(CalendarHeatmapComponent, this.debug);\n  }\n\n\n  @ViewChild('chart', {static: true}) div: ElementRef;\n\n  @Input('width') width = ChartLib.DEFAULT_WIDTH;\n  @Input('height') height = ChartLib.DEFAULT_HEIGHT;\n  @Input('overview') overview = 'global';\n\n  @Output('handler') handler = new EventEmitter<any>();\n  @Output('change') change = new EventEmitter<any>();\n\n  private LOG: Logger;\n  // tslint:disable-next-line:variable-name\n  private _data: Datum[];\n  // tslint:disable-next-line:variable-name\n  private _debug = false;\n  // tslint:disable-next-line:variable-name\n  private _minColor: string = CalendarHeatmapComponent.DEF_MIN_COLOR;\n  // tslint:disable-next-line:variable-name\n  private _maxColor: string = CalendarHeatmapComponent.DEF_MAX_COLOR;\n// Defaults\n  private gutter = 5;\n  private gWidth = 1000;\n  private gHeight = 200;\n  private itemSize = 10;\n  private labelPadding = 40;\n  private transitionDuration = 250;\n  private inTransition = false;\n  // Tooltip defaults\n  private tooltipWidth = 450;\n  private tooltipPadding = 15;\n  // Overview defaults\n  private history = ['global'];\n  private selected: Datum = new Datum();\n  // D3 related variables\n  private svg: Selection<SVGElement, {}, null, undefined>;\n  private items: Selection<SVGElement, {}, null, undefined>;\n  private labels: Selection<SVGElement, {}, null, undefined>;\n  private buttons: Selection<SVGElement, {}, null, undefined>;\n  private tooltip: Selection<HTMLDivElement, {}, null, undefined>;\n  private parentWidth = -1;\n  private chart: HTMLElement;\n  private resizeTimer;\n\n  static getNumberOfWeeks(): number {\n    const dayIndex = Math.round((+moment.utc() - +moment.utc().subtract(1, 'year').startOf('week')) / 86400000);\n    return Math.trunc(dayIndex / 7) + 1;\n  }\n\n  @HostListener('window:resize')\n  onResize() {\n    if (this.el.nativeElement.parentElement.clientWidth !== this.parentWidth) {\n      this.calculateDimensions();\n    }\n  }\n\n  ngAfterViewInit() {\n    this.chart = this.div.nativeElement as HTMLElement;\n    // Initialize svg element\n    this.svg = select(this.chart).append('svg').attr('class', 'svg');\n    // Initialize main svg elements\n    this.items = this.svg.append('g');\n    this.labels = this.svg.append('g');\n    this.buttons = this.svg.append('g');\n    // Add tooltip to the same element as main svg\n    this.tooltip = select(this.chart)\n      .append('div')\n      .attr('class', 'heatmap-tooltip')\n      .style('opacity', 0);\n    // Calculate chart dimensions\n    this.calculateDimensions();\n    //  this.drawChart();\n  }\n\n  calculateDimensions() {\n    clearTimeout(this.resizeTimer);\n    this.resizeTimer = setTimeout(() => {\n      if (this.el.nativeElement.parentElement.clientWidth !== 0) {\n        this.gWidth = this.chart.clientWidth < 1000 ? 1000 : this.chart.clientWidth;\n        this.itemSize = ((this.gWidth - this.labelPadding) / CalendarHeatmapComponent.getNumberOfWeeks() - this.gutter);\n        this.gHeight = this.labelPadding + 7 * (this.itemSize + this.gutter);\n        this.svg.attr('width', this.gWidth).attr('height', this.gHeight);\n        this.LOG.debug(['calculateDimensions'], this._data);\n        if (!!this._data && !!this._data[0] && !!this._data[0].summary) {\n          this.drawChart();\n        }\n      } else {\n        this.calculateDimensions();\n      }\n    }, 250);\n  }\n\n\n  private groupBy(xs, key) {\n    return xs.reduce((rv, x) => {\n      (rv[x[key]] = rv[x[key]] || []).push(x);\n      return rv;\n    }, {});\n  }\n\n  updateDataSummary() {\n    // Get daily summary if that was not provided\n    if (!this._data[0].summary) {\n      this._data.map((d: Datum) => {\n        const summary = d.details.reduce((uniques: any, project: any) => {\n          if (!uniques[project.name]) {\n            uniques[project.name] = {value: project.value};\n          } else {\n            uniques[project.name].value += project.value;\n          }\n          return uniques;\n        }, {});\n        const unsortedSummary = Object.keys(summary).map((key) => {\n          return {\n            name: key,\n            total: summary[key].value\n          };\n        });\n        d.summary = unsortedSummary.sort((a, b) => {\n          return b.total - a.total;\n        });\n        return d;\n      });\n    }\n  }\n\n  drawChart() {\n    if (!this.svg || !this._data) {\n      return;\n    }\n    this.LOG.debug(['drawChart'], [this.overview, this.selected]);\n    switch (this.overview) {\n      case 'global':\n        this.drawGlobalOverview();\n        this.change.emit({\n          overview: this.overview,\n          start: moment(this._data[0].date),\n          end: moment(this._data[this._data.length - 1].date),\n        });\n        break;\n      case 'year':\n        this.drawYearOverview();\n        this.change.emit({\n          overview: this.overview,\n          start: moment(this.selected.date).startOf('year'),\n          end: moment(this.selected.date).endOf('year'),\n        });\n        break;\n      case 'month':\n        this.drawMonthOverview();\n        this.change.emit({\n          overview: this.overview,\n          start: moment(this.selected.date).startOf('month'),\n          end: moment(this.selected.date).endOf('month'),\n        });\n        break;\n      case 'week':\n        this.drawWeekOverview();\n        this.change.emit({\n          overview: this.overview,\n          start: moment(this.selected.date).startOf('week'),\n          end: moment(this.selected.date).endOf('week'),\n        });\n        break;\n      case 'day':\n        this.drawDayOverview();\n        this.change.emit({\n          overview: this.overview,\n          start: moment(this.selected.date).startOf('day'),\n          end: moment(this.selected.date).endOf('day'),\n        });\n        break;\n      default:\n        break;\n    }\n  }\n\n  drawGlobalOverview() {\n    // Add current overview to the history\n    if (this.history[this.history.length - 1] !== this.overview) {\n      this.history.push(this.overview);\n    }\n    // Define start and end of the dataset\n    const startPeriod: Moment = moment.utc(this._data[0].date.startOf('y'));\n    const endPeriod: Moment = moment.utc(this._data[this._data.length - 1].date.endOf('y'));\n    // Define array of years and total values\n    const yData: Datum[] = this._data.filter((d: Datum) => d.date.isBetween(startPeriod, endPeriod, null, '[]'));\n    yData.forEach((d: Datum) => {\n      const summary: Summary[] = [];\n      const group = this.groupBy(d.details, 'name');\n      Object.keys(group).forEach(k => {\n        summary.push({\n          name: k,\n          total: group[k].reduce((acc, o) => {\n            return acc + o.value;\n          }, 0),\n          color: group[k][0].color,\n          id: group[k][0].id,\n        });\n      });\n      d.summary = summary;\n    });\n    const duration = Math.ceil(moment.duration(endPeriod.diff(startPeriod)).asYears());\n    const scale = [];\n    for (let i = 0; i < duration; i++) {\n      const d = moment.utc().year(startPeriod.year() + i).month(0).date(1).startOf('y');\n      scale.push(d);\n    }\n    let yearData: Datum[] = yData.map((d: Datum) => {\n      const date: Moment = d.date;\n      return {\n        date,\n        total: yData.reduce((prev: number, current: any) => {\n          if ((current.date as Moment).year() === date.year()) {\n            prev += current.total;\n          }\n          return prev;\n        }, 0),\n        summary: (() => {\n          const summary: Summary = yData.reduce((s: any, data: any) => {\n            if ((data.date as Moment).year() === date.year()) {\n              data.summary.forEach(_summary => {\n                if (!s[_summary.name]) {\n                  s[_summary.name] = {\n                    total: _summary.total,\n                    color: _summary.color,\n                  };\n                } else {\n                  s[_summary.name].total += _summary.total;\n                }\n              });\n            }\n            return s;\n          }, {});\n          const unsortedSummary: Summary[] = Object.keys(summary).map((key) => {\n            return {\n              name: key,\n              total: summary[key].total,\n              color: summary[key].color,\n            };\n          });\n          return unsortedSummary.sort((a, b) => b.total - a.total);\n        })(),\n      };\n    });\n    // Calculate max value of all the years in the dataset\n    yearData = GTSLib.cleanArray(yearData);\n    const maxValue = max(yearData, (d: Datum) => d.total);\n    // Define year labels and axis\n    const yearLabels = scale.map((d: Moment) => d);\n    const yearScale = scaleBand()\n      .rangeRound([0, this.gWidth])\n      .padding(0.05)\n      .domain(yearLabels.map((d: Moment) => d.year().toString()));\n\n    const color = scaleLinear<string>()\n      .range([this.minColor || CalendarHeatmapComponent.DEF_MIN_COLOR, this.maxColor || CalendarHeatmapComponent.DEF_MAX_COLOR])\n      .domain([-0.15 * maxValue, maxValue]);\n    // Add global data items to the overview\n    this.items.selectAll('.item-block-year').remove();\n    this.items.selectAll('.item-block-year')\n      .data(yearData)\n      .enter()\n      .append('rect')\n      .attr('class', 'item item-block-year')\n      .attr('width', () => (this.gWidth - this.labelPadding) / yearLabels.length - this.gutter * 5)\n      .attr('height', () => this.gHeight - this.labelPadding)\n      .attr('transform', (d: Datum) => 'translate(' + yearScale((d.date as Moment).year().toString()) + ',' + this.tooltipPadding * 2 + ')')\n      .attr('fill', (d: Datum) => color(d.total) || CalendarHeatmapComponent.DEF_MAX_COLOR)\n      .on('click', (d: Datum) => {\n        if (this.inTransition) {\n          return;\n        }\n        // Set in_transition flag\n        this.inTransition = true;\n        // Set selected date to the one clicked on\n        this.selected = d;\n        // Hide tooltip\n        this.hideTooltip();\n        // Remove all global overview related items and labels\n        this.removeGlobalOverview();\n        // Redraw the chart\n        this.overview = 'year';\n        this.drawChart();\n      })\n      .style('opacity', 0)\n      .on('mouseover', (d: Datum) => {\n        if (this.inTransition) {\n          return;\n        }\n        // Calculate tooltip position\n        let x = yearScale(d.date.year().toString()) + this.tooltipPadding * 2;\n        while (this.gWidth - x < (this.tooltipWidth + this.tooltipPadding * 5)) {\n          x -= 10;\n        }\n        const y = this.tooltipPadding * 4;\n        // Show tooltip\n        this.tooltip.html(this.getTooltip(d))\n          .style('left', x + 'px')\n          .style('top', y + 'px')\n          .transition()\n          .duration(this.transitionDuration / 2)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.hideTooltip();\n      })\n      .transition()\n      .delay((d: any, i: number) => this.transitionDuration * (i + 1) / 10)\n      .duration(() => this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 1)\n      .call((transition: any, callback: any) => {\n        if (transition.empty()) {\n          callback();\n        }\n        let n = 0;\n        transition.each(() => ++n).on('end', function() {\n          if (!--n) {\n            callback.apply(this, arguments);\n          }\n        });\n      }, () => this.inTransition = false);\n    // Add year labels\n    this.labels.selectAll('.label-year').remove();\n    this.labels.selectAll('.label-year')\n      .data(yearLabels)\n      .enter()\n      .append('text')\n      .attr('class', 'label label-year')\n      .attr('font-size', () => Math.floor(this.labelPadding / 3) + 'px')\n      .text((d: Moment) => d.year())\n      .attr('x', (d: Moment) => yearScale(d.year().toString()))\n      .attr('y', this.labelPadding / 2)\n      .on('mouseenter', (yearLabel: Moment) => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block-year')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', (d: Datum) => (d.date.year() === yearLabel.year()) ? 1 : 0.1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block-year')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      })\n      .on('click', () => {\n        if (this.inTransition) {\n          return;\n        }\n        // Set in_transition flag\n        this.inTransition = true;\n        // Set selected year to the one clicked on\n        this.selected = yearData[0];\n        // Hide tooltip\n        this.hideTooltip();\n        // Remove all global overview related items and labels\n        this.removeGlobalOverview();\n        // Redraw the chart\n        this.overview = 'year';\n        this.drawChart();\n      });\n  }\n\n\n  /**\n   * Draw year overview\n   */\n  drawYearOverview() {\n    // Add current overview to the history\n    if (this.history[this.history.length - 1] !== this.overview) {\n      this.history.push(this.overview);\n    }\n    // Define start and end date of the selected year\n    const startOfYear: Moment = moment(this.selected.date).startOf('year');\n    const endOfYear: Moment = moment(this.selected.date).endOf('year');\n    // Filter data down to the selected year\n    let yearData: Datum[] = this._data.filter((d: Datum) => d.date.isBetween(startOfYear, endOfYear, null, '[]'));\n    yearData.forEach((d: Datum) => {\n      const summary: Summary[] = [];\n      const group = this.groupBy(d.details, 'name');\n      Object.keys(group).forEach(k => {\n        summary.push({\n          name: k,\n          total: group[k].reduce((acc, o) => {\n            return acc + o.value;\n          }, 0),\n          color: group[k][0].color,\n          id: group[k][0].id,\n        });\n      });\n      d.summary = summary;\n    });\n    yearData = GTSLib.cleanArray(yearData);\n    // Calculate max value of the year data\n    const maxValue = max(yearData, (d: Datum) => d.total);\n    const color = scaleLinear<string>()\n      .range([this.minColor || CalendarHeatmapComponent.DEF_MIN_COLOR, this.maxColor || CalendarHeatmapComponent.DEF_MAX_COLOR])\n      .domain([-0.15 * maxValue, maxValue]);\n    this.items.selectAll('.item-circle').remove();\n    this.items.selectAll('.item-circle')\n      .data(yearData)\n      .enter()\n      .append('rect')\n      .attr('class', 'item item-circle').style('opacity', 0)\n      .attr('x', (d: Datum) => this.calcItemX(d, startOfYear) + (this.itemSize - this.calcItemSize(d, maxValue)) / 2)\n      .attr('y', (d: Datum) => this.calcItemY(d) + (this.itemSize - this.calcItemSize(d, maxValue)) / 2)\n      .attr('rx', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('ry', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('width', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('height', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('fill', (d: Datum) => (d.total > 0) ? color(d.total) : 'transparent')\n      .on('click', (d: Datum) => {\n        if (this.inTransition) {\n          return;\n        }\n        // Don't transition if there is no data to show\n        if (d.total === 0) {\n          return;\n        }\n        this.inTransition = true;\n        // Set selected date to the one clicked on\n        this.selected = d;\n        // Hide tooltip\n        this.hideTooltip();\n        // Remove all year overview related items and labels\n        this.removeYearOverview();\n        // Redraw the chart\n        this.overview = 'day';\n        this.drawChart();\n      })\n      .on('mouseover', (d: Datum) => {\n        if (this.inTransition) {\n          return;\n        }\n        // Pulsating animation\n        const circle = select(event.currentTarget);\n        const repeat = () => {\n          circle.transition()\n            .duration(this.transitionDuration)\n            .ease(easeLinear)\n            .attr('x', (data: Datum) => this.calcItemX(data, startOfYear) - (this.itemSize * 1.1 - this.itemSize) / 2)\n            .attr('y', (data: Datum) => this.calcItemY(data) - (this.itemSize * 1.1 - this.itemSize) / 2)\n            .attr('width', this.itemSize * 1.1)\n            .attr('height', this.itemSize * 1.1)\n            .transition()\n            .duration(this.transitionDuration)\n            .ease(easeLinear)\n            .attr('x', (data: Datum) => this.calcItemX(data, startOfYear) + (this.itemSize - this.calcItemSize(data, maxValue)) / 2)\n            .attr('y', (data: Datum) => this.calcItemY(data) + (this.itemSize - this.calcItemSize(data, maxValue)) / 2)\n            .attr('width', (data: Datum) => this.calcItemSize(data, maxValue))\n            .attr('height', (data: Datum) => this.calcItemSize(data, maxValue))\n            .on('end', repeat);\n        };\n        repeat();\n        // Construct tooltip\n        // Calculate tooltip position\n        let x = this.calcItemX(d, startOfYear) + this.itemSize / 2;\n        if (this.gWidth - x < (this.tooltipWidth + this.tooltipPadding * 3)) {\n          x -= this.tooltipWidth + this.tooltipPadding * 2;\n        }\n        const y = this.calcItemY(d) + this.itemSize / 2;\n        // Show tooltip\n        this.tooltip.html(this.getTooltip(d))\n          .style('left', x + 'px')\n          .style('top', y + 'px')\n          .transition()\n          .duration(this.transitionDuration / 2)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        // Set circle radius back to what it's supposed to be\n        select(event.currentTarget).transition()\n          .duration(this.transitionDuration / 2)\n          .ease(easeLinear)\n          .attr('x', (d: Datum) => this.calcItemX(d, startOfYear) + (this.itemSize - this.calcItemSize(d, maxValue)) / 2)\n          .attr('y', (d: Datum) => this.calcItemY(d) + (this.itemSize - this.calcItemSize(d, maxValue)) / 2)\n          .attr('width', (d: Datum) => this.calcItemSize(d, maxValue))\n          .attr('height', (d: Datum) => this.calcItemSize(d, maxValue));\n        // Hide tooltip\n        this.hideTooltip();\n      })\n      .transition()\n      .delay(() => (Math.cos(Math.PI * Math.random()) + 1) * this.transitionDuration)\n      .duration(() => this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 1)\n      .call((transition: any, callback: any) => {\n        if (transition.empty()) {\n          callback();\n        }\n        let n = 0;\n        transition.each(() => ++n).on('end', function() {\n          if (!--n) {\n            callback.apply(this, arguments);\n          }\n        });\n      }, () => this.inTransition = false);\n    // Add month labels\n    const duration = Math.ceil(moment.duration(endOfYear.diff(startOfYear)).asMonths());\n    const monthLabels: Moment[] = [];\n    for (let i = 1; i < duration; i++) {\n      monthLabels.push(moment(this.selected.date).month((startOfYear.month() + i) % 12).startOf('month'));\n    }\n    const monthScale = scaleLinear().range([0, this.gWidth]).domain([0, monthLabels.length]);\n    this.labels.selectAll('.label-month').remove();\n    this.labels.selectAll('.label-month')\n      .data(monthLabels)\n      .enter()\n      .append('text')\n      .attr('class', 'label label-month')\n      .attr('font-size', () => Math.floor(this.labelPadding / 3) + 'px')\n      .text((d: Moment) => d.format('MMM'))\n      .attr('x', (d: Moment, i: number) => monthScale(i) + (monthScale(i) - monthScale(i - 1)) / 2)\n      .attr('y', this.labelPadding / 2)\n      .on('mouseenter', (d: Moment) => {\n        if (this.inTransition) {\n          return;\n        }\n        const selectedMonth = moment(d);\n        this.items.selectAll('.item-circle')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', (data: Datum) => moment(data.date).isSame(selectedMonth, 'month') ? 1 : 0.1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-circle')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      })\n      .on('click', (d: Moment) => {\n        if (this.inTransition) {\n          return;\n        }\n        // Check month data\n        const monthData = this._data.filter((e: Datum) => e.date.isBetween(\n          moment(d).startOf('month'),\n          moment(d).endOf('month'),\n          null, '[]'\n        ));\n        // Don't transition if there is no data to show\n        if (!monthData.length) {\n          return;\n        }\n        // Set selected month to the one clicked on\n        this.selected = {date: d};\n        this.inTransition = true;\n        // Hide tooltip\n        this.hideTooltip();\n        // Remove all year overview related items and labels\n        this.removeYearOverview();\n        // Redraw the chart\n        this.overview = 'month';\n        this.drawChart();\n      });\n\n    // Add day labels\n    const dayLabels: Date[] = timeDays(\n      moment.utc().startOf('week').toDate(),\n      moment.utc().endOf('week').toDate()\n    );\n    const dayScale = scaleBand()\n      .rangeRound([this.labelPadding, this.gHeight])\n      .domain(dayLabels.map((d: Date) => moment.utc(d).weekday().toString()));\n    this.labels.selectAll('.label-day').remove();\n    this.labels.selectAll('.label-day')\n      .data(dayLabels)\n      .enter()\n      .append('text')\n      .attr('class', 'label label-day')\n      .attr('x', this.labelPadding / 3)\n      .attr('y', (d: Date, i: number) => dayScale(i.toString()) + dayScale.bandwidth() / 1.75)\n      .style('text-anchor', 'left')\n      .attr('font-size', () => Math.floor(this.labelPadding / 3) + 'px')\n      .text((d: Date) => moment.utc(d).format('dddd')[0])\n      .on('mouseenter', (d: Date) => {\n        if (this.inTransition) {\n          return;\n        }\n        const selectedDay = moment.utc(d);\n        this.items.selectAll('.item-circle')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', (data: Datum) => (moment(data.date).day() === selectedDay.day()) ? 1 : 0.1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-circle')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      });\n    // Add button to switch back to previous overview\n    this.drawButton();\n  }\n\n  drawMonthOverview() {\n    // Add current overview to the history\n    if (this.history[this.history.length - 1] !== this.overview) {\n      this.history.push(this.overview);\n    }\n    // Define beginning and end of the month\n    const startOfMonth: Moment = moment(this.selected.date).startOf('month');\n    const endOfMonth: Moment = moment(this.selected.date).endOf('month');\n    // Filter data down to the selected month\n    let monthData: Datum[] = [];\n    this._data.filter((data: Datum) => data.date.isBetween(startOfMonth, endOfMonth, null, '[]'))\n      .map((d: Datum) => {\n        const scale: Datum[] = [];\n        d.details.forEach((det: Detail) => {\n          const date: Moment = moment.utc(det.date);\n          const i = Math.floor(date.hours() / 3);\n          if (!scale[i]) {\n            scale[i] = {\n              date: date.startOf('hour'),\n              total: 0,\n              details: [],\n              summary: []\n            };\n          }\n          scale[i].total += det.value;\n          scale[i].details.push(det);\n        });\n        scale.forEach((s: Datum) => {\n          const group = this.groupBy(s.details, 'name');\n          Object.keys(group).forEach((k: string) => {\n            s.summary.push({\n              name: k,\n              total: sum(group[k], (data: any) => data.total),\n              color: group[k][0].color\n            });\n          });\n        });\n        monthData = monthData.concat(scale);\n      });\n    monthData = GTSLib.cleanArray(monthData);\n    this.LOG.debug(['drawMonthOverview'], [this.overview, this.selected, monthData]);\n    const maxValue: number = max(monthData, (d: any) => d.total);\n    // Define day labels and axis\n    const dayLabels: Date[] = timeDays(\n      moment(this.selected.date).startOf('week').toDate(),\n      moment(this.selected.date).endOf('week').toDate()\n    );\n    const dayScale = scaleBand()\n      .rangeRound([this.labelPadding, this.gHeight])\n      .domain(dayLabels.map((d: Date) => moment.utc(d).weekday().toString()));\n\n    // Define week labels and axis\n    const weekLabels: Moment[] = [startOfMonth];\n    const incWeek = moment(startOfMonth);\n    while (incWeek.week() !== endOfMonth.week()) {\n      weekLabels.push(moment(incWeek.add(1, 'week')));\n    }\n    monthData.forEach((d: Datum) => {\n      const summary = [];\n      const group = this.groupBy(d.details, 'name');\n      Object.keys(group).forEach((k: string) => {\n        summary.push({\n          name: k,\n          total: group[k].reduce((acc, o) => acc + o.value, 0),\n          color: group[k][0].color,\n          id: group[k][0].id,\n        });\n      });\n      d.summary = summary;\n    });\n    const weekScale = scaleBand()\n      .rangeRound([this.labelPadding, this.gWidth])\n      .padding(0.05)\n      .domain(weekLabels.map((weekday) => weekday.week() + ''));\n    const color = scaleLinear<string>()\n      .range([this.minColor || CalendarHeatmapComponent.DEF_MIN_COLOR, this.maxColor || CalendarHeatmapComponent.DEF_MAX_COLOR])\n      .domain([-0.15 * maxValue, maxValue]);\n    // Add month data items to the overview\n    this.items.selectAll('.item-block-month').remove();\n    this.items.selectAll('.item-block-month')\n      .data(monthData)\n      .enter().append('rect')\n      .style('opacity', 0)\n      .attr('class', 'item item-block-month')\n      .attr('y', (d: Datum) => this.calcItemY(d)\n        + (this.itemSize - this.calcItemSize(d, maxValue)) / 2)\n      .attr('x', (d: Datum) => this.calcItemXMonth(d, startOfMonth, weekScale(d.date.week().toString()))\n        + (this.itemSize - this.calcItemSize(d, maxValue)) / 2)\n      .attr('rx', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('ry', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('width', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('height', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('fill', (d: Datum) => (d.total > 0) ? color(d.total) : 'transparent')\n      .on('click', (d: Datum) => {\n        if (this.inTransition) {\n          return;\n        }\n        // Don't transition if there is no data to show\n        if (d.total === 0) {\n          return;\n        }\n        this.inTransition = true;\n        // Set selected date to the one clicked on\n        this.selected = d;\n        // Hide tooltip\n        this.hideTooltip();\n        // Remove all month overview related items and labels\n        this.removeMonthOverview();\n        // Redraw the chart\n        this.overview = 'day';\n        this.drawChart();\n      })\n      .on('mouseover', (d: Datum) => {\n        if (this.inTransition) {\n          return;\n        }\n        // Construct tooltip\n        // Calculate tooltip position\n        let x = weekScale(d.date.week().toString()) + this.tooltipPadding;\n        while (this.gWidth - x < (this.tooltipWidth + this.tooltipPadding * 3)) {\n          x -= 10;\n        }\n        const y = dayScale(d.date.weekday().toString()) + this.tooltipPadding;\n        // Show tooltip\n        this.tooltip.html(this.getTooltip(d))\n          .style('left', x + 'px')\n          .style('top', y + 'px')\n          .transition()\n          .duration(this.transitionDuration / 2)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.hideTooltip();\n      })\n      .transition()\n      .delay(() => (Math.cos(Math.PI * Math.random()) + 1) * this.transitionDuration)\n      .duration(() => this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 1)\n      .call((transition: any, callback: any) => {\n        if (transition.empty()) {\n          callback();\n        }\n        let n = 0;\n        transition.each(() => ++n).on('end', function() {\n          if (!--n) {\n            callback.apply(this, arguments);\n          }\n        });\n      }, () => this.inTransition = false);\n    // Add week labels\n    this.labels.selectAll('.label-week').remove();\n    this.labels.selectAll('.label-week')\n      .data(weekLabels)\n      .enter()\n      .append('text')\n      .attr('class', 'label label-week')\n      .attr('font-size', () => Math.floor(this.labelPadding / 3) + 'px')\n      .text((d: Moment) => 'Week ' + d.week())\n      .attr('x', (d: Moment) => weekScale(d.week().toString()))\n      .attr('y', this.labelPadding / 2)\n      .on('mouseenter', (weekday: Moment) => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block-month')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', (d: Datum) => {\n            return (moment(d.date).week() === weekday.week()) ? 1 : 0.1;\n          });\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block-month')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      })\n      .on('click', (d: Moment) => {\n        if (this.inTransition) {\n          return;\n        }\n        this.inTransition = true;\n        // Set selected month to the one clicked on\n        this.selected = {date: d};\n        // Hide tooltip\n        this.hideTooltip();\n        // Remove all year overview related items and labels\n        this.removeMonthOverview();\n        // Redraw the chart\n        this.overview = 'week';\n        this.drawChart();\n      });\n    // Add day labels\n    this.labels.selectAll('.label-day').remove();\n    this.labels.selectAll('.label-day')\n      .data(dayLabels)\n      .enter()\n      .append('text')\n      .attr('class', 'label label-day')\n      .attr('x', this.labelPadding / 3)\n      .attr('y', (d: Date, i: any) => dayScale(i) + dayScale.bandwidth() / 1.75)\n      .style('text-anchor', 'left')\n      .attr('font-size', () => Math.floor(this.labelPadding / 3) + 'px')\n      .text((d: Date) => moment.utc(d).format('dddd')[0])\n      .on('mouseenter', (d: Date) => {\n        if (this.inTransition) {\n          return;\n        }\n        const selectedDay = moment.utc(d);\n        this.items.selectAll('.item-block-month')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', (data: Datum) => (moment(data.date).day() === selectedDay.day()) ? 1 : 0.1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block-month')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      });\n    // Add button to switch back to previous overview\n    this.drawButton();\n  }\n\n  drawWeekOverview() {\n    // Add current overview to the history\n    if (this.history[this.history.length - 1] !== this.overview) {\n      this.history.push(this.overview);\n    }\n    // Define beginning and end of the week\n    const startOfWeek: Moment = moment(this.selected.date).startOf('week');\n    const endOfWeek: Moment = moment(this.selected.date).endOf('week');\n    // Filter data down to the selected week\n    let weekData: Datum[] = [];\n    this._data.filter((d: Datum) => {\n      return d.date.isBetween(startOfWeek, endOfWeek, null, '[]');\n    }).map((d: Datum) => {\n      const scale: Datum[] = [];\n      d.details.forEach((det: Detail) => {\n        const date: Moment = moment(det.date);\n        const i = date.hours();\n        if (!scale[i]) {\n          scale[i] = {\n            date: date.startOf('hour'),\n            total: 0,\n            details: [],\n            summary: []\n          };\n        }\n        scale[i].total += det.value;\n        scale[i].details.push(det);\n      });\n      scale.forEach(s => {\n        const group = this.groupBy(s.details, 'name');\n        Object.keys(group).forEach(k =>\n          s.summary.push({\n            name: k,\n            total: sum(group[k], (data: any) => data.value),\n            color: group[k][0].color\n          }));\n      });\n      weekData = weekData.concat(scale);\n    });\n    weekData = GTSLib.cleanArray(weekData);\n    const maxValue: number = max(weekData, (d: Datum) => d.total);\n    // Define day labels and axis\n    const dayLabels = timeDays(moment.utc().startOf('week').toDate(), moment.utc().endOf('week').toDate());\n    const dayScale = scaleBand()\n      .rangeRound([this.labelPadding, this.gHeight])\n      .domain(dayLabels.map((d: Date) => moment.utc(d).weekday().toString()));\n    // Define hours labels and axis\n    const hoursLabels: string[] = [];\n    range(0, 24).forEach(h => hoursLabels.push(moment.utc().hours(h).startOf('hour').format('HH:mm')));\n    const hourScale = scaleBand().rangeRound([this.labelPadding, this.gWidth]).padding(0.01).domain(hoursLabels);\n    const color = scaleLinear<string>()\n      .range([this.minColor || CalendarHeatmapComponent.DEF_MIN_COLOR, this.maxColor || CalendarHeatmapComponent.DEF_MAX_COLOR])\n      .domain([-0.15 * maxValue, maxValue]);\n    // Add week data items to the overview\n    this.items.selectAll('.item-block-week').remove();\n    this.items.selectAll('.item-block-week')\n      .data(weekData)\n      .enter()\n      .append('rect')\n      .style('opacity', 0)\n      .attr('class', 'item item-block-week')\n      .attr('y', (d: Datum) => this.calcItemY(d)\n        + (this.itemSize - this.calcItemSize(d, maxValue)) / 2)\n      .attr('x', (d: Datum) => this.gutter\n        + hourScale(moment(d.date).startOf('hour').format('HH:mm'))\n        + (this.itemSize - this.calcItemSize(d, maxValue)) / 2)\n      .attr('rx', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('ry', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('width', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('height', (d: Datum) => this.calcItemSize(d, maxValue))\n      .attr('fill', (d: Datum) => (d.total > 0) ? color(d.total) : 'transparent')\n      .on('click', (d: Datum) => {\n        if (this.inTransition) {\n          return;\n        }\n        // Don't transition if there is no data to show\n        if (d.total === 0) {\n          return;\n        }\n        this.inTransition = true;\n        // Set selected date to the one clicked on\n        this.selected = d;\n        // Hide tooltip\n        this.hideTooltip();\n        // Remove all week overview related items and labels\n        this.removeWeekOverview();\n        // Redraw the chart\n        this.overview = 'day';\n        this.drawChart();\n      }).on('mouseover', (d: Datum) => {\n      if (this.inTransition) {\n        return;\n      }\n      // Calculate tooltip position\n      let x = hourScale(moment(d.date).startOf('hour').format('HH:mm')) + this.tooltipPadding;\n      while (this.gWidth - x < (this.tooltipWidth + this.tooltipPadding * 3)) {\n        x -= 10;\n      }\n      const y = dayScale(d.date.weekday().toString()) + this.tooltipPadding;\n      // Show tooltip\n      this.tooltip.html(this.getTooltip(d))\n        .style('left', x + 'px')\n        .style('top', y + 'px')\n        .transition()\n        .duration(this.transitionDuration / 2)\n        .ease(easeLinear)\n        .style('opacity', 1);\n    })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.hideTooltip();\n      })\n      .transition()\n      .delay(() => (Math.cos(Math.PI * Math.random()) + 1) * this.transitionDuration)\n      .duration(() => this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 1)\n      .call((transition: any, callback: any) => {\n        if (transition.empty()) {\n          callback();\n        }\n        let n = 0;\n        transition.each(() => ++n).on('end', function() {\n          if (!--n) {\n            callback.apply(this, arguments);\n          }\n        });\n      }, () => this.inTransition = false);\n\n    // Add week labels\n    this.labels.selectAll('.label-week').remove();\n    this.labels.selectAll('.label-week')\n      .data(hoursLabels)\n      .enter()\n      .append('text')\n      .attr('class', 'label label-week')\n      .attr('font-size', () => Math.floor(this.labelPadding / 3) + 'px')\n      .text((d: string) => d)\n      .attr('x', (d: string) => hourScale(d))\n      .attr('y', this.labelPadding / 2)\n      .on('mouseenter', (hour: string) => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block-week')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', (d: Datum) => (moment(d.date).startOf('hour').format('HH:mm') === hour) ? 1 : 0.1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block-week')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      });\n    // Add day labels\n    this.labels.selectAll('.label-day').remove();\n    this.labels.selectAll('.label-day')\n      .data(dayLabels)\n      .enter()\n      .append('text')\n      .attr('class', 'label label-day')\n      .attr('x', this.labelPadding / 3)\n      .attr('y', (d: Date, i: number) => dayScale(i.toString()) + dayScale.bandwidth() / 1.75)\n      .style('text-anchor', 'left')\n      .attr('font-size', () => Math.floor(this.labelPadding / 3) + 'px')\n      .text((d: Date) => moment.utc(d).format('dddd')[0])\n      .on('mouseenter', (d: Date) => {\n        if (this.inTransition) {\n          return;\n        }\n        const selectedDay = moment.utc(d);\n        this.items.selectAll('.item-block-week')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', (data: Datum) => (moment(data.date).day() === selectedDay.day()) ? 1 : 0.1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block-week')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      });\n\n    // Add button to switch back to previous overview\n    this.drawButton();\n  }\n\n  drawDayOverview() {\n    // Add current overview to the history\n    if (this.history[this.history.length - 1] !== this.overview) {\n      this.history.push(this.overview);\n    }\n    // Initialize selected date to today if it was not set\n    if (!Object.keys(this.selected).length) {\n      this.selected = this._data[this._data.length - 1];\n    }\n    const startOfDay: Moment = moment(this.selected.date).startOf('day');\n    const endOfDay: Moment = moment(this.selected.date).endOf('day');\n    // Filter data down to the selected month\n    let dayData: Datum[] = [];\n    this._data.filter((d: Datum) => {\n      return d.date.isBetween(startOfDay, endOfDay, null, '[]');\n    }).map((d: Datum) => {\n      const scale = [];\n      d.details.forEach((det: Detail) => {\n        const date: Moment = moment(det.date);\n        const i = date.hours();\n        if (!scale[i]) {\n          scale[i] = {\n            date: date.startOf('hour'),\n            total: 0,\n            details: [],\n            summary: []\n          };\n        }\n        scale[i].total += det.value;\n        scale[i].details.push(det);\n      });\n      scale.forEach(s => {\n        const group = this.groupBy(s.details, 'name');\n        Object.keys(group).forEach(k => {\n          s.summary.push({\n            name: k,\n            total: sum(group[k], (item: any) => item.value),\n            color: group[k][0].color\n          });\n        });\n      });\n      dayData = dayData.concat(scale);\n    });\n    const data: Summary[] = [];\n    dayData.forEach((d: Datum) => {\n      const date = d.date;\n      d.summary.forEach((s: Summary) => {\n        s.date = date;\n        data.push(s);\n      });\n    });\n    dayData = GTSLib.cleanArray(dayData);\n    const maxValue: number = max(data, (d: Summary) => d.total);\n    const gtsNames = this.selected.summary.map((summary: Summary) => summary.name);\n    const gtsNameScale = scaleBand().rangeRound([this.labelPadding, this.gHeight]).domain(gtsNames);\n    const hourLabels: string[] = [];\n    range(0, 24).forEach(h => hourLabels.push(moment.utc().hours(h).startOf('hour').format('HH:mm')));\n    const dayScale = scaleBand()\n      .rangeRound([this.labelPadding, this.gWidth])\n      .padding(0.01)\n      .domain(hourLabels);\n    this.items.selectAll('.item-block').remove();\n    this.items.selectAll('.item-block')\n      .data(data)\n      .enter()\n      .append('rect')\n      .attr('class', 'item item-block')\n      .attr('x', (d: Summary) => this.gutter\n        + dayScale(moment(d.date).startOf('hour').format('HH:mm'))\n        + (this.itemSize - this.calcItemSize(d, maxValue)) / 2)\n      .attr('y', (d: Summary) => {\n        return (gtsNameScale(d.name) || 1) - (this.itemSize - this.calcItemSize(d, maxValue)) / 2;\n      })\n      .attr('rx', (d: Summary) => this.calcItemSize(d, maxValue))\n      .attr('ry', (d: Summary) => this.calcItemSize(d, maxValue))\n      .attr('width', (d: Summary) => this.calcItemSize(d, maxValue))\n      .attr('height', (d: Summary) => this.calcItemSize(d, maxValue))\n      .attr('fill', (d: Summary) => {\n        const color = scaleLinear<string>()\n          .range(['#ffffff', d.color || CalendarHeatmapComponent.DEF_MIN_COLOR])\n          .domain([-0.5 * maxValue, maxValue]);\n        return color(d.total);\n      })\n      .style('opacity', 0)\n      .on('mouseover', (d: Summary) => {\n        if (this.inTransition) {\n          return;\n        }\n        // Calculate tooltip position\n        let x = dayScale(moment(d.date).startOf('hour').format('HH:mm')) + this.tooltipPadding;\n        while (this.gWidth - x < (this.tooltipWidth + this.tooltipPadding * 3)) {\n          x -= 10;\n        }\n        const y = gtsNameScale(d.name) + this.tooltipPadding;\n        // Show tooltip\n        this.tooltip.html(this.getTooltip(d))\n          .style('left', x + 'px')\n          .style('top', y + 'px')\n          .transition()\n          .duration(this.transitionDuration / 2)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.hideTooltip();\n      })\n      .on('click', (d: Summary) => {\n        if (this.handler) {\n          this.handler.emit(d);\n        }\n      })\n      .transition()\n      .delay(() => (Math.cos(Math.PI * Math.random()) + 1) * this.transitionDuration)\n      .duration(() => this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 1)\n      .call((transition: any, callback: any) => {\n        if (transition.empty()) {\n          callback();\n        }\n        let n = 0;\n        transition.each(() => ++n).on('end', function() {\n          if (!--n) {\n            callback.apply(this, arguments);\n          }\n        });\n      }, () => this.inTransition = false);\n\n    // Add time labels\n    this.labels.selectAll('.label-time').remove();\n    this.labels.selectAll('.label-time')\n      .data(hourLabels)\n      .enter()\n      .append('text')\n      .attr('class', 'label label-time')\n      .attr('font-size', () => Math.floor(this.labelPadding / 3) + 'px')\n      .text((d: string) => d)\n      .attr('x', (d: string) => dayScale(d))\n      .attr('y', this.labelPadding / 2)\n      .on('mouseenter', (d: string) => {\n        if (this.inTransition) {\n          return;\n        }\n        const selected = d;\n        // const selected = itemScale(moment.utc(d));\n        this.items.selectAll('.item-block')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', (item: any) => (item.date.format('HH:mm') === selected) ? 1 : 0.1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      });\n    // Add project labels\n    const labelPadding = this.labelPadding;\n    this.labels.selectAll('.label-project').remove();\n    this.labels.selectAll('.label-project')\n      .data(gtsNames)\n      .enter()\n      .append('text')\n      .attr('class', 'label label-project')\n      .attr('x', this.gutter)\n      .attr('y', (d: string) => gtsNameScale(d) + this.itemSize / 2)\n      .attr('min-height', () => gtsNameScale.bandwidth())\n      .style('text-anchor', 'left')\n      .attr('font-size', () => Math.floor(this.labelPadding / 3) + 'px')\n      .text((d: string) => d)\n      .each(function() {\n        const obj = select(this);\n        let textLength = obj.node().getComputedTextLength();\n        let text = obj.text();\n        while (textLength > (labelPadding * 1.5) && text.length > 0) {\n          text = text.slice(0, -1);\n          obj.text(text + '...');\n          textLength = obj.node().getComputedTextLength();\n        }\n      })\n      .on('mouseenter', (gtsName: string) => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', (d: Summary) => (d.name === gtsName) ? 1 : 0.1);\n      })\n      .on('mouseout', () => {\n        if (this.inTransition) {\n          return;\n        }\n        this.items.selectAll('.item-block')\n          .transition()\n          .duration(this.transitionDuration)\n          .ease(easeLinear)\n          .style('opacity', 1);\n      });\n    // Add button to switch back to previous overview\n    this.drawButton();\n  }\n\n  private calcItemX(d: Datum, startOfYear: Moment) {\n    const dayIndex = Math.round((+moment(d.date) - +startOfYear.startOf('week')) / 86400000);\n    const colIndex = Math.trunc(dayIndex / 7);\n    return colIndex * (this.itemSize + this.gutter) + this.labelPadding;\n  }\n\n  private calcItemXMonth(d: Datum, start: Moment, offset: number) {\n    const hourIndex = moment(d.date).hours();\n    const colIndex = Math.trunc(hourIndex / 3);\n    return colIndex * (this.itemSize + this.gutter) + offset;\n  }\n\n  private calcItemY(d: Datum) {\n    return this.labelPadding + d.date.weekday() * (this.itemSize + this.gutter);\n  }\n\n  private calcItemSize(d: Datum | Summary, m: number) {\n    if (m <= 0) {\n      return this.itemSize;\n    }\n    return this.itemSize * 0.75 + (this.itemSize * d.total / m) * 0.25;\n  }\n\n  private drawButton() {\n    this.buttons.selectAll('.button').remove();\n    const button = this.buttons.append('g')\n      .attr('class', 'button button-back')\n      .style('opacity', 0)\n      .on('click', () => {\n        if (this.inTransition) {\n          return;\n        }\n        // Set transition boolean\n        this.inTransition = true;\n        // Clean the canvas from whichever overview type was on\n        if (this.overview === 'year') {\n          this.removeYearOverview();\n        } else if (this.overview === 'month') {\n          this.removeMonthOverview();\n        } else if (this.overview === 'week') {\n          this.removeWeekOverview();\n        } else if (this.overview === 'day') {\n          this.removeDayOverview();\n        }\n        // Redraw the chart\n        this.history.pop();\n        this.overview = this.history.pop();\n        this.drawChart();\n      });\n    button.append('circle')\n      .attr('cx', this.labelPadding / 2.25)\n      .attr('cy', this.labelPadding / 2.5)\n      .attr('r', this.itemSize / 2);\n    button.append('text')\n      .attr('x', this.labelPadding / 2.25)\n      .attr('y', this.labelPadding / 2.5)\n      .attr('dy', () => {\n        return Math.floor(this.gWidth / 100) / 3;\n      })\n      .attr('font-size', () => {\n        return Math.floor(this.labelPadding / 3) + 'px';\n      })\n      .html('&#x2190;');\n    button.transition()\n      .duration(this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 1);\n  }\n\n  private removeGlobalOverview() {\n    this.items.selectAll('.item-block-year')\n      .transition()\n      .duration(this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 0)\n      .remove();\n    this.labels.selectAll('.label-year').remove();\n  }\n\n  private removeYearOverview() {\n    this.items.selectAll('.item-circle')\n      .transition()\n      .duration(this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 0)\n      .remove();\n    this.labels.selectAll('.label-day').remove();\n    this.labels.selectAll('.label-month').remove();\n    this.hideBackButton();\n  }\n\n  private removeMonthOverview() {\n    this.items.selectAll('.item-block-month')\n      .transition()\n      .duration(this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 0)\n      .remove();\n    this.labels.selectAll('.label-day').remove();\n    this.labels.selectAll('.label-week').remove();\n    this.hideBackButton();\n  }\n\n  private removeWeekOverview() {\n    this.items.selectAll('.item-block-week')\n      .transition()\n      .duration(this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 0)\n      .attr('x', (d: any, i: number) => (i % 2 === 0) ? -this.gWidth / 3 : this.gWidth / 3)\n      .remove();\n    this.labels.selectAll('.label-day').remove();\n    this.labels.selectAll('.label-week').remove();\n    this.hideBackButton();\n  }\n\n  private removeDayOverview() {\n    this.items.selectAll('.item-block')\n      .transition()\n      .duration(this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 0)\n      .attr('x', (d: any, i: number) => (i % 2 === 0) ? -this.gWidth / 3 : this.gWidth / 3)\n      .remove();\n    this.labels.selectAll('.label-time').remove();\n    this.labels.selectAll('.label-project').remove();\n    this.hideBackButton();\n  }\n\n  private hideTooltip() {\n    this.tooltip.transition()\n      .duration(this.transitionDuration / 2)\n      .ease(easeLinear)\n      .style('opacity', 0);\n  }\n\n  /**\n   * Helper function to hide the back button\n   */\n  private hideBackButton() {\n    this.buttons.selectAll('.button')\n      .transition()\n      .duration(this.transitionDuration)\n      .ease(easeLinear)\n      .style('opacity', 0)\n      .remove();\n  }\n\n  private getTooltip = (d: any) => {\n    let tooltipHtml = '<div class=\"header\"><strong>' + d.date.format('dddd, MMM Do YYYY HH:mm') + '</strong></div><ul>';\n    (d.summary || []).forEach(s => {\n      tooltipHtml += `<li>\n  <div class=\"round\" style=\"background-color:${ColorLib.transparentize(s.color)}; border-color:${s.color}\"></div>\n${GTSLib.formatLabel(s.name)}: ${s.total}</li>`;\n    });\n    if (d.total !== undefined && d.name) {\n      tooltipHtml += `<li><div class=\"round\"\nstyle=\"background-color: ${ColorLib.transparentize(d.color)}; border-color: ${d.color}\"\n></div> ${GTSLib.formatLabel(d.name)}: ${d.total}</li>`;\n    }\n    tooltipHtml += '</ul>';\n    return tooltipHtml;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {AfterViewInit, Component, EventEmitter, Input, Output, ViewChild, ViewEncapsulation} from '@angular/core';\nimport {DataModel} from '../../model/dataModel';\nimport {Logger} from '../../utils/logger';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {WarpViewModalComponent} from '../warp-view-modal/warp-view-modal.component';\nimport {Param} from '../../model/param';\nimport deepEqual from 'deep-equal';\nimport {ChartLib} from '../../utils/chart-lib';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-gts-popup',\n  templateUrl: './warp-view-gts-popup.component.html',\n  styleUrls: ['./warp-view-gts-popup.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewGtsPopupComponent implements AfterViewInit {\n  @ViewChild('modal', {static: true}) modal: WarpViewModalComponent;\n\n  @Input('options') set options(options: Param | string) {\n    this.LOG.debug(['onOptions'], options);\n    if (typeof options === 'string') {\n      options = JSON.parse(options);\n    }\n    if (!deepEqual(options, this._options)) {\n      this.LOG.debug(['options', 'changed'], options);\n      this._options = ChartLib.mergeDeep(this._options, options as Param) as Param;\n      this.prepareData();\n    }\n  }\n\n  @Input('gtsList') set gtsList(gtsList: DataModel) {\n    this._gtsList = gtsList;\n    this.LOG.debug(['_gtsList'], this._gtsList);\n\n    this.prepareData();\n  }\n\n  get gtslist(): DataModel {\n    return this._gtsList;\n  }\n\n  @Input('debug') set debug(debug: boolean) {\n    this._debug = debug;\n    this.LOG.setDebug(debug);\n  }\n\n  get debug() {\n    return this._debug;\n  }\n\n  @Input('data') set data(data: DataModel) {\n    this.LOG.debug(['data'], data);\n    if (data) {\n      this._data = data;\n    }\n  }\n\n  get data(): DataModel {\n    return this._data;\n  }\n\n\n  @Input('hiddenData') set hiddenData(hiddenData: number[]) {\n    this._hiddenData = hiddenData;\n    this.prepareData();\n  }\n\n  get hiddenData(): number[] {\n    return this._hiddenData;\n  }\n\n  @Input('maxToShow') maxToShow = 5;\n\n  @Input('kbdLastKeyPressed') set kbdLastKeyPressed(kbdLastKeyPressed: string[]) {\n    this._kbdLastKeyPressed = kbdLastKeyPressed;\n    if (kbdLastKeyPressed[0] === 's' && !this.modalOpenned) {\n      this.showPopup();\n    } else if (this.modalOpenned) {\n      switch (kbdLastKeyPressed[0]) {\n        case'ArrowUp':\n        case'j':\n          this.current = Math.max(0, this.current - 1);\n          this.prepareData();\n          break;\n        case 'ArrowDown':\n        case 'k':\n          this.current = Math.min(this._gts.length - 1, this.current + 1);\n          this.prepareData();\n          break;\n        case ' ':\n          this.warpViewSelectedGTS.emit({\n            gts: this._gts[this.current],\n            selected: this.hiddenData.indexOf(this._gts[this.current].id) > -1\n          });\n          break;\n        default:\n          return;\n      }\n    }\n  }\n\n  get kbdLastKeyPressed(): string[] {\n    return this._kbdLastKeyPressed;\n  }\n\n  @Output('warpViewSelectedGTS') warpViewSelectedGTS = new EventEmitter<any>();\n  @Output('warpViewModalOpen') warpViewModalOpen = new EventEmitter<any>();\n  @Output('warpViewModalClose') warpViewModalClose = new EventEmitter<any>();\n\n  current = 0;\n  // tslint:disable-next-line:variable-name\n  _gts: any[] = [];\n  _options: Param = new Param();\n\n  // tslint:disable-next-line:variable-name\n  private _kbdLastKeyPressed: string[] = [];\n  // tslint:disable-next-line:variable-name\n  private _hiddenData: number[] = [];\n  // tslint:disable-next-line:variable-name\n  private _debug = false;\n  // tslint:disable-next-line:variable-name\n  private _gtsList: DataModel;\n  // tslint:disable-next-line:variable-name\n  private _data: DataModel;\n  private displayed: any[] = [];\n  private modalOpenned = false;\n  private LOG: Logger;\n\n  constructor() {\n    this.LOG = new Logger(WarpViewGtsPopupComponent, this.debug);\n  }\n\n  ngAfterViewInit(): void {\n    this.prepareData();\n  }\n\n  onWarpViewModalOpen() {\n    this.modalOpenned = true;\n    this.warpViewModalOpen.emit({});\n  }\n\n  onWarpViewModalClose() {\n    this.modalOpenned = false;\n    this.warpViewModalClose.emit({});\n  }\n\n  public isOpened(): Promise<boolean> {\n    return this.modal.isOpened();\n  }\n\n  private showPopup() {\n    this.current = 0;\n    this.prepareData();\n    this.modal.open();\n  }\n\n  public close() {\n    this.modal.close();\n  }\n\n  private prepareData() {\n    if (this._gtsList && this._gtsList.data) {\n      this._gts = GTSLib.flatDeep([this._gtsList.data]);\n      this.displayed = this._gts.slice(\n        Math.max(0, Math.min(this.current - this.maxToShow, this._gts.length - 2 * this.maxToShow)),\n        Math.min(this._gts.length, this.current + this.maxToShow + Math.abs(Math.min(this.current - this.maxToShow, 0)))\n      ) as any[];\n      this.LOG.debug(['prepareData'], this.displayed);\n    }\n  }\n\n  isHidden(gts) {\n    return !this.displayed.find(g => !!gts ? gts.id === g.id : false);\n  }\n\n  identify(index, item) {\n    return index;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {AfterViewInit, Component, ElementRef, EventEmitter, HostListener, Input, Output, ViewEncapsulation} from '@angular/core';\n\n@Component({\n  selector: 'warpview-modal',\n  templateUrl: './warp-view-modal.component.html',\n  styleUrls: ['./warp-view-modal.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewModalComponent implements AfterViewInit {\n\n\n  @Input('modalTitle') modalTitle = '';\n  @Input('kbdLastKeyPressed') kbdLastKeyPressed: string[] = [];\n\n  @Output('warpViewModalOpen') warpViewModalOpen = new EventEmitter<any>();\n  @Output('warpViewModalClose') warpViewModalClose = new EventEmitter<any>();\n\n  private opened = false;\n\n  public open() {\n    this.el.nativeElement.style.display = 'block';\n    this.el.nativeElement.style.zIndex = '999999';\n    this.opened = true;\n    this.warpViewModalOpen.emit({});\n  }\n\n  public close() {\n    this.el.nativeElement.style.display = 'none';\n    this.el.nativeElement.style.zIndex = '-1';\n    this.opened = false;\n    this.warpViewModalClose.emit({});\n  }\n\n  public isOpened(): Promise<boolean> {\n    return new Promise<boolean>(resolve => {\n      resolve(this.opened);\n    });\n  }\n\n  @HostListener('kbdLastKeyPressed', ['$event'])\n  handleKeyDown($event: string[]) {\n    if ('Escape' === $event[0]) {\n      this.close();\n    }\n  }\n\n  constructor(public el: ElementRef) {\n  }\n\n  ngAfterViewInit(): void {\n    this.el.nativeElement.addEventListener('click', (event: any) => {\n      if (event.path[0].nodeName === 'WARP-VIEW-MODAL') {\n        this.close();\n      }\n    });\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {\n  AfterViewInit,\n  Component,\n  ElementRef,\n  EventEmitter,\n  Input,\n  NgZone,\n  Output,\n  Renderer2,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {Param} from '../../model/param';\nimport {ChartLib} from '../../utils/chart-lib';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {DataModel} from '../../model/dataModel';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {Subject} from 'rxjs';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-gts-tree',\n  templateUrl: './warp-view-gts-tree.component.html',\n  styleUrls: ['./warp-view-gts-tree.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewGtsTreeComponent extends WarpViewComponent implements AfterViewInit {\n  @ViewChild('root', {static: true}) root: ElementRef;\n\n  @Input('kbdLastKeyPressed') kbdLastKeyPressed: string[] = [];\n\n  @Input('gtsFilter') set gtsFilter(gtsFilter: string) {\n    this._gtsFilter = gtsFilter;\n  }\n\n  get gtsFilter() {\n    return this._gtsFilter;\n  }\n\n  @Output('warpViewSelectedGTS') warpViewSelectedGTS = new EventEmitter<any>();\n\n  private _gtsFilter = 'x';\n  gtsList: any[] = [];\n  params: Param[] = [] as Param[];\n  expand = false;\n\n  initOpen: Subject<void> = new Subject<void>();\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewGtsTreeComponent, this._debug);\n  }\n\n  ngAfterViewInit(): void {\n    this.LOG.debug(['componentDidLoad', 'data'], this._data);\n    if (!!this._options.foldGTSTree && !this.expand) {\n      this.foldAll();\n    }\n    if (!this._options.foldGTSTree) {\n      this.initOpen.next();\n    }\n    if (this._data) {\n      this.doRender();\n    }\n  }\n\n  update(options: Param, refresh: boolean): void {\n    if (!!this._options.foldGTSTree && !this.expand) {\n      this.foldAll();\n    }\n    this.doRender();\n  }\n\n  private doRender() {\n    this.LOG.debug(['doRender', 'gtsList'], this._data);\n    if (!this._data) {\n      return;\n    }\n    this._options = ChartLib.mergeDeep(this.defOptions, this._options) as Param;\n    const dataList = GTSLib.getData(this._data).data;\n    this.params = this._data.params || [];\n    this.LOG.debug(['doRender', 'gtsList', 'dataList'], dataList);\n    if (!dataList) {\n      return;\n    }\n    this.expand = !this._options.foldGTSTree;\n    this.gtsList = GTSLib.flattenGtsIdArray(dataList as any[], 0).res;\n    this.LOG.debug(['doRender', 'gtsList'], this.gtsList, this._options.foldGTSTree, this.expand);\n    this.loading = false;\n    this.chartDraw.emit();\n  }\n\n  private foldAll() {\n    if (!this.root) {\n      setTimeout(() => this.foldAll());\n    } else {\n      this.expand = false;\n    }\n  }\n\n  toggleVisibility() {\n    requestAnimationFrame(() => this.expand = !this.expand);\n  }\n\n  protected convert(data: DataModel): any[] {\n    return [];\n  }\n\n  warpViewSelectedGTSHandler(event) {\n    this.LOG.debug(['warpViewSelectedGTS'], event);\n    this.warpViewSelectedGTS.emit(event);\n  }\n\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, EventEmitter, Input, OnDestroy, OnInit, Output, ViewEncapsulation} from '@angular/core';\nimport {Logger} from '../../../utils/logger';\nimport {GTSLib} from '../../../utils/gts.lib';\nimport {Param} from '../../../model/param';\nimport {Observable, Subject, Subscription} from 'rxjs';\n\n@Component({\n  selector: 'warpview-tree-view',\n  templateUrl: './warp-view-tree-view.component.html',\n  styleUrls: ['./warp-view-tree-view.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewTreeViewComponent implements OnInit, OnDestroy {\n\n  @Input('debug') set debug(debug: boolean) {\n    this._debug = debug;\n    this.LOG.setDebug(debug);\n  }\n\n  get debug() {\n    return this._debug;\n  }\n\n  @Input('hiddenData') set hiddenData(hiddenData: number[]) {\n    this._hiddenData = [...hiddenData];\n  }\n\n  get hiddenData(): number[] {\n    return this._hiddenData;\n  }\n\n  @Input('options') options: Param;\n  @Input('gtsFilter') gtsFilter = 'x';\n  @Input('gtsList') gtsList: any[];\n  @Input('params') params: Param[];\n  @Input('branch') branch = false;\n  @Input('hidden') hidden = false;\n  @Input() events: Observable<void>;\n\n  @Output('warpViewSelectedGTS') warpViewSelectedGTS = new EventEmitter<any>();\n\n  hide: any = {};\n  initOpen: Subject<void> = new Subject<void>();\n  stateChange: Subject<boolean> = new Subject<boolean>();\n\n  private LOG: Logger;\n  private _debug = false;\n  private _hiddenData: number[] = [];\n  private eventsSubscription: Subscription;\n  private _kbdLastKeyPressed: string[] = [];\n\n  @Input('kbdLastKeyPressed')\n  set kbdLastKeyPressed(kbdLastKeyPressed: string[]) {\n    this.LOG.debug(['kbdLastKeyPressed'], kbdLastKeyPressed);\n    this._kbdLastKeyPressed = kbdLastKeyPressed;\n    if (kbdLastKeyPressed[0] === 'a') {\n      this.stateChange.next(true);\n    }\n    if (kbdLastKeyPressed[0] === 'n') {\n      this.stateChange.next(false);\n    }\n  }\n\n  get kbdLastKeyPressed() {\n    return this._kbdLastKeyPressed;\n  }\n\n  constructor() {\n    this.LOG = new Logger(WarpViewTreeViewComponent, this.debug);\n  }\n\n  ngOnInit(): void {\n    this.eventsSubscription = this.events.subscribe(() => this.open());\n    this.LOG.debug(['ngOnInit'], this.gtsList);\n    const size = this.gtsList.length;\n    for (let i = 0; i < size; i++) {\n      this.hide[i + ''] = false;\n    }\n  }\n\n  ngOnDestroy() {\n    this.eventsSubscription.unsubscribe();\n  }\n\n\n  toggleVisibility(index: number) {\n    this.LOG.debug(['toggleVisibility'], index, this.hide);\n    this.hide[index + ''] = !this.hide[index + ''];\n  }\n\n  isHidden(index: number) {\n    return !!this.hide[index + ''] ? !!this.hide[index + ''] : false;\n  }\n\n  isGts(node) {\n    return GTSLib.isGts(node);\n  }\n\n  identify(index, item) {\n    return index;\n  }\n\n  warpViewSelectedGTSHandler(event) {\n    // this.LOG.debug(['warpViewSelectedGTS'], event);\n    this.warpViewSelectedGTS.emit(event);\n  }\n\n  open() {\n    this.gtsList.forEach((g, index) => this.hide[index + ''] = true);\n    setTimeout(() => this.initOpen.next());\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Label} from './label';\n\nexport class GTS {\n  c: string;\n  l: Label[];\n  a: Label[];\n  v: any[][];\n  id?: number;\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {\n  AfterViewInit,\n  Component,\n  ElementRef,\n  EventEmitter,\n  Input,\n  OnDestroy,\n  OnInit,\n  Output,\n  Renderer2,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\nimport {GTS} from '../../../model/GTS';\nimport {Logger} from '../../../utils/logger';\nimport {GTSLib} from '../../../utils/gts.lib';\nimport {ColorLib} from '../../../utils/color-lib';\nimport {Param} from '../../../model/param';\nimport {Observable, Subscription} from 'rxjs';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-chip',\n  templateUrl: './warp-view-chip.component.html',\n  styleUrls: ['./warp-view-chip.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewChipComponent implements OnInit, AfterViewInit, OnDestroy {\n  private eventsSubscription: Subscription;\n\n  @ViewChild('chip') chip: ElementRef;\n\n  @Input('node') node: any;\n  @Input('param') param: Param = new Param();\n  @Input('options') options: Param = new Param();\n  @Input() events: Observable<boolean>;\n\n  @Input('debug') set debug(debug: boolean) {\n    this._debug = debug;\n    this.LOG.setDebug(debug);\n  }\n\n  get debug() {\n    return this._debug;\n  }\n\n  @Input('hiddenData') set hiddenData(hiddenData: number[]) {\n    if (JSON.stringify(hiddenData) !== JSON.stringify(this._hiddenData)) {\n      this._hiddenData = hiddenData;\n      this.LOG.debug(['hiddenData'], hiddenData, this._node, this._node.gts, this._node.gts.c);\n      if (!!this._node && !!this._node.gts && !!this._node.gts.c) {\n        this.setState(this._hiddenData.indexOf(this._node.gts.id) === -1);\n      }\n    }\n  }\n\n  get hiddenData(): number[] {\n    return this._hiddenData;\n  }\n\n  @Input('gtsFilter') set gtsFilter(gtsFilter: string) {\n    this._gtsFilter = gtsFilter;\n    if (this._gtsFilter.slice(1) !== '') {\n      this.setState(new RegExp(this._gtsFilter.slice(1), 'gi').test(GTSLib.serializeGtsMetadata(this._node.gts)));\n    } else {\n      this.setState(true);\n    }\n  }\n\n  get gtsFilter() {\n    return this._gtsFilter;\n  }\n\n  @Output('warpViewSelectedGTS') warpViewSelectedGTS = new EventEmitter<any>();\n\n  private LOG: Logger;\n  // the first character triggers change each filter apply to trigger events. it must be discarded.\n  private _gtsFilter = 'x';\n  private _debug = false;\n  private _hiddenData: number[] = [];\n  _node: any = {\n    selected: true,\n    gts: GTS,\n  };\n\n  constructor(private renderer: Renderer2) {\n    this.LOG = new Logger(WarpViewChipComponent, this.debug);\n  }\n\n  ngOnInit(): void {\n    this._node = {...this.node, selected: this._hiddenData.indexOf(this.node.gts.id) === -1};\n    if(!!this.events) {\n      this.eventsSubscription = this.events.subscribe(state => this.setState(state));\n    }\n  }\n\n  ngOnDestroy() {\n    if(!!this.eventsSubscription) {\n      this.eventsSubscription.unsubscribe();\n    }\n  }\n\n  ngAfterViewInit() {\n    if (this.gtsFilter.slice(1) !== '' && new RegExp(this.gtsFilter.slice(1), 'gi').test(GTSLib.serializeGtsMetadata(this._node.gts))\n      || this.hiddenData.indexOf(this._node.gts.id) > -1) {\n      this.setState(false);\n    } else {\n      this.colorizeChip();\n    }\n  }\n\n  private colorizeChip() {\n    if (!!this.chip) {\n      if (!!this._node.selected) {\n        const c = ColorLib.getColor(this._node.gts.id, this.options.scheme);\n        const color = (this.param || {datasetColor: c}).datasetColor || c;\n        this.renderer.setStyle(this.chip.nativeElement, 'background-color', color);\n        this.renderer.setStyle(this.chip.nativeElement, 'border-color', color);\n      } else {\n        this.renderer.setStyle(this.chip.nativeElement, 'background-color', 'transparent');\n      }\n    }\n  }\n\n  toArray(obj) {\n    if (obj === undefined) {\n      return [];\n    }\n    return Object.keys(obj).map(key => ({name: key, value: obj[key]}));\n  }\n\n  switchPlotState(event: UIEvent) {\n    event.preventDefault();\n    this.setState(!this._node.selected);\n    return false;\n  }\n\n  private setState(state: boolean) {\n    if (this._node && this._node.gts) {\n      this.LOG.debug(['switchPlotState'], state, this._node.selected);\n      if (this._node.selected !== state) {\n        this._node.selected = !!state;\n        this.LOG.debug(['switchPlotState'], 'emit');\n        this.warpViewSelectedGTS.emit(this._node);\n      }\n      this.colorizeChip();\n    }\n  }\n\n  identify(index, item) {\n    return index;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {AfterViewInit, Component, ElementRef, HostListener, Input, NgZone, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {Param} from '../../model/param';\nimport {ChartLib} from '../../utils/chart-lib';\nimport {DataModel} from '../../model/dataModel';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-image',\n  templateUrl: './warp-view-image.component.html',\n  styleUrls: ['./warp-view-image.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewImageComponent extends WarpViewComponent implements AfterViewInit {\n  @Input('imageTitle') imageTitle = '';\n\n  toDisplay: string[];\n\n  private resizeTimer;\n  private parentWidth = -1;\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewImageComponent, this._debug);\n  }\n\n  ngAfterViewInit(): void {\n    this.LOG.debug(['ngAfterViewInit'], this._options);\n    this.drawChart();\n  }\n\n  update(options: Param, refresh: boolean): void {\n    this.drawChart();\n  }\n\n  @HostListener('window:resize')\n  onResize() {\n    if (this.el.nativeElement.parentElement.clientWidth !== this.parentWidth || this.parentWidth <= 0) {\n      this.parentWidth = this.el.nativeElement.parentElement.clientWidth;\n      clearTimeout(this.resizeTimer);\n      this.resizeTimer = setTimeout(() => {\n        if (this.el.nativeElement.parentElement.clientWidth > 0) {\n          this.LOG.debug(['onResize'], this.el.nativeElement.parentElement.clientWidth);\n          this.drawChart();\n        } else {\n          this.onResize();\n        }\n      }, 150);\n    }\n  }\n\n  private drawChart() {\n    if (!this._data || !this._data.data || this._data.data.length === 0) {\n      return;\n    }\n    this.initChart(this.el);\n    this.toDisplay = [];\n    let gts: DataModel = this._data;\n    this.LOG.debug(['drawChart', 'gts'], gts);\n    if (typeof gts === 'string') {\n      try {\n        gts = JSON.parse(gts as string);\n      } catch (error) {\n        // empty : it's a base64 string\n      }\n    }\n    if (gts.data && gts.data.length > 0 && GTSLib.isEmbeddedImage(gts.data[0])) {\n      this._options = ChartLib.mergeDeep(this._options, gts.globalParams || {}) as Param;\n      this.toDisplay.push(gts.data[0]);\n    } else if (gts.data && GTSLib.isEmbeddedImage(gts.data)) {\n      this.toDisplay.push(gts.data as string);\n    }\n    this.LOG.debug(['drawChart', 'this.data', 'this.toDisplay'], this.data, this.toDisplay);\n    this.loading = false;\n    this.chartDraw.emit();\n  }\n\n  getStyle() {\n    this.LOG.debug(['getStyle'], this._options);\n    if (!this._options) {\n      return {};\n    } else {\n      const style: any = {'background-color': this._options.bgColor || 'transparent', width: this.width, height: 'auto'};\n      if (this._options.fontColor) {\n        style.color = this._options.fontColor;\n      }\n      this.LOG.debug(['getStyle', 'style'], style);\n      return style;\n    }\n  }\n\n  protected convert(data: DataModel): any[] {\n    return [];\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {GTSLib} from './gts.lib';\nimport {ColorLib} from './color-lib';\nimport {Logger} from './logger';\nimport {Param} from '../model/param';\n\nexport class MapLib {\n  static BASE_RADIUS = 2;\n  private static LOG: Logger = new Logger(MapLib, true);\n\n  static mapTypes: any = {\n    NONE: undefined,\n    DEFAULT: {\n      link: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n      attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n    },\n    HOT: {\n      link: 'https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png',\n      attribution: `&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors, Tiles\n style by <a href=\"https://www.hotosm.org/\" target=\"_blank\">Humanitarian OpenStreetMap Team</a> hosted by\n <a href=\"https://openstreetmap.fr/\" target=\"_blank\">OpenStreetMap France</a>`\n    },\n    TOPO: {\n      link: 'https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png',\n      attribution: `Map data: &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors,\n <a href=\"http://viewfinderpanoramas.org\">SRTM</a> | Map style: &copy; <a href=\"https://opentopomap.org\">OpenTopoMap</a>\n  (<a href=\"https://creativecommons.org/licenses/by-sa/3.0/\">CC-BY-SA</a>)`\n    },\n    TOPO2: {\n      link: 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}',\n      attribution: `Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ, TomTom, Intermap, iPC, USGS, FAO, NPS, NRCAN,\n       GeoBase, Kadaster NL, Ordnance Survey, Esri Japan, METI, Esri China (Hong Kong), and the GIS User Community`\n    },\n    SURFER: {\n      link: 'https://maps.heigit.org/openmapsurfer/tiles/roads/webmercator/{z}/{x}/{y}.png',\n      attribution: `Imagery from <a href=\"http://giscience.uni-hd.de/\">GIScience Research Group @ University of\n Heidelberg</a> | Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors`\n    },\n    HYDRA: {\n      link: 'https://{s}.tile.openstreetmap.se/hydda/full/{z}/{x}/{y}.png',\n      attribution: `Tiles courtesy of <a href=\"http://openstreetmap.se/\" target=\"_blank\">OpenStreetMap Sweden</a>\n &mdash; Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors`\n    },\n    HYDRA2: {\n      link: 'https://{s}.tile.openstreetmap.se/hydda/base/{z}/{x}/{y}.png',\n      attribution: `Tiles courtesy of <a href=\"http://openstreetmap.se/\" target=\"_blank\">OpenStreetMap Sweden</a>\n &mdash; Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors`\n    },\n    TONER: {\n      link: 'https://stamen-tiles-{s}.a.ssl.fastly.net/toner/{z}/{x}/{y}{r}.png',\n      attribution: `Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>,\n <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> &mdash; Map data &copy;\n  <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors`,\n      subdomains: 'abcd'\n    },\n    TONER_LITE: {\n      link: 'https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}{r}.png',\n      attribution: `Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>,\n <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> &mdash; Map data &copy;\n  <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors`,\n      subdomains: 'abcd',\n    },\n    TERRAIN: {\n      link: 'https://stamen-tiles-{s}.a.ssl.fastly.net/terrain/{z}/{x}/{y}{r}.png',\n      attribution: `Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>,\n <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> &mdash; Map data &copy;\n <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors`,\n      subdomains: 'abcd',\n    },\n    ESRI: {\n      link: 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}',\n      attribution: `Tiles &copy; Esri &mdash; Source: Esri, DeLorme, NAVTEQ, USGS, Intermap, iPC, NRCAN, Esri Japan,\n METI, Esri China (Hong Kong), Esri (Thailand), TomTom, 2012`\n    },\n    SATELLITE: {\n      link: 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',\n      attribution: `Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN,\n IGP, UPR-EGP, and the GIS User Community`\n    },\n    OCEANS: {\n      link: 'https://server.arcgisonline.com/ArcGIS/rest/services/Ocean_Basemap/MapServer/tile/{z}/{y}/{x}',\n      attribution: 'Tiles &copy; Esri &mdash; Sources: GEBCO, NOAA, CHS, OSU, UNH, CSUMB, National Geographic, DeLorme, NAVTEQ, and Esri',\n    },\n    GRAY: {\n      link: 'https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}',\n      attibs: ''\n    },\n    GRAYSCALE: {\n      link: 'https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}',\n      attribution: 'Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ',\n    },\n    WATERCOLOR: {\n      link: 'https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.jpg',\n      attribution: `Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>,\n <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> &mdash; Map data &copy;\n  <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors`,\n      subdomains: 'abcd',\n    },\n    CARTODB: {\n      link: 'https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png',\n      attribution: `&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy;\n <a href=\"https://carto.com/attributions\">CartoDB</a>`,\n      subdomains: 'abcd',\n    },\n    CARTODB_DARK: {\n      link: 'https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png',\n      attribution: `&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy;\n <a href=\"https://carto.com/attributions\">CartoDB</a>`,\n      subdomains: 'abcd',\n    },\n  };\n\n  static toLeafletMapPaths(data: { gts: any[]; params: any[] }, hiddenData: number[], scheme: string) {\n    const paths = [];\n    const size = (data.gts || []).length;\n    for (let i = 0; i < size; i++) {\n      const gts = data.gts[i];\n      let params = (data.params || [])[i];\n      if (!params) {\n        params = {};\n      }\n      if (GTSLib.isGtsToPlotOnMap(gts) && (hiddenData || []).filter(id => id === gts.id).length === 0) {\n        const path: any = {};\n        MapLib.extractCommonParameters(path, params, i, scheme);\n\n        path.path = MapLib.gtsToPath(gts);\n        if (!!params.render) {\n          path.render = params.render;\n        }\n        if (!!params.marker) {\n          path.marker = params.marker;\n        }\n        path.line = params.hasOwnProperty('line') ? params.line : true;\n        path.render = path.render || 'dots';\n        if (path.render === 'weightedDots') {\n          MapLib.validateWeightedDotsPositionArray(path, params);\n        }\n        if (path.render === 'coloredWeightedDots') {\n          MapLib.validateWeightedColoredDotsPositionArray(path, params);\n        }\n        if (data.params && data.params[i] && data.params[i].key) {\n          path.key = data.params[i].key;\n        } else {\n          path.key = GTSLib.serializeGtsMetadata(gts);\n        }\n        if (data.params && data.params[i] && data.params[i].color) {\n          path.color = data.params[i].color;\n        } else {\n          path.color = ColorLib.getColor(i, scheme);\n        }\n        paths.push(path);\n      }\n    }\n    return paths;\n  }\n\n  static gtsToPath(gts) {\n    const path = [];\n    const size = (gts.v || []).length;\n    for (let i = 0; i < size; i++) {\n      const v = gts.v[i];\n      const l = v.length;\n      if (l >= 4) {\n        // timestamp, lat, lon, elev?, value\n        path.push({ts: Math.floor(v[0]), lat: v[1], lon: v[2], val: v[l - 1]});\n      }\n    }\n    return path;\n  }\n\n  private static extractCommonParameters(obj, params, index, scheme: string) {\n    params = params || {};\n    obj.key = params.key || '';\n    obj.color = params.color || ColorLib.getColor(index, scheme);\n    obj.borderColor = params.borderColor;\n    obj.properties = params.properties || {};\n    if (params.baseRadius === undefined\n      || isNaN(parseInt(params.baseRadius, 10))\n      || parseInt(params.baseRadius, 10) < 0) {\n      obj.baseRadius = MapLib.BASE_RADIUS;\n    } else {\n      obj.baseRadius = params.baseRadius;\n    }\n  }\n\n  private static validateWeightedDotsPositionArray(posArray, params) {\n    if (params.minValue === undefined || params.maxValue === undefined) {\n      MapLib.LOG.error(['validateWeightedDotsPositionArray'], 'When using \\'weightedDots\\' or ' +\n        '\\'weightedColoredDots\\' rendering, \\'maxValue\\' and \\'minValue\\' parameters are compulsory');\n      posArray.render = undefined;\n      return;\n    }\n    posArray.maxValue = params.maxValue;\n    posArray.minValue = params.minValue;\n    if (typeof posArray.minValue !== 'number' ||\n      typeof posArray.maxValue !== 'number' ||\n      posArray.minValue >= posArray.maxValue) {\n      MapLib.LOG.error(['validateWeightedDotsPositionArray'], 'When using \\'weightedDots\\' or ' +\n        '\\'weightedColoredDots\\' rendering, \\'maxValue\\' and \\'minValue\\' must be numbers and \\'maxValue\\' ' +\n        'must be greater than \\'minValue\\'');\n      posArray.render = undefined;\n      return;\n    }\n    if (!GTSLib.isPositionsArrayWithValues(posArray) && !GTSLib.isPositionsArrayWithTwoValues(posArray)) {\n      MapLib.LOG.error(['validateWeightedDotsPositionArray'], 'When using \\'weightedDots\\' or ' +\n        '\\'weightedColoredDots\\' rendering, positions must have an associated value');\n      posArray.render = undefined;\n      return;\n    }\n\n    if (params.numSteps === undefined || isNaN(parseInt(params.numSteps, 10)) || parseInt(params.numSteps, 10) < 0) {\n      posArray.numSteps = 5;\n    } else {\n      posArray.numSteps = params.numSteps;\n    }\n    const step = (posArray.maxValue - posArray.minValue) / posArray.numSteps;\n    const steps = [];\n    for (let i = 0; i < posArray.numSteps - 1; i++) {\n      steps[i] = posArray.minValue + (i + 1) * step;\n    }\n    steps[posArray.numSteps - 1] = posArray.maxValue;\n\n    const size = (posArray || []).length;\n    for (let i = 0; i < size; i++) {\n      const pos = posArray[i];\n      const value = pos[2];\n      pos[4] = posArray.numSteps - 1;\n      for (const k in steps) {\n        if (value <= steps[k]) {\n          pos[4] = k;\n          break;\n        }\n      }\n    }\n    return true;\n  }\n\n  static toLeafletMapPositionArray(data: { gts: any[]; params: any[] }, hiddenData: number[], scheme: string) {\n    const positions = [];\n    const size = (data.gts || []).length;\n    for (let i = 0; i < size; i++) {\n      const gts = data.gts[i];\n      if (GTSLib.isPositionArray(gts) && (hiddenData || []).filter(id => id === gts.id).length === 0) {\n        this.LOG.debug(['toLeafletMapPositionArray'], gts, data.params ? data.params[i] : '');\n        const posArray = gts;\n        const params = data.params ? data.params[i] || {} : {};\n        MapLib.extractCommonParameters(posArray, params, i, scheme);\n        posArray.render = params.render || 'dots';\n        posArray.maxValue = params.maxValue || 0;\n        posArray.minValue = params.minValue || 0;\n        posArray.line = params.hasOwnProperty('line') ? params.line : false;\n        if (posArray.render === 'weightedDots') {\n          MapLib.validateWeightedDotsPositionArray(posArray, params);\n        }\n        if (posArray.render === 'coloredWeightedDots') {\n          MapLib.validateWeightedColoredDotsPositionArray(posArray, params);\n        }\n        if (posArray.render === 'marker') {\n          posArray.marker = params.marker;\n        }\n        if (data.params && data.params[i] && data.params[i].color) {\n          posArray.color = data.params[i].color;\n        } else {\n          posArray.color = ColorLib.getColor(i, scheme);\n        }\n        this.LOG.debug(['toLeafletMapPositionArray', 'posArray'], posArray);\n        positions.push(posArray);\n      }\n    }\n    return positions;\n  }\n\n  private static validateWeightedColoredDotsPositionArray(posArray: any, params: Param) {\n    if (!MapLib.validateWeightedDotsPositionArray(posArray, params)) {\n      return;\n    }\n    if (!params.minColor || !params.maxColor || !params.startColor || !params.endColor) {\n      MapLib.LOG.error(['validateWeightedColoredDotsPositionArray'], 'When using ' +\n        '\\'weightedColoredDots\\' rendering, \\'maxColorValue\\', \\'minColorValue\\', \\'startColor\\' ' +\n        'and \\'endColor\\' parameters are compulsory');\n      posArray.render = undefined;\n      return;\n    }\n\n    posArray.maxColorValue = params.maxColor;\n    posArray.minColorValue = params.minColor;\n\n    if (typeof posArray.minColorValue !== 'number' ||\n      typeof posArray.maxColorValue !== 'number' ||\n      posArray.minColorValue >= posArray.maxColorValue) {\n      MapLib.LOG.error(['validateWeightedColoredDotsPositionArray'], ['When using ' +\n      'weightedColoredDots\\' rendering, \\'maxColorValue\\' and \\'minColorValue\\' must be numbers ' +\n      'and \\'maxColorValue\\' must be greater than \\'minColorValue\\'', {\n        maxColorValue: posArray.maxColorValue,\n        minColorValue: posArray.minColorValue,\n      }]);\n      posArray.render = undefined;\n      return;\n    }\n    const re = /^#(?:[0-9a-f]{3}){1,2}$/i;\n    if (typeof params.startColor !== 'string'\n      || typeof params.endColor !== 'string'\n      || !re.test(params.startColor)\n      || !re.test(params.endColor)) {\n      MapLib.LOG.error(['validateWeightedColoredDotsPositionArray'], ['When using ' +\n      'weightedColoredDots\\' rendering, \\'startColor\\' and \\'endColor\\' parameters must be RGB ' +\n      'colors in #rrggbb format', {\n        startColor: params.startColor,\n        endColor: params.endColor,\n        tests: [\n          typeof params.startColor,\n          typeof params.endColor,\n          re.test(params.startColor),\n          re.test(params.endColor),\n          re.test(params.startColor),\n        ],\n      }]);\n      posArray.render = undefined;\n      return;\n    }\n\n    posArray.startColor = {\n      r: parseInt(params.startColor.substring(1, 3), 16),\n      g: parseInt(params.startColor.substring(3, 5), 16),\n      b: parseInt(params.startColor.substring(5, 7), 16),\n    };\n\n    posArray.endColor = {\n      r: parseInt(params.endColor.substring(1, 3), 16),\n      g: parseInt(params.endColor.substring(3, 5), 16),\n      b: parseInt(params.endColor.substring(5, 7), 16),\n    };\n\n    if (!params.numColorSteps) {\n      posArray.numColorSteps = 5;\n    } else {\n      posArray.numColorSteps = params.numColorSteps;\n    }\n\n    posArray.colorGradient = ColorLib.hsvGradientFromRgbColors(\n      posArray.startColor,\n      posArray.endColor,\n      posArray.numColorSteps);\n\n    const step = (posArray.maxColorValue - posArray.minColorValue) / posArray.numColorSteps;\n    const steps = [];\n    for (let j = 0; j < posArray.numColorSteps; j++) {\n      steps[j] = posArray.minColorValue + (j + 1) * step;\n    }\n\n    posArray.steps = steps;\n\n    posArray.positions.forEach(pos => {\n      const colorValue = pos[3];\n      pos[5] = posArray.numColorSteps - 1;\n      for (let k = 0; k < steps.length - 1; k++) {\n        if (colorValue < steps[k]) {\n          pos[5] = k;\n          break;\n        }\n      }\n    });\n  }\n\n  static getBoundsArray(paths, positionsData, annotationsData, geoJson) {\n    const pointsArray = [];\n    let size;\n    this.LOG.debug(['getBoundsArray', 'paths'], paths);\n    size = (paths || []).length;\n    for (let i = 0; i < size; i++) {\n      const path = paths[i];\n      const s = (path.path || []).length;\n      for (let j = 0; j < s; j++) {\n        const p = path.path[j];\n        pointsArray.push([p.lat, p.lon]);\n      }\n    }\n    this.LOG.debug(['getBoundsArray', 'positionsData'], positionsData);\n    size = (positionsData || []).length;\n    for (let i = 0; i < size; i++) {\n      const position = positionsData[i];\n      const s = (position.positions || []).length;\n      for (let j = 0; j < s; j++) {\n        const p = position.positions[j];\n        pointsArray.push([p[0], p[1]]);\n      }\n    }\n    this.LOG.debug(['getBoundsArray', 'annotationsData'], annotationsData);\n    size = (annotationsData || []).length;\n    for (let i = 0; i < size; i++) {\n      const annotation = annotationsData[i];\n      const s = (annotation.path || []).length;\n      for (let j = 0; j < s; j++) {\n        const p = annotation.path[j];\n        pointsArray.push([p.lat, p.lon]);\n      }\n    }\n    size = (geoJson || []).length;\n    for (let i = 0; i < size; i++) {\n      const g = geoJson[i];\n      switch (g.geometry.type) {\n        case 'MultiPolygon':\n          g.geometry.coordinates.forEach(c => c.forEach(m => m.forEach(p => pointsArray.push([p[1], p[0]]))));\n          break;\n        case 'Polygon':\n          g.geometry.coordinates.forEach(c => c.forEach(p => pointsArray.push([p[1], p[0]])));\n          break;\n        case 'LineString':\n          g.geometry.coordinates.forEach(p => pointsArray.push([p[1], p[0]]));\n          break;\n        case 'Point':\n          pointsArray.push([g.geometry.coordinates[1], g.geometry.coordinates[0]]);\n          break;\n      }\n    }\n    if (pointsArray.length === 1) {\n      return pointsArray;\n    }\n    let south = 90;\n    let west = -180;\n    let north = -90;\n    let east = 180;\n    this.LOG.debug(['getBoundsArray'], pointsArray);\n    size = (pointsArray || []).length;\n    for (let i = 0; i < size; i++) {\n      const point = pointsArray[i];\n      if (point[0] > north) {\n        north = point[0];\n      }\n      if (point[0] < south) {\n        south = point[0];\n      }\n      if (point[1] > west) {\n        west = point[1];\n      }\n      if (point[1] < east) {\n        east = point[1];\n      }\n    }\n    return [[south, west], [north, east]];\n  }\n\n  static pathDataToLeaflet(pathData: any[]) {\n    const path = [];\n    const size = pathData.length;\n    for (let i = 0; i < size; i++) {\n      path.push([pathData[i].lat, pathData[i].lon]);\n    }\n    return path;\n  }\n\n  static toGeoJSON(data: { gts: any[]; params: any[] }) {\n    const defShapes = ['Point', 'LineString', 'Polygon', 'MultiPolygon'];\n    const geoJsons = [];\n    data.gts.forEach(d => {\n      if (d && d.type && d.type === 'Feature' && d.geometry && d.geometry.type && defShapes.indexOf(d.geometry.type) > -1) {\n        geoJsons.push(d);\n      } else if (d && d.type && defShapes.indexOf(d.type) > -1) {\n        geoJsons.push({type: 'Feature', geometry: d});\n      }\n    });\n    return geoJsons;\n  }\n\n  static updatePositionArrayToLeaflet(positionArray: any[]) {\n    const latLng = [];\n    const size = (positionArray || []).length;\n    for (let i = 0; i < size; i++) {\n      const pos = positionArray[i];\n      latLng.push([pos[0], pos[1]]);\n    }\n    return latLng;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, EventEmitter, Input, OnInit, Output, Renderer2, ViewChild, ViewEncapsulation} from '@angular/core';\nimport {Param} from '../../model/param';\nimport {Logger} from '../../utils/logger';\nimport Leaflet, {TileLayerOptions} from 'leaflet';\nimport 'leaflet.heat';\nimport 'leaflet.markercluster';\nimport {ColorLib} from '../../utils/color-lib';\nimport {ChartLib} from '../../utils/chart-lib';\nimport {DataModel} from '../../model/dataModel';\nimport {MapLib} from '../../utils/map-lib';\nimport {GTSLib} from '../../utils/gts.lib';\nimport moment from 'moment-timezone';\nimport deepEqual from 'deep-equal';\nimport {SizeService} from '../../services/resize.service';\nimport {Timsort} from '../../utils/timsort';\nimport {antPath} from 'leaflet-ant-path';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-map',\n  templateUrl: './warp-view-map.component.html',\n  styleUrls: ['./warp-view-map.component.scss'],\n  encapsulation: ViewEncapsulation.None\n})\nexport class WarpViewMapComponent implements OnInit {\n\n  @ViewChild('mapDiv', {static: true}) mapDiv: ElementRef<HTMLDivElement>;\n  @ViewChild('wrapper', {static: true}) wrapper: ElementRef<HTMLDivElement>;\n  @ViewChild('timeSlider') timeSlider: ElementRef<HTMLDivElement>;\n  @ViewChild('timeRangeSlider') timeRangeSlider: ElementRef<HTMLDivElement>;\n\n  @Input('heatData') heatData: any[] = [];\n  @Input('responsive') responsive = false;\n  @Input('showLegend') showLegend = true;\n  @Input('width') width = ChartLib.DEFAULT_WIDTH;\n  @Input('height') height = ChartLib.DEFAULT_HEIGHT;\n  private bounds: Leaflet.LatLngBounds;\n\n  @Input('debug') set debug(debug: boolean) {\n    this._debug = debug;\n    this.LOG.setDebug(debug);\n  }\n\n  get debug() {\n    return this._debug;\n  }\n\n  @Input('options') set options(options: Param) {\n    this.LOG.debug(['onOptions'], options);\n    if (!deepEqual(this._options, options)) {\n      const reZoom =\n        options.map.startZoom !== this._options.map.startZoom\n        || options.map.startLat !== this._options.map.startLat\n        || options.map.startLong !== this._options.map.startLong;\n      this._options = options;\n      this.divider = GTSLib.getDivider(this._options.timeUnit);\n      this.drawMap(reZoom);\n    }\n  }\n\n  @Input('data') set data(data: any) {\n    this.LOG.debug(['onData'], data);\n    this.pointslayer = [];\n    this.annotationsMarkers = [];\n    this.positionArraysMarkers = [];\n    if (!!data) {\n      this._data = data;\n      this.drawMap(true);\n    }\n  }\n\n  get data() {\n    return this._data;\n  }\n\n  @Input('hiddenData') set hiddenData(hiddenData: number[]) {\n    this._hiddenData = hiddenData;\n    this.drawMap(false);\n  }\n\n  get hiddenData(): number[] {\n    return this._hiddenData;\n  }\n\n  @Output('change') change = new EventEmitter();\n  @Output('chartDraw') chartDraw = new EventEmitter();\n\n  currentZoom: number;\n  currentLat: number;\n  currentLong: number;\n  minTimeValue: number;\n  maxTimeValue: number;\n  divider = 1;\n  lowerTimeBound: number;\n  upperTimeBound: number;\n  timeSpan: number;\n  _options: Param = new Param();\n\n  private _firstDraw = true;\n  private LOG: Logger;\n  private _data: any;\n  private _debug = false;\n  private defOptions: Param = ChartLib.mergeDeep<Param>(\n    new Param(), {\n      map: {\n        heatControls: false,\n        tiles: [],\n        dotsLimit: 1000,\n        animate: false\n      },\n      timeMode: 'date',\n      showRangeSelector: true,\n      gridLineColor: '#8e8e8e',\n      showDots: false,\n      timeZone: 'UTC',\n      timeUnit: 'us',\n      bounds: {}\n    });\n\n  private _map: Leaflet.Map;\n  private _hiddenData: number[];\n  private pointslayer = [];\n  private annotationsMarkers = [];\n  private positionArraysMarkers = [];\n  private _iconAnchor: Leaflet.PointExpression = [20, 38];\n  private _popupAnchor: Leaflet.PointExpression = [0, -50];\n  private _heatLayer: any;\n  private pathData: any[] = [];\n  private positionData: any[] = [];\n  private geoJson: any[] = [];\n  private timeStart: number;\n  private timeEnd: number;\n  private firstDraw = true;\n  private finalHeight = 0;\n  // Layers\n  private pathDataLayer = Leaflet.featureGroup();\n  private positionDataLayer = Leaflet.featureGroup();\n  private tileLayerGroup = Leaflet.featureGroup();\n  private geoJsonLayer = Leaflet.featureGroup();\n  private tilesLayer: Leaflet.TileLayer;\n\n  constructor(public el: ElementRef, public sizeService: SizeService, private renderer: Renderer2) {\n    this.LOG = new Logger(WarpViewMapComponent, this.debug);\n    this.LOG.debug(['constructor'], this.debug);\n    this.sizeService.sizeChanged$.subscribe(() => {\n      if (this._map) {\n        this.resizeMe();\n      }\n    });\n  }\n\n  ngOnInit(): void {\n    this._options = ChartLib.mergeDeep(this.defOptions, this._options) as Param;\n  }\n\n  resizeMe() {\n    this.LOG.debug(['resizeMe'], this.wrapper.nativeElement.parentElement.getBoundingClientRect());\n    let height = this.wrapper.nativeElement.parentElement.getBoundingClientRect().height;\n    const width = this.wrapper.nativeElement.parentElement.getBoundingClientRect().width;\n    if (this._options.map.showTimeSlider && this.timeSlider && this.timeSlider.nativeElement) {\n      height -= this.timeSlider.nativeElement.getBoundingClientRect().height;\n    }\n    if (this._options.map.showTimeRange && this.timeRangeSlider && this.timeRangeSlider.nativeElement) {\n      height -= this.timeRangeSlider.nativeElement.getBoundingClientRect().height;\n    }\n    this.finalHeight = height;\n    this.renderer.setStyle(this.mapDiv.nativeElement, 'width', 'calc(' + width + 'px - '\n      + getComputedStyle(this.wrapper.nativeElement).getPropertyValue('--warp-view-map-margin').trim()\n      + ' - '\n      + getComputedStyle(this.wrapper.nativeElement).getPropertyValue('--warp-view-map-margin').trim()\n      + ')');\n    this.renderer.setStyle(this.mapDiv.nativeElement, 'height', 'calc(' + height + 'px - '\n      + getComputedStyle(this.wrapper.nativeElement).getPropertyValue('--warp-view-map-margin').trim()\n      + ' - '\n      + getComputedStyle(this.wrapper.nativeElement).getPropertyValue('--warp-view-map-margin').trim()\n      + ')');\n    this.width = width;\n    this.height = height;\n    if (!!this._map) {\n      setTimeout(() => this._map.invalidateSize());\n    }\n  }\n\n  heatRadiusDidChange(event) {\n    this._heatLayer.setOptions({radius: event.detail.valueAsNumber});\n    this.LOG.debug(['heatRadiusDidChange'], event.detail.valueAsNumber);\n  }\n\n  heatBlurDidChange(event) {\n    this._heatLayer.setOptions({blur: event.detail.valueAsNumber});\n    this.LOG.debug(['heatBlurDidChange'], event.detail.valueAsNumber);\n  }\n\n  heatOpacityDidChange(event) {\n    const minOpacity = event.detail.valueAsNumber / 100;\n    this._heatLayer.setOptions({minOpacity});\n    this.LOG.debug(['heatOpacityDidChange'], event.detail.valueAsNumber);\n  }\n\n  private drawMap(reZoom: boolean) {\n    this.LOG.debug(['drawMap'], this._data);\n    this._options = ChartLib.mergeDeep(this.defOptions, this._options) as Param;\n    this.timeStart = this._options.map.timeStart;\n    moment.tz.setDefault(this._options.timeZone);\n    let gts: any = this._data;\n    if (!gts) {\n      return;\n    }\n    if (typeof gts === 'string') {\n      try {\n        gts = JSON.parse(gts as string);\n      } catch (error) {\n        return;\n      }\n    }\n    if (GTSLib.isArray(gts) && gts[0] && (gts[0] instanceof DataModel || gts[0].hasOwnProperty('data'))) {\n      gts = gts[0];\n    }\n    if (!!this._map) {\n      this._map.invalidateSize(true);\n    }\n    let dataList: any[];\n    let params: any[];\n    this.LOG.debug(['drawMap', 'this._options'], {... this._options});\n    if (gts.data) {\n      dataList = gts.data as any[];\n      this._options = ChartLib.mergeDeep<Param>(gts.globalParams || {}, this._options);\n      this.timeSpan = this.timeSpan || this._options.map.timeSpan;\n      params = gts.params;\n    } else {\n      dataList = gts;\n      params = [];\n    }\n    this.divider = GTSLib.getDivider(this._options.timeUnit);\n    this.LOG.debug(['drawMap'], dataList, this._options, gts.globalParams);\n    const flattenGTS = GTSLib.flatDeep(dataList);\n\n    const size = flattenGTS.length;\n    for (let i = 0; i < size; i++) {\n      const item = flattenGTS[i];\n      if (GTSLib.isGts(item)) {\n        Timsort.sort(item.v, (a, b) => a[0] - b[0]);\n        item.i = i;\n        i++;\n      }\n    }\n    this.LOG.debug(['GTSLib.flatDeep(dataList)'], flattenGTS);\n    this.displayMap({gts: flattenGTS, params}, reZoom);\n  }\n\n  private icon(color: string, marker = '') {\n    const c = `${color.slice(1)}`;\n    const m = marker !== '' ? marker : 'circle';\n    return Leaflet.icon({\n      // tslint:disable-next-line:max-line-length\n      iconUrl: `https://cdn.mapmarker.io/api/v1/font-awesome/v4/pin?icon=fa-${m}&iconSize=17&size=40&hoffset=${m === 'circle' ? 0 : -1}&voffset=-4&color=fff&background=${c}`,\n      iconAnchor: this._iconAnchor,\n      popupAnchor: this._popupAnchor\n    });\n  }\n\n  private patchMapTileGapBug() {\n    // Workaround for 1px lines appearing in some browsers due to fractional transforms\n    // and resulting anti-aliasing. adapted from @cmulders' solution:\n    // https://github.com/Leaflet/Leaflet/issues/3575#issuecomment-150544739\n    // @ts-ignore\n    const originalInitTile = Leaflet.GridLayer.prototype._initTile;\n    if (originalInitTile.isPatched) {\n      return;\n    }\n    Leaflet.GridLayer.include({\n      _initTile(tile) {\n        originalInitTile.call(this, tile);\n        const tileSize = this.getTileSize();\n        tile.style.width = tileSize.x + 1.5 + 'px';\n        tile.style.height = tileSize.y + 1 + 'px';\n      }\n    });\n    // @ts-ignore\n    Leaflet.GridLayer.prototype._initTile.isPatched = true;\n  }\n\n  private displayMap(data: { gts: any[], params: any[] }, reDraw = false) {\n    this.pointslayer = [];\n    this.LOG.debug(['drawMap'], data, this._options, this._hiddenData || []);\n    if (!this.lowerTimeBound) {\n      this.lowerTimeBound = this._options.map.timeSliderMin / this.divider;\n      this.upperTimeBound = this._options.map.timeSliderMax / this.divider;\n    }\n    let height = this.height || ChartLib.DEFAULT_HEIGHT;\n    const width = this.width || ChartLib.DEFAULT_WIDTH;\n    if (this.responsive && this.finalHeight === 0) {\n      this.resizeMe();\n    } else {\n      if (this._options.map.showTimeSlider && this.timeSlider && this.timeSlider.nativeElement) {\n        height -= this.timeSlider.nativeElement.getBoundingClientRect().height;\n      }\n      if (this._options.map.showTimeRange && this.timeRangeSlider && this.timeRangeSlider.nativeElement) {\n        height -= this.timeRangeSlider.nativeElement.getBoundingClientRect().height;\n      }\n    }\n    this.width = width;\n    this.height = height;\n    if (data.gts.length === 0) {\n      return;\n    }\n    this.pathData = MapLib.toLeafletMapPaths(data, this._hiddenData || [], this._options.scheme) || [];\n    this.LOG.debug(['displayMap'], 'this.pathData', this.pathData);\n    this.positionData = MapLib.toLeafletMapPositionArray(data, this._hiddenData || [], this._options.scheme) || [];\n    this.LOG.debug(['displayMap'], 'this.positionData', this.positionData);\n    this.geoJson = MapLib.toGeoJSON(data);\n    this.LOG.debug(['displayMap'], 'this.geoJson', this.geoJson);\n    if (this._options.map.mapType !== 'NONE') {\n      const map = MapLib.mapTypes[this._options.map.mapType || 'DEFAULT'];\n      this.LOG.debug(['displayMap'], 'map', map);\n      const mapOpts: TileLayerOptions = {\n        maxZoom: 24,\n        maxNativeZoom: 19,\n      };\n      if (map.attribution) {\n        mapOpts.attribution = map.attribution;\n      }\n      if (map.subdomains) {\n        mapOpts.subdomains = map.subdomains;\n      }\n      this.tilesLayer = Leaflet.tileLayer(map.link, mapOpts);\n    }\n\n    if (!!this._map) {\n      this.LOG.debug(['displayMap'], 'map exists');\n      this.pathDataLayer.clearLayers();\n      this.positionDataLayer.clearLayers();\n      this.geoJsonLayer.clearLayers();\n      this.tileLayerGroup.clearLayers();\n    } else {\n      this.LOG.debug(['displayMap'], 'build map');\n      this._map = Leaflet.map(this.mapDiv.nativeElement, {\n        preferCanvas: true,\n        layers: [this.tileLayerGroup, this.geoJsonLayer, this.pathDataLayer, this.positionDataLayer],\n        zoomAnimation: true,\n        maxZoom: 24\n      });\n      this.geoJsonLayer.bringToBack();\n      this.tilesLayer.bringToBack(); // TODO: tester\n      this._map.on('load', () => this.LOG.debug(['displayMap', 'load'], this._map.getCenter().lng, this.currentLong, this._map.getZoom()));\n      this._map.on('zoomend', () => {\n        if (!this.firstDraw) {\n          this.currentZoom = this._map.getZoom();\n        }\n      });\n      this._map.on('moveend', () => {\n        if (!this.firstDraw) {\n          this.currentLat = this._map.getCenter().lat;\n          this.currentLong = this._map.getCenter().lng;\n        }\n      });\n    }\n    this.tilesLayer.addTo(this.tileLayerGroup);\n    this.LOG.debug(['displayMap'], 'build map', this.tilesLayer);\n    // For each path\n    const pathDataSize = (this.pathData || []).length;\n    for (let i = 0; i < pathDataSize; i++) {\n      const path = this.pathData[i];\n      if (!!path) {\n        this.updateGtsPath(path);\n      }\n    }\n    // For each position\n    const positionsSize = (this.positionData || []).length;\n    for (let i = 0; i < positionsSize; i++) {\n      this.updatePositionArray(this.positionData[i]);\n    }\n\n    (this._options.map.tiles || []).forEach((t) => { // TODO to test\n      this.LOG.debug(['displayMap'], t);\n      if (this._options.map.showTimeRange) {\n        this.tileLayerGroup.addLayer(Leaflet.tileLayer(t\n            .replace('{start}', moment(this.timeStart).toISOString())\n            .replace('{end}', moment(this.timeEnd).toISOString()), {\n            subdomains: 'abcd',\n            maxNativeZoom: 19,\n            maxZoom: 40\n          }\n        ));\n      } else {\n        this.tileLayerGroup.addLayer(Leaflet.tileLayer(t, {\n          subdomains: 'abcd',\n          maxNativeZoom: 19,\n          maxZoom: 40\n        }));\n      }\n    });\n    this.LOG.debug(['displayMap', 'geoJson'], this.geoJson);\n    const size = (this.geoJson || []).length;\n    for (let i = 0; i < size; i++) {\n      const m = this.geoJson[i];\n      const color = ColorLib.getColor(i, this._options.scheme);\n      const opts = {\n        style: () => ({\n          color: (data.params && data.params[i]) ? data.params[i].color || color : color,\n          fillColor: (data.params && data.params[i])\n            ? ColorLib.transparentize(data.params[i].fillColor || color)\n            : ColorLib.transparentize(color),\n        })\n      } as any;\n      if (m.geometry.type === 'Point') {\n        opts.pointToLayer = (geoJsonPoint, latlng) => Leaflet.marker(latlng, {\n          icon: this.icon(color, (data.params && data.params[i]) ? data.params[i].marker : 'circle'),\n          opacity: 1,\n        });\n      }\n      let display = '';\n      const geoShape = Leaflet.geoJSON(m, opts);\n      if (m.properties) {\n        Object.keys(m.properties).forEach(k => display += `<b>${k}</b>: ${m.properties[k]}<br />`);\n        geoShape.bindPopup(display);\n      }\n      geoShape.addTo(this.geoJsonLayer);\n    }\n\n    if (this.pathData.length > 0 || this.positionData.length > 0 || this.geoJson.length > 0) {\n      // Fit map to curves\n      const group = Leaflet.featureGroup([this.geoJsonLayer, this.positionDataLayer, this.pathDataLayer]);\n      this.LOG.debug(['displayMap', 'setView'], 'fitBounds', group.getBounds());\n      this.LOG.debug(['displayMap', 'setView'], {lat: this.currentLat, lng: this.currentLong}, {\n        lat: this._options.map.startLat,\n        lng: this._options.map.startLong\n      });\n      this.bounds = group.getBounds();\n      setTimeout(() => {\n        if (!!this.bounds && this.bounds.isValid()) {\n          if ((this.currentLat || this._options.map.startLat) && (this.currentLong || this._options.map.startLong)) {\n            this.LOG.debug(['displayMap', 'setView'], 'fitBounds', 'already have bounds');\n            this._map.setView({\n                lat: this.currentLat || this._options.map.startLat || 0,\n                lng: this.currentLong || this._options.map.startLong || 0\n              }, this.currentZoom || this._options.map.startZoom || 10,\n              {animate: false, duration: 500});\n          } else {\n            this.LOG.debug(['displayMap', 'setView'], 'fitBounds', 'this.bounds', this.bounds);\n            this._map.fitBounds(this.bounds, {padding: [1, 1], animate: false, duration: 0});\n          }\n          this.currentLat = this._map.getCenter().lat;\n          this.currentLong = this._map.getCenter().lng;\n        } else {\n          this.LOG.debug(['displayMap', 'setView'], 'invalid bounds', {lat: this.currentLat, lng: this.currentLong});\n          this._map.setView({\n              lat: this.currentLat || this._options.map.startLat || 0,\n              lng: this.currentLong || this._options.map.startLong || 0\n            }, this.currentZoom || this._options.map.startZoom || 10,\n            {\n              animate: false,\n              duration: 500\n            });\n        }\n      }, 10);\n    } else {\n      this.LOG.debug(['displayMap', 'lost'], 'lost', this.currentZoom, this._options.map.startZoom);\n      this._map.setView(\n        [\n          this.currentLat || this._options.map.startLat || 0,\n          this.currentLong || this._options.map.startLong || 0\n        ],\n        this.currentZoom || this._options.map.startZoom || 2,\n        {\n          animate: false,\n          duration: 0\n        }\n      );\n    }\n    if (this.heatData && this.heatData.length > 0) {\n      this._heatLayer = (Leaflet as any).heatLayer(this.heatData, {\n        radius: this._options.map.heatRadius,\n        blur: this._options.map.heatBlur,\n        minOpacity: this._options.map.heatOpacity\n      });\n      this._heatLayer.addTo(this._map);\n    }\n    this.firstDraw = false;\n    this.resizeMe();\n    this.patchMapTileGapBug();\n    this.chartDraw.emit(true);\n  }\n\n  private getGTSDots(gts) {\n\n    const dots = [];\n    let icon;\n    let size;\n    switch (gts.render) {\n      case 'marker':\n        icon = this.icon(gts.color, gts.marker);\n        size = (gts.path || []).length;\n        for (let i = 0; i < size; i++) {\n          const g = gts.path[i];\n          const marker = Leaflet.marker(g, {icon, opacity: 1});\n          this.addPopup(gts, g.val, g.ts, marker);\n          dots.push(marker);\n        }\n        break;\n      case 'weightedDots':\n        size = (gts.path || []).length;\n        for (let i = 0; i < size; i++) {\n          const p = gts.path[i];\n          if ((this._hiddenData || []).filter(h => h === gts.key).length === 0) {\n            let v = parseInt(p.val, 10);\n            if (isNaN(v)) {\n              v = 0;\n            }\n            const radius = 50 * v / ((gts.maxValue || 1) - (gts.minValue || 0));\n            const marker = Leaflet.circleMarker(\n              p, {\n                radius: radius === 0 ? 1 : radius,\n                color: gts.borderColor || 'transparent',\n                fillColor: gts.color, fillOpacity: 0.5,\n                weight: 1\n              });\n            this.addPopup(gts, p.val, p.ts, marker);\n            dots.push(marker);\n          }\n        }\n        break;\n      case 'dots':\n      default:\n        size = (gts.path || []).length;\n        for (let i = 0; i < size; i++) {\n          const g = gts.path[i];\n          const marker = Leaflet.circleMarker(\n            g, {\n              radius: gts.baseRadius || MapLib.BASE_RADIUS,\n              color: gts.color,\n              fillColor: gts.color,\n              fillOpacity: 1\n            }\n          );\n          this.addPopup(gts, g.val, g.ts, marker);\n          dots.push(marker);\n        }\n        break;\n    }\n    return dots;\n  }\n\n  private updateGtsPath(gts: any) {\n    const path = MapLib.pathDataToLeaflet(gts.path);\n    const group = Leaflet.featureGroup();\n    if ((path || []).length > 1 && !!gts.line && gts.render === 'dots') {\n      if (!!this._options.map.animate) {\n        group.addLayer(antPath(path || [], {\n          delay: 800, dashArray: [10, 100],\n          weight: 5, color: ColorLib.transparentize(gts.color, 0.5),\n          pulseColor: gts.color,\n          paused: false, reverse: false, hardwareAccelerated: true, hardwareAcceleration: true\n        }));\n      } else {\n        group.addLayer(Leaflet.polyline(path || [], {color: gts.color, opacity: 0.5}));\n      }\n    }\n    const dots = this.getGTSDots(gts);\n    const size = (dots || []).length;\n    for (let i = 0; i < size; i++) {\n      group.addLayer(dots[i]);\n    }\n    this.pathDataLayer.addLayer(group);\n  }\n\n  private addPopup(positionData: any, value: any, ts: any, marker: any) {\n    if (!!positionData) {\n      let date;\n      if (ts && !this._options.timeMode || this._options.timeMode !== 'timestamp') {\n        date = (GTSLib.toISOString(ts, this.divider, this._options.timeZone) || '')\n          .replace('Z', this._options.timeZone === 'UTC' ? 'Z' : '');\n      }\n      let content = '';\n      content = `<p>${date}</p><p><b>${positionData.key}</b>: ${value || 'na'}</p>`;\n      Object.keys(positionData.properties || []).forEach(k => content += `<b>${k}</b>: ${positionData.properties[k]}<br />`);\n      marker.bindPopup(content);\n    }\n  }\n\n  private updatePositionArray(positionData: any) {\n    const group = Leaflet.featureGroup();\n    if ((this._hiddenData || []).filter(h => h === positionData.key).length === 0) {\n      const path = MapLib.updatePositionArrayToLeaflet(positionData.positions);\n      if ((positionData.positions || []).length > 1 && !!positionData.line) {\n        if (!!this._options.map.animate) {\n          group.addLayer(antPath(path || [], {\n            delay: 800, dashArray: [10, 100],\n            weight: 5, color: ColorLib.transparentize(positionData.color, 0.5),\n            pulseColor: positionData.color,\n            paused: false, reverse: false, hardwareAccelerated: true, hardwareAcceleration: true\n          }));\n        } else {\n          group.addLayer(Leaflet.polyline(path || [], {color: positionData.color, opacity: 0.5}));\n        }\n      }\n      let icon;\n      let result;\n      let inStep;\n      let size;\n      this.LOG.debug(['updatePositionArray'], positionData);\n\n      switch (positionData.render) {\n        case 'marker':\n          icon = this.icon(positionData.color, positionData.marker);\n          size = (positionData.positions || []).length;\n          for (let i = 0; i < size; i++) {\n            const p = positionData.positions[i];\n            const marker = Leaflet.marker({lat: p[0], lng: p[1]}, {icon, opacity: 1});\n            this.addPopup(positionData, p[2], undefined, marker);\n            group.addLayer(marker);\n          }\n          this.LOG.debug(['updatePositionArray', 'build marker'], icon);\n          break;\n        case 'coloredWeightedDots':\n          this.LOG.debug(['updatePositionArray', 'coloredWeightedDots'], positionData);\n          result = [];\n          inStep = [];\n          for (let j = 0; j < positionData.numColorSteps; j++) {\n            result[j] = 0;\n            inStep[j] = 0;\n          }\n          size = (positionData.positions || []).length;\n          for (let i = 0; i < size; i++) {\n            const p = positionData.positions[i];\n            const radius = (parseInt(p[2], 10) - (positionData.minValue || 0)) * 50 / (positionData.maxValue || 50);\n\n            this.LOG.debug(['updatePositionArray', 'coloredWeightedDots', 'radius'], positionData.baseRadius * p[4]);\n            const marker = Leaflet.circleMarker(\n              {lat: p[0], lng: p[1]},\n              {\n                radius,\n                color: positionData.borderColor || positionData.color,\n                fillColor: ColorLib.rgb2hex(\n                  positionData.colorGradient[p[5]].r,\n                  positionData.colorGradient[p[5]].g,\n                  positionData.colorGradient[p[5]].b),\n                fillOpacity: 0.3,\n              });\n            this.addPopup(positionData, p[2], undefined, marker);\n            group.addLayer(marker);\n          }\n          break;\n        case 'weightedDots':\n          size = (positionData.positions || []).length;\n          for (let i = 0; i < size; i++) {\n            const p = positionData.positions[i];\n            const radius = (parseInt(p[2], 10) - (positionData.minValue || 0)) * 50 / (positionData.maxValue || 50);\n            const marker = Leaflet.circleMarker(\n              {lat: p[0], lng: p[1]}, {\n                radius,\n                color: positionData.borderColor || positionData.color,\n                fillColor: positionData.color,\n                weight: 2,\n                fillOpacity: 0.3,\n              });\n            this.addPopup(positionData, p[2], undefined, marker);\n            group.addLayer(marker);\n          }\n          break;\n        case 'dots':\n        default:\n          size = (positionData.positions || []).length;\n          for (let i = 0; i < size; i++) {\n            const p = positionData.positions[i];\n            const marker = Leaflet.circleMarker(\n              {lat: p[0], lng: p[1]}, {\n                radius: positionData.baseRadius || MapLib.BASE_RADIUS,\n                color: positionData.borderColor || positionData.color,\n                fillColor: positionData.color,\n                weight: 2,\n                fillOpacity: 0.7,\n              });\n            this.addPopup(positionData, p[2] || 'na', undefined, marker);\n            group.addLayer(marker);\n          }\n          break;\n      }\n    }\n    this.positionDataLayer.addLayer(group);\n  }\n\n  public resize(): Promise<boolean> {\n    return new Promise<boolean>(resolve => {\n      this.resizeMe();\n      resolve(true);\n    });\n  }\n\n  onRangeSliderChange(event) {\n    this.LOG.debug(['onRangeSliderChange'], event);\n    this.timeStart = event.value || moment().valueOf();\n    this.timeEnd = event.highValue || moment().valueOf();\n    this.drawMap(true);\n  }\n\n  onRangeSliderWindowChange(event) {\n    this.LOG.debug(['onRangeSliderWindowChange'], event);\n    if (this.lowerTimeBound !== event.min || this.upperTimeBound !== event.max) {\n      this.lowerTimeBound = event.min;\n      this.upperTimeBound = event.max;\n    }\n  }\n\n  onSliderChange(event) {\n    this.LOG.debug(['onSliderChange'], event, moment(event.value).toISOString());\n    this._firstDraw = false;\n    if (this.timeEnd !== event.value) {\n      this.timeSpan = this.timeSpan || this._options.map.timeSpan;\n      this.timeEnd = event.value || moment().valueOf();\n      this.timeStart = (event.value || moment().valueOf()) - this.timeSpan / this.divider;\n      this.LOG.debug(['onSliderChange'], moment(this.timeStart).toISOString(), moment(this.timeEnd).toISOString());\n      this.change.emit(this.timeStart);\n      this.drawMap(true);\n    }\n  }\n\n  updateTimeSpan(event) {\n    this.LOG.debug(['updateTimeSpan'], event.target.value);\n    if (this.timeSpan !== event.target.value) {\n      this.timeSpan = event.target.value;\n      this.timeStart = (this.timeEnd || moment().valueOf()) - this.timeSpan / this.divider;\n      this.drawMap(true);\n    }\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, EventEmitter, Input, Output, ViewEncapsulation} from '@angular/core';\n\n@Component({\n  selector: 'warpview-heatmap-sliders',\n  templateUrl: './warp-view-heatmap-sliders.component.html',\n  styleUrls: ['./warp-view-heatmap-sliders.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewHeatmapSlidersComponent {\n\n  @Input('radiusValue') radiusValue: number;\n  @Input('minRadiusValue') minRadiusValue: number;\n  @Input('maxRadiusValue') maxRadiusValue: number;\n  @Input('blurValue') blurValue: number;\n  @Input('minBlurValue') minBlurValue: number;\n  @Input('maxBlurValue') maxBlurValue: number;\n\n  @Output('heatRadiusDidChange') heatRadiusDidChange = new EventEmitter<any>();\n  @Output('heatBlurDidChange') heatBlurDidChange = new EventEmitter<any>();\n  @Output('heatOpacityDidChange') heatOpacityDidChange = new EventEmitter<any>();\n\n  radiusChanged(value) {\n    this.heatRadiusDidChange.emit(value);\n  }\n\n  blurChanged(value) {\n    this.heatBlurDidChange.emit(value);\n  }\n\n  opacityChanged(value) {\n    this.heatOpacityDidChange.emit(value);\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, EventEmitter, Input, NgZone, OnInit, Output, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {DataModel} from '../../model/dataModel';\nimport {ColorLib} from '../../utils/color-lib';\nimport deepEqual from 'deep-equal';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {ChartLib} from '../../utils/chart-lib';\nimport {Param} from '../../model/param';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {GTS} from '../../model/GTS';\n\n@Component({\n  selector: 'warpview-pie',\n  templateUrl: './warp-view-pie.component.html',\n  styleUrls: ['./warp-view-pie.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewPieComponent extends WarpViewComponent implements OnInit {\n\n  @Input('type') set type(type: string) {\n    this._type = type;\n    this.drawChart();\n  }\n\n  @Output('chartDraw') chartDraw = new EventEmitter<any>();\n\n  private _type = 'pie';\n  layout: Partial<any> = {\n    showlegend: true,\n    legend: {\n      orientation: 'h',\n      bgcolor: 'transparent',\n    },\n    orientation: 270,\n    margin: {\n      t: 10,\n      b: 25,\n      r: 10,\n      l: 10\n    }\n  };\n\n  update(options, refresh): void {\n    this.LOG.debug(['onOptions', 'before'], this._options, options);\n    if (!deepEqual(options, this._options)) {\n      this.LOG.debug(['options', 'changed'], options);\n      this._options = ChartLib.mergeDeep(this._options, options as Param) as Param;\n    }\n    this.drawChart();\n  }\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewPieComponent, this._debug);\n  }\n\n  ngOnInit(): void {\n    this._options = this._options || this.defOptions;\n  }\n\n  drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.LOG.debug(['drawChart', 'this.layout'], this.layout);\n    this.LOG.debug(['drawChart', 'this.plotlyConfig'], this.plotlyConfig);\n    this.LOG.debug(['drawChart', 'this.plotlyData'], this.plotlyData);\n    this.layout.legend.font = {\n      color: this.getCSSColor(this.el.nativeElement, '--warp-view-font-color', '#000')\n    };\n    this.layout.textfont = {\n      color: this.getCSSColor(this.el.nativeElement, '--warp-view-font-color', '#000')\n    };\n    this.loading = false;\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    const gtsList = GTSLib.flatDeep(data.data as any[]);\n    const plotData = [] as Partial<any>[];\n    this.LOG.debug(['convert', 'gtsList'], gtsList);\n    const pieData = {\n      values: [],\n      labels: [],\n      marker: {\n        colors: [],\n        line: {\n          width: 3,\n          color: [],\n        }\n      },\n      textfont: {\n        color: this.getLabelColor(this.el.nativeElement)\n      },\n      hoverlabel: {\n        bgcolor: this.getCSSColor(this.el.nativeElement, '--warp-view-chart-legend-bg', '#000000'),\n        bordercolor: 'grey',\n        font: {\n          color: this.getCSSColor(this.el.nativeElement, '--warp-view-chart-legend-color', '#ffffff')\n        }\n      },\n      type: 'pie'\n    } as any;\n    const dataList = [];\n    this.LOG.debug(['convert', 'gtsList'], gtsList);\n    if (!gtsList || gtsList.length === 0) {\n      return;\n    }\n    const dataStruct = [];\n    if (GTSLib.isGts(gtsList[0])) {\n      gtsList.forEach((gts: GTS, i) => {\n        const values = (gts.v || []);\n        const val = values[values.length - 1] || [];\n        let value = 0;\n        if (val.length > 0) {\n          value = val[val.length - 1];\n        }\n        dataStruct.push({\n          key: GTSLib.serializeGtsMetadata(gts),\n          value\n        });\n      });\n    } else {\n      // custom data format\n      gtsList.forEach((gts, i) => {\n        dataStruct.push({\n          key: gts.key || '',\n          value: gts.value || Number.MIN_VALUE\n        });\n      });\n    }\n    this.LOG.debug(['convert', 'dataStruct'], dataStruct);\n    dataStruct.forEach((d: any, i) => {\n        const c = ColorLib.getColor(i, this._options.scheme);\n        const color = ((data.params || [])[i] || {datasetColor: c}).datasetColor || c;\n        pieData.values.push(d.value);\n        pieData.labels.push(d.key);\n        pieData.marker.colors.push(ColorLib.transparentize(color));\n        pieData.marker.line.color.push(color);\n        if (this._type === 'donut') {\n          pieData.hole = 0.5;\n        }\n        if (this.unit) {\n          pieData.title = {\n            text: this.unit\n          };\n        }\n    });\n    if (pieData.values.length > 0) {\n      plotData.push(pieData);\n    }\n    this.noData = plotData.length === 0;\n    return plotData;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, Input, NgZone, OnInit, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {DataModel} from '../../model/dataModel';\nimport gauge from 'canvas-gauges';\nimport {ColorLib} from '../../utils/color-lib';\nimport deepEqual from 'deep-equal';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {ChartLib} from '../../utils/chart-lib';\nimport {Param} from '../../model/param';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {GTS} from '../../model/GTS';\n\n@Component({\n  selector: 'warpview-gauge',\n  templateUrl: './warp-view-gauge.component.html',\n  styleUrls: ['./warp-view-gauge.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewGaugeComponent extends WarpViewComponent implements OnInit {\n  @Input('type') set type(type: string) {\n    this._type = type;\n    this.drawChart();\n  }\n\n  private CHART_MARGIN = 0.05;\n  private lineHeight = 50;\n  // tslint:disable-next-line:variable-name\n  private _type = 'gauge'; // gauge or bullet\n  layout: Partial<any> = {\n    showlegend: false,\n    autosize: false,\n    autoexpand: false,\n    margin: {\n      t: 10,\n      b: 2,\n      r: 10,\n      l: 10\n    },\n  };\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewGaugeComponent, this._debug);\n  }\n\n  ngOnInit(): void {\n    this._options = this._options || this.defOptions;\n  }\n\n  update(options, refresh): void {\n    this.LOG.debug(['onOptions', 'before'], this._options, options);\n    if (!deepEqual(options, this._options)) {\n      this.LOG.debug(['options', 'changed'], options);\n      this._options = ChartLib.mergeDeep(this._options, options as Param) as Param;\n    }\n    this.drawChart();\n  }\n\n  drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this._autoResize = this._type !== 'bullet';\n    this.LOG.debug(['drawChart', 'plotlyData'], this.plotlyData, this._type);\n    // this.layout.autosize = true;\n    this.layout.grid = {\n      rows: Math.ceil(this.plotlyData.length / 2),\n      columns: 2,\n      pattern: 'independent',\n      xgap: 0.2,\n      ygap: 0.2\n    };\n    this.layout.margin = {t: 25, r: 25, l: 25, b: 25};\n    if (this._type === 'bullet') {\n      this.layout.height = 100;\n      this.layout.yaxis = {\n        automargin: true\n      };\n      this.layout.grid = {rows: this.plotlyData.length, columns: 1, pattern: 'independent', ygap: 0.5};\n      const count = this.plotlyData.length;\n      let calculatedHeight = this.lineHeight * count + this.layout.margin.t + this.layout.margin.b;\n      calculatedHeight += this.layout.grid.ygap * calculatedHeight;\n      this.el.nativeElement.style.height = calculatedHeight + 'px';\n      (this.el.nativeElement as HTMLDivElement).style.height = calculatedHeight + 'px';\n      this.height = calculatedHeight;\n      this.layout.height = this.height;\n      this.layout.autosize = false;\n    }\n    this.loading = false;\n  }\n\n  protected convert(data: DataModel): any[] {\n    this.LOG.debug(['convert'], data);\n    let gtsList = data.data as any[];\n    const dataList = [];\n    let overallMax = this._options.maxValue || Number.MIN_VALUE;\n    this.LOG.debug(['convert', 'gtsList'], gtsList);\n    if (!gtsList || gtsList.length === 0) {\n      return;\n    }\n    gtsList = GTSLib.flatDeep(gtsList);\n    let dataStruct = [];\n    if (GTSLib.isGts(gtsList[0])) {\n      gtsList.forEach((gts: GTS, i) => {\n        let max: number = Number.MIN_VALUE;\n        const values = (gts.v || []);\n        const val = values[values.length - 1] || [];\n        let value = 0;\n        if (val.length > 0) {\n          value = val[val.length - 1];\n        }\n        if (!!data.params && !!data.params[i] && !!data.params[i].maxValue) {\n          max = data.params[i].maxValue;\n        } else {\n          if (overallMax < value) {\n            overallMax = value;\n          }\n        }\n        dataStruct.push({\n          key: GTSLib.serializeGtsMetadata(gts),\n          value,\n          max\n        });\n      });\n    } else {\n      // custom data format\n      gtsList.forEach((gts, i) => {\n        let max: number = Number.MIN_VALUE;\n        if (!!data.params && !!data.params[i] && !!data.params[i].maxValue) {\n          max = data.params[i].maxValue;\n        } else {\n          if (overallMax < gts.value || Number.MIN_VALUE) {\n            overallMax = gts.value || Number.MIN_VALUE;\n          }\n        }\n        dataStruct.push({\n          key: gts.key || '',\n          value: gts.value || Number.MIN_VALUE,\n          max\n        });\n      });\n    }\n    //  dataStruct.reverse();\n    this.LOG.debug(['convert', 'dataStruct'], dataStruct);\n    this.layout.annotations = [];\n    let count = Math.ceil(dataStruct.length / 2);\n    if (this._type === 'bullet') {\n      count = dataStruct.length;\n    }\n    const itemHeight = 1 / count;\n    let x = 0;\n    let y = -1 * itemHeight;\n\n    if (this._type === 'bullet') {\n      y = this.CHART_MARGIN;\n    }\n    dataStruct.forEach((gts, i) => {\n      if (this._type === 'bullet') {\n        y += itemHeight;\n      } else {\n        if (i % 2 === 0) {\n          y += itemHeight;\n          x = 0;\n        } else {\n          x = 0.5;\n        }\n      }\n      const c = ColorLib.getColor(i, this._options.scheme);\n      const color = ((data.params || [])[i] || {datasetColor: c}).datasetColor || c;\n      const domain = dataStruct.length > 1 ? {\n        x: [x + this.CHART_MARGIN, x + 0.5 - this.CHART_MARGIN],\n        y: [y - itemHeight + this.CHART_MARGIN, y - this.CHART_MARGIN]\n      } : {\n        x: [0, 1],\n        y: [0, 1]\n      };\n      if (this._type === 'bullet') {\n        domain.x = [0, 1];\n        domain.y = [y - itemHeight + this.CHART_MARGIN * 2, y - this.CHART_MARGIN * 2];\n        // domain.y = [(i > 0 ? i / dataStruct.length : 0) + this.CHART_MARGIN * 2, (i + 1) / dataStruct.length - this.CHART_MARGIN * 2];\n        this.layout.annotations.push({\n          xref: 'x domain',\n          yref: 'y domain',\n          x: 0,\n          xanchor: 'left',\n          y: (i + 1) / count + this.CHART_MARGIN,\n          yanchor: 'top',\n          text: gts.key,\n          showarrow: false,\n          align: 'left',\n          font: {\n            size: 14,\n            color: this.getLabelColor(this.el.nativeElement)\n          }\n        });\n      }\n      dataList.push(\n        {\n          domain,\n          align: 'left',\n          value: gts.value,\n          delta: {\n            reference: !!data.params && !!data.params[i] && !!data.params[i].delta ? data.params[i].delta + gts.value : 0,\n            font: {color: this.getLabelColor(this.el.nativeElement)}\n          },\n          title: {\n            text: this._type === 'bullet'\n            || (!!data.params && !!data.params[i] && !!data.params[i].type && data.params[i].type === 'bullet') ? '' : gts.key,\n            align: 'center',\n            font: {color: this.getLabelColor(this.el.nativeElement)}\n          },\n          number: {\n            font: {color: this.getLabelColor(this.el.nativeElement)}\n          },\n          type: 'indicator',\n          mode: !!data.params && !!data.params[i] && !!data.params[i].delta ? 'number+delta+gauge' : 'gauge+number',\n          gauge: {\n            bgcolor: 'transparent',\n            shape: !!data.params && !!data.params[i] && !!data.params[i].type ? data.params[i].type : this._type || 'gauge',\n            bordercolor: this.getGridColor(this.el.nativeElement),\n            axis: {\n              range: [null, overallMax === Number.MIN_VALUE ? gts.max : overallMax],\n              tickcolor: this.getGridColor(this.el.nativeElement),\n              tickfont: {color: this.getGridColor(this.el.nativeElement)}\n            },\n            bar: {\n              color: ColorLib.transparentize(color),\n              thickness: 1,\n              line: {\n                width: 1,\n                color\n              }\n            }\n          }\n        });\n      this.LOG.debug(['convert', 'dataList'], i);\n    });\n    this.LOG.debug(['convert', 'dataList'], dataList);\n    return dataList;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, EventEmitter, HostListener, Input, NgZone, Output, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {Param} from '../../model/param';\nimport {ChartLib} from '../../utils/chart-lib';\nimport moment from 'moment-timezone';\nimport {DataModel} from '../../model/dataModel';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {GTS} from '../../model/GTS';\nimport {ColorLib} from '../../utils/color-lib';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {ChartBounds} from '../../model/chartBounds';\n\n@Component({\n  selector: 'warpview-annotation',\n  templateUrl: './warp-view-annotation.component.html',\n  styleUrls: ['./warp-view-annotation.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewAnnotationComponent extends WarpViewComponent {\n\n  @Input('hiddenData') set hiddenData(hiddenData: number[]) {\n    const previousVisibility = JSON.stringify(this.visibility);\n    this.LOG.debug(['hiddenData', 'previousVisibility'], previousVisibility);\n    this._hiddenData = hiddenData;\n    this.visibility = [];\n    this.visibleGtsId.forEach(id => this.visibility.push(hiddenData.indexOf(id) < 0 && (id !== -1)));\n    this.LOG.debug(['hiddenData', 'hiddendygraphfullv'], this.visibility);\n    const newVisibility = JSON.stringify(this.visibility);\n    this.LOG.debug(['hiddenData', 'json'], previousVisibility, newVisibility);\n    if (previousVisibility !== newVisibility) {\n      const visible = [];\n      const hidden = [];\n      this.gtsId.forEach((id, i) => {\n        if (this._hiddenData.indexOf(id) > -1) {\n          hidden.push(i);\n        } else {\n          visible.push(i);\n        }\n      });\n      if (visible.length > 0) {\n        this.graph.restyleChart({visible: true}, visible);\n      }\n      if (hidden.length > 0) {\n        this.graph.restyleChart({visible: false}, hidden);\n      }\n      this.LOG.debug(['hiddendygraphtrig', 'destroy'], 'redraw by visibility change');\n    }\n  }\n\n  @Input('type') set type(type: string) {\n    this._type = type;\n    this.drawChart();\n  }\n\n  @Input('standalone') set standalone(isStandalone: boolean) {\n    if (this._standalone !== isStandalone) {\n      this._standalone = isStandalone;\n      this.drawChart();\n    }\n  }\n\n  get standalone(): boolean {\n    return this._standalone;\n  }\n\n  @Output('pointHover') pointHover = new EventEmitter<any>();\n  @Output('chartDraw') chartDraw = new EventEmitter<any>();\n  @Output('boundsDidChange') boundsDidChange = new EventEmitter<any>();\n\n  displayExpander = true;\n  layout: Partial<any> = {\n    showlegend: false,\n    hovermode: 'closest',\n    xaxis: {\n      gridwidth: 1,\n      fixedrange: false,\n      autorange: false,\n      automargin: false,\n      showticklabels: true,\n      showgrid: false\n    },\n    autosize: false,\n    autoexpand: false,\n    yaxis: {\n      showticklabels: false,\n      fixedrange: true,\n      dtick: 1,\n      gridwidth: 1,\n      tick0: 0,\n      nticks: 2,\n      rangemode: 'tozero',\n      tickson: 'boundaries',\n      automargin: true,\n      showline: false,\n      zeroline: true\n    },\n    margin: {\n      t: 30,\n      b: 2,\n      r: 10,\n      l: 10\n    },\n  };\n  marginLeft = 50;\n  expanded = false;\n  // tslint:disable-next-line:variable-name\n  private _type = 'line';\n  private visibility: boolean[] = [];\n  private _standalone = true;\n  private trimmed;\n  private maxTick = Number.MIN_VALUE;\n  private minTick = Number.MAX_VALUE;\n  private visibleGtsId = [];\n  private gtsId = [];\n  private dataHashset = {};\n  private lineHeight = 30;\n  private chartBounds: ChartBounds = new ChartBounds();\n\n  @HostListener('keydown', ['$event'])\n  @HostListener('document:keydown', ['$event'])\n  handleKeyDown($event: KeyboardEvent) {\n    if ($event.key === 'Control') {\n      this.trimmed = setInterval(() => {\n        if (!!this.toolTip.nativeElement.querySelector('#tooltip-body')) {\n          this.toolTip.nativeElement.querySelector('#tooltip-body').classList.add('full');\n        }\n      }, 100);\n    }\n  }\n\n  @HostListener('keyup', ['$event'])\n  @HostListener('document:keyup', ['$event'])\n  handleKeyup($event: KeyboardEvent) {\n    this.LOG.debug(['document:keyup'], $event);\n    if ($event.key === 'Control') {\n      if (!!this.toolTip.nativeElement.querySelector('#tooltip-body')) {\n        if (this.trimmed) {\n          clearInterval(this.trimmed);\n        }\n        this.toolTip.nativeElement.querySelector('#tooltip-body').classList.remove('full');\n      }\n    }\n  }\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this._autoResize = false;\n    this.LOG = new Logger(WarpViewAnnotationComponent, this._debug);\n  }\n\n  update(options: Param, refresh: boolean): void {\n    if (!!options) {\n      this._options = ChartLib.mergeDeep(this._options, options) as Param;\n    }\n    this.drawChart(refresh);\n  }\n\n  updateBounds(min, max, marginLeft) {\n    this.LOG.debug(['updateBounds'], min, max, this._options);\n    this._options.bounds.minDate = min;\n    this._options.bounds.maxDate = max;\n    this.layout.xaxis.autorange = false;\n    this.LOG.debug(['updateBounds'], GTSLib.toISOString(min, this.divider, this._options.timeZone),\n      GTSLib.toISOString(max, this.divider, this._options.timeZone));\n    this.minTick = min;\n    this.maxTick = max;\n    if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n      this.layout.xaxis.tick0 = min / this.divider;\n      this.layout.xaxis.range = [min / this.divider, max / this.divider];\n    } else {\n      this.layout.xaxis.tick0 = GTSLib.toISOString(min, this.divider, this._options.timeZone);\n      this.layout.xaxis.range = [\n        GTSLib.toISOString(min, this.divider, this._options.timeZone),\n        GTSLib.toISOString(max, this.divider, this._options.timeZone)\n      ];\n    }\n    this.layout.margin.l = marginLeft;\n    this.marginLeft = marginLeft;\n    this.layout = {...this.layout};\n    this.LOG.debug(['updateBounds'], {...this.layout.xaxis.range});\n  }\n\n  drawChart(reparseNewData: boolean = false) {\n    this.layout.margin.l = !!this._standalone ? 10 : 50;\n    this.layout.margin.b = !!this._standalone ? 50 : 1;\n    this.height = this.lineHeight + this.layout.margin.t + this.layout.margin.b;\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.el.nativeElement.style.display = 'block';\n    this.LOG.debug(['drawChart', 'this.plotlyData'], this.plotlyData);\n    this.LOG.debug(['drawChart', 'hiddenData'], this._hiddenData);\n    this.LOG.debug(['drawChart', 'this._options.bounds'], this._options.bounds);\n    this.layout.yaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.yaxis.gridcolor = this.getGridColor(this.el.nativeElement);\n    this.layout.yaxis.showline = !!this._standalone;\n    this.layout.yaxis.zerolinecolor = this.getGridColor(this.el.nativeElement);\n    this.layout.xaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.xaxis.gridcolor = this.getGridColor(this.el.nativeElement);\n    this.layout.xaxis.autorange = !!this._standalone;\n    this.layout.xaxis.showticklabels = !!this._standalone;\n    this.displayExpander = (this.plotlyData.length > 1);\n    const count = this.plotlyData.filter(d => d.y.length > 0).length;\n    const calculatedHeight = (this.expanded ? this.lineHeight * count : this.lineHeight) + this.layout.margin.t + this.layout.margin.b;\n    this.el.nativeElement.style.height = calculatedHeight + 'px';\n    this.height = calculatedHeight;\n    this.layout.height = this.height;\n    this.LOG.debug(['drawChart', 'height'], this.height, count, calculatedHeight, this.expanded);\n    this.layout.yaxis.range = [0, this.expanded ? count : 1];\n    this.LOG.debug(['drawChart', 'this.layout'], this.layout);\n    if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n      this.layout.xaxis.tick0 = this.minTick;\n      this.layout.xaxis.range = [this.minTick, this.maxTick];\n      this.layout.xaxis.type = 'linear';\n    } else {\n      this.layout.xaxis.tick0 =\n        GTSLib.toISOString(this.minTick, this.divider, this._options.timeZone);\n      this.layout.xaxis.range = [\n        GTSLib.toISOString(this.minTick, this.divider, this._options.timeZone),\n        GTSLib.toISOString(this.maxTick, this.divider, this._options.timeZone)\n      ];\n      this.layout.xaxis.type = 'date';\n    }\n    this.plotlyConfig.scrollZoom = true;\n    this.layout.xaxis.showgrid = false;\n    setTimeout(() => {\n      this.plotlyConfig = {...this.plotlyConfig};\n      this.layout = {...this.layout};\n      this.loading = false;\n    });\n    this.LOG.debug(['drawChart', 'this.plotlyConfig'], this.plotlyConfig, this.plotlyData);\n  }\n\n  relayout(data: any) {\n    if (data['xaxis.range'] && data['xaxis.range'].length === 2) {\n      this.LOG.debug(['relayout', 'updateBounds', 'xaxis.range'], data['xaxis.range']);\n      this.chartBounds.msmin = data['xaxis.range'][0];\n      this.chartBounds.msmax = data['xaxis.range'][1];\n      this.chartBounds.tsmin = moment.tz(moment(this.chartBounds.msmin), this._options.timeZone).valueOf();\n      this.chartBounds.tsmax = moment.tz(moment(this.chartBounds.msmax), this._options.timeZone).valueOf();\n    } else if (data['xaxis.range[0]'] && data['xaxis.range[1]']) {\n      this.LOG.debug(['relayout', 'updateBounds', 'xaxis.range[x]'], data['xaxis.range[0]']);\n      this.chartBounds.msmin = data['xaxis.range[0]'];\n      this.chartBounds.msmax = data['xaxis.range[1]'];\n      this.chartBounds.tsmin = moment.tz(moment(this.chartBounds.msmin), this._options.timeZone).valueOf();\n      this.chartBounds.tsmax = moment.tz(moment(this.chartBounds.msmax), this._options.timeZone).valueOf();\n    } else if (data['xaxis.autorange']) {\n      this.LOG.debug(['relayout', 'updateBounds', 'autorange'], data);\n      this.chartBounds.tsmin = this.minTick / this.divider;\n      this.chartBounds.tsmax = this.maxTick / this.divider;\n    }\n    this.emitNewBounds(moment.utc(this.chartBounds.tsmin).valueOf(), moment.utc(this.chartBounds.msmax).valueOf());\n  }\n\n  hover(data: any) {\n    this.LOG.debug(['hover'], data);\n    const tooltip = this.toolTip.nativeElement;\n    this.pointHover.emit({\n      x: data.event.offsetX,\n      y: data.event.offsetY\n    });\n    let x = data.xvals[0];\n    if (!!data.points[0]) {\n      x = data.points[0].x;\n    }\n    const layout = this.el.nativeElement.getBoundingClientRect();\n    const count = this.plotlyData.filter(d => d.y.length > 0).length;\n    tooltip.style.opacity = '1';\n    tooltip.style.display = 'block';\n    tooltip.style.paddingLeft = (this._standalone ? 0 : 40) + 'px';\n    tooltip.style.top = (\n      (this.expanded ? count - 1 - (data.points[0].y + 0.5) : -1) * (this.lineHeight) + this.layout.margin.t\n    ) + 6 + 'px';\n    tooltip.classList.remove('right', 'left');\n    tooltip.innerHTML = `<div class=\"tooltip-body trimmed\" id=\"tooltip-body\">\n<span class=\"tooltip-date\">${this._options.timeMode === 'timestamp'\n      ? x\n      : (moment.utc(x).toISOString().replace('Z', this._options.timeZone === 'UTC' ? 'Z' : '') || '')}</span>\n<ul>\n<li>${GTSLib.formatLabel(data.points[0].data.name)}: <span class=\"value\">${data.points[0].text}</span></li>\n</ul>\n      </div>`;\n    if (data.event.offsetX > layout.width / 2) {\n      tooltip.classList.add('left');\n    } else {\n      tooltip.classList.add('right');\n    }\n    tooltip.style.pointerEvents = 'none';\n  }\n\n  unhover() {\n    this.toolTip.nativeElement.style.display = 'none';\n  }\n\n  afterPlot(div) {\n    this.loading = false;\n    this.chartBounds.tsmin = this.minTick;\n    this.chartBounds.tsmax = this.maxTick;\n    this.chartDraw.emit(this.chartBounds);\n    this.LOG.debug(['afterPlot'], this.chartBounds, div);\n  }\n\n  private emitNewBounds(min, max) {\n    if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n      this.boundsDidChange.emit({bounds: {min, max}, source: 'annotation'});\n    } else {\n      this.boundsDidChange.emit({\n        bounds: {\n          min: moment.tz(min, this._options.timeZone).valueOf(),\n          max: moment.tz(max, this._options.timeZone).valueOf()\n        },\n        source: 'annotation'\n      });\n    }\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    const dataset: Partial<any>[] = [];\n    let gtsList = GTSLib.flatDeep(GTSLib.flattenGtsIdArray(data.data as any[], 0).res);\n    this.maxTick = Number.NEGATIVE_INFINITY;\n    this.minTick = Number.POSITIVE_INFINITY;\n    this.visibleGtsId = [];\n    this.gtsId = [];\n    const nonPlottable = gtsList.filter(g => g.v && GTSLib.isGtsToPlot(g));\n    gtsList = gtsList.filter(g => g.v && !GTSLib.isGtsToPlot(g));\n    let timestampMode = true;\n    const tsLimit = 100 * GTSLib.getDivider(this._options.timeUnit);\n    gtsList.forEach((gts: GTS) => {\n      const ticks = gts.v.map(t => t[0]);\n      const size = gts.v.length;\n      timestampMode = timestampMode && (ticks[0] > -tsLimit && ticks[0] < tsLimit);\n      timestampMode = timestampMode && (ticks[size - 1] > -tsLimit && ticks[size - 1] < tsLimit);\n    });\n    if (timestampMode || this._options.timeMode === 'timestamp') {\n      this.layout.xaxis.type = 'linear';\n    } else {\n      this.layout.xaxis.type = 'date';\n    }\n    gtsList.forEach((gts: GTS, i) => {\n      if (gts.v) {\n        const size = gts.v.length;\n        const label = GTSLib.serializeGtsMetadata(gts);\n        const c = ColorLib.getColor(gts.id, this._options.scheme);\n        const color = ((data.params || [])[i] || {datasetColor: c}).datasetColor || c;\n        const series: Partial<any> = {\n          type: 'scattergl',\n          mode: 'markers',\n          name: label,\n          x: [],\n          y: [],\n          text: [],\n          hoverinfo: 'none',\n          connectgaps: false,\n          visible: !(this._hiddenData.filter(h => h === gts.id).length > 0),\n          line: {color},\n          marker: {\n            symbol: 'line-ns-open',\n            color,\n            size: 20,\n            width: 5,\n          }\n        };\n        this.visibleGtsId.push(gts.id);\n        this.gtsId.push(gts.id);\n        if (timestampMode || this._options.timeMode && this._options.timeMode === 'timestamp') {\n          this.layout.xaxis.type = 'linear';\n        } else {\n          this.layout.xaxis.type = 'date';\n        }\n        const ticks = [];\n        series.text = [];\n        series.y = [];\n        if (size > 0) {\n          this.minTick = gts.v[0][0];\n          this.maxTick = gts.v[0][0];\n          for (let v = 0; v < size; v++) {\n            const val = gts.v[v];\n            const t = val[0];\n            ticks.push(t);\n            series.text.push(val[val.length - 1]);\n            series.y.push((this.expanded ? i : 0) + 0.5);\n            this.minTick = (t < this.minTick) ? t : this.minTick;\n            this.maxTick = (t > this.maxTick) ? t : this.maxTick;\n          }\n        }\n        if (timestampMode || this._options.timeMode === 'timestamp') {\n          series.x = ticks;\n        } else {\n          series.x = ticks.map(t => GTSLib.toISOString(t, this.divider, this._options.timeZone));\n        }\n        if (series.x.length > 0) {\n          dataset.push(series);\n        }\n      }\n    });\n    this.LOG.debug(['convert'], 'forEach value end', this.minTick, this.maxTick);\n    if (nonPlottable.length > 0) {\n      nonPlottable.forEach(g => {\n        g.v.forEach(value => {\n          const ts = value[0];\n          if (ts < this.minTick) {\n            this.minTick = ts;\n          }\n          if (ts > this.maxTick) {\n            this.maxTick = ts;\n          }\n        });\n      });\n      // if there is not any plottable data, we must add a fake one with id -1. This one will always be hidden.\n      if (0 === gtsList.length) {\n        if (!this.dataHashset[this.minTick]) {\n          this.dataHashset[this.minTick] = [0];\n        }\n        if (!this.dataHashset[this.maxTick]) {\n          this.dataHashset[this.maxTick] = [0];\n        }\n        this.visibility.push(false);\n        this.visibleGtsId.push(-1);\n      }\n    }\n    const x = {tick0: undefined, range: []};\n    if (timestampMode || this._options.timeMode && this._options.timeMode === 'timestamp') {\n      x.tick0 = this.minTick;\n      x.range = [this.minTick, this.maxTick];\n    } else {\n      x.tick0 = GTSLib.toISOString(this.minTick, this.divider, this._options.timeZone);\n      x.range = [\n        GTSLib.toISOString(this.minTick, this.divider, this._options.timeZone),\n        GTSLib.toISOString(this.maxTick, this.divider, this._options.timeZone)\n      ];\n    }\n    this.layout.xaxis = x;\n    this.noData = dataset.length === 0;\n    return dataset;\n  }\n\n  toggle() {\n    this.expanded = !this.expanded;\n    this.drawChart();\n  }\n\n  setRealBounds(chartBounds: ChartBounds) {\n    this.minTick = chartBounds.tsmin;\n    this.maxTick = chartBounds.tsmax;\n    this._options.bounds = this._options.bounds || {};\n    this._options.bounds.minDate = this.minTick;\n    this._options.bounds.maxDate = this.maxTick;\n    const x: any = {\n      tick0: undefined,\n      range: [],\n    };\n    if (this._options.showRangeSelector) {\n      x.rangeslider = {\n        bgcolor: 'transparent',\n        thickness: 40 / this.height\n      };\n    }\n    if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n      x.tick0 = this.minTick / this.divider;\n      x.range = [this.minTick, this.maxTick];\n    } else {\n      x.tick0 = GTSLib.toISOString(this.minTick, this.divider, this._options.timeZone);\n      x.range = [\n        GTSLib.toISOString(this.minTick, this.divider, this._options.timeZone),\n        GTSLib.toISOString(this.maxTick, this.divider, this._options.timeZone)\n      ];\n    }\n    this.layout.xaxis = x;\n    this.layout = {...this.layout};\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, NgZone, OnInit, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {DataModel} from '../../model/dataModel';\nimport {ColorLib} from '../../utils/color-lib';\nimport {GTS} from '../../model/GTS';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport deepEqual from 'deep-equal';\nimport {ChartLib} from '../../utils/chart-lib';\nimport {Param} from '../../model/param';\n\n@Component({\n  selector: 'warpview-polar',\n  templateUrl: './warp-view-polar.component.html',\n  styleUrls: ['./warp-view-polar.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\n/**\n *\n */\nexport class WarpViewPolarComponent extends WarpViewComponent implements OnInit {\n  layout: Partial<any> = {\n    paper_bgcolor: 'rgba(0,0,0,0)',\n    showlegend: true,\n    legend: {orientation: 'h'},\n    font: {size: 12, familly: '\\'Quicksand\\', sans-serif'},\n    polar: {\n      bgcolor: 'rgba(0,0,0,0)',\n      angularaxis: {\n        type: 'category'\n      },\n      radialaxis: {\n        visible: true,\n      }\n    },\n    orientation: 270,\n    margin: {\n      t: 10,\n      b: 25,\n      r: 10,\n      l: 10\n    }\n  };\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewPolarComponent, this._debug);\n  }\n\n  update(options, refresh): void {\n    this.LOG.debug(['onOptions', 'before'], this._options, options);\n    if (!deepEqual(options, this._options)) {\n      this.LOG.debug(['options', 'changed'], options);\n      this._options = ChartLib.mergeDeep(this._options, options as Param) as Param;\n    }\n    this.drawChart();\n  }\n\n  ngOnInit(): void {\n    this._options = this._options || this.defOptions;\n  }\n\n  private drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.layout.polar.radialaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.polar.angularaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.showlegend = !!this.showLegend;\n    this.LOG.debug(['drawChart', 'this.layout'], this.layout);\n    this.LOG.debug(['drawChart', 'this.plotlyConfig'], this.plotlyConfig);\n    this.LOG.debug(['drawChart', 'this.plotlyData'], this.plotlyData);\n    this.loading = false;\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    const dataset: Partial<any>[] = [];\n    const divider = GTSLib.getDivider(this._options.timeUnit);\n    const gtsList = GTSLib.flatDeep(GTSLib.flattenGtsIdArray(data.data as any[], 0).res);\n    this.LOG.debug(['convert', 'gtsList'], gtsList);\n    let minVal = Number.MAX_VALUE;\n    let maxVal = Number.MIN_VALUE;\n    gtsList.forEach((gts: GTS, i) => {\n      const c = ColorLib.getColor(i, this._options.scheme);\n      const color = ((data.params || [])[gts.id] || {datasetColor: c}).datasetColor || c;\n      const series: any = {\n        r: [],\n        theta: [],\n        marker: {\n          line: {color, width: 1},\n          color: ColorLib.transparentize(color),\n        },\n        fillcolor: ColorLib.transparentize(color),\n        hoverinfo: 'none',\n        name: GTSLib.serializeGtsMetadata(gts),\n        text: GTSLib.serializeGtsMetadata(gts),\n        fill: 'toself',\n        type: 'barpolar',\n      };\n      gts.v.forEach(value => {\n        const ts = value[0];\n        minVal = Math.min(minVal, value[value.length - 1]);\n        maxVal = Math.max(maxVal, value[value.length - 1]);\n        series.r.push(value[value.length - 1]);\n        if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n          series.theta.push(ts.toString());\n        } else {\n          series.theta.push(GTSLib.toISOString(ts, this.divider, this._options.timeZone));\n        }\n      });\n      if (this.unit) {\n        series.title = {\n          text: this.unit\n        };\n      }\n      dataset.push(series);\n    });\n    this.layout.polar.radialaxis.range = [minVal, maxVal];\n    return dataset;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, NgZone, OnInit, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {DataModel} from '../../model/dataModel';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {GTS} from '../../model/GTS';\nimport {ColorLib} from '../../utils/color-lib';\nimport deepEqual from 'deep-equal';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {ChartLib} from '../../utils/chart-lib';\nimport {Param} from '../../model/param';\n\n@Component({\n  selector: 'warpview-radar',\n  templateUrl: './warp-view-radar.component.html',\n  styleUrls: ['./warp-view-radar.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\n/**\n *\n */\nexport class WarpViewRadarComponent extends WarpViewComponent implements OnInit {\n\n  layout: Partial<any> = {\n    paper_bgcolor: 'transparent',\n    showlegend: true,\n    legend: {orientation: 'h'},\n    font: {size: 12},\n    polar: {\n      bgcolor: 'transparent',\n      angularaxis: {type: 'category'},\n      radialaxis: {visible: true}\n    },\n    margin: {\n      t: 0,\n      b: 25,\n      r: 10,\n      l: 10\n    }\n  };\n\n  update(options, refresh): void {\n    this.LOG.debug(['onOptions', 'before'], this._options, options);\n    if (!deepEqual(options, this._options)) {\n      this.LOG.debug(['options', 'changed'], options);\n      this._options = ChartLib.mergeDeep(this._options, options as Param) as Param;\n    }\n    this.drawChart();\n  }\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewRadarComponent, this._debug);\n  }\n\n  ngOnInit(): void {\n    this._options = this._options || this.defOptions;\n  }\n\n  private drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.layout.polar.radialaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.polar.angularaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.showlegend = this.showLegend;\n    this.LOG.debug(['drawChart', 'this.layout'], this.layout);\n    this.LOG.debug(['drawChart', 'this.plotlyConfig'], this.plotlyConfig);\n    this.LOG.debug(['drawChart', 'this.plotlyData'], this.plotlyData);\n    this.loading = false;\n  }\n\n  protected convert(data: DataModel): any[] {\n    const dataset: any[] = [];\n    const divider = GTSLib.getDivider(this._options.timeUnit);\n    const gtsList = GTSLib.flatDeep(GTSLib.flattenGtsIdArray(data.data as any[], 0).res);\n    this.LOG.debug(['convert', 'gtsList'], gtsList);\n    let minVal = Number.MAX_VALUE;\n    let maxVal = Number.MIN_VALUE;\n    gtsList.forEach((gts: GTS, i) => {\n      const c = ColorLib.getColor(i, this._options.scheme);\n      const color = ((data.params || [])[gts.id] || {datasetColor: c}).datasetColor || c;\n      const series: any = {\n        r: [],\n        theta: [],\n        line: {color},\n        marker: {\n          line: {color, width: 1},\n          color: ColorLib.transparentize(color)\n        },\n        fillcolor: ColorLib.transparentize(color),\n        hoverinfo: 'none',\n        name: GTSLib.serializeGtsMetadata(gts),\n        text: GTSLib.serializeGtsMetadata(gts),\n        type: 'scatterpolar',\n        fill: 'toself'\n      };\n      gts.v.forEach(value => {\n        const ts = value[0];\n        series.r.push(value[value.length - 1]);\n        minVal = Math.min(minVal, value[value.length - 1]);\n        maxVal = Math.max(maxVal, value[value.length - 1]);\n        if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n          series.theta.push(ts.toString());\n        } else {\n          series.theta.push(GTSLib.toISOString(ts, this.divider, this._options.timeZone));\n        }\n      });\n      dataset.push(series);\n    });\n    this.layout.polar.radialaxis.range = [minVal, maxVal];\n    return dataset;\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {\n  AfterViewInit,\n  Component,\n  ElementRef,\n  EventEmitter,\n  HostListener,\n  Input,\n  NgZone,\n  OnInit,\n  Output,\n  Renderer2,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {WarpViewModalComponent} from '../warp-view-modal/warp-view-modal.component';\nimport {Param} from '../../model/param';\nimport {WarpViewChartComponent} from '../warp-view-chart/warp-view-chart.component';\nimport {WarpViewAnnotationComponent} from '../warp-view-annotation/warp-view-annotation.component';\nimport {WarpViewMapComponent} from '../warp-view-map/warp-view-map.component';\nimport {WarpViewGtsPopupComponent} from '../warp-view-gts-popup/warp-view-gts-popup.component';\nimport {ChartBounds} from '../../model/chartBounds';\nimport moment from 'moment-timezone';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {GTS} from '../../model/GTS';\nimport {DataModel} from '../../model/dataModel';\nimport {Size, SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-plot',\n  templateUrl: './warp-view-plot.component.html',\n  styleUrls: ['./warp-view-plot.component.scss'],\n  encapsulation: ViewEncapsulation.None\n})\nexport class WarpViewPlotComponent extends WarpViewComponent implements OnInit, AfterViewInit {\n  @ViewChild('mainPlotDiv', {static: true}) mainPlotDiv: ElementRef;\n  @ViewChild('timeClip', {static: true}) timeClip: WarpViewModalComponent;\n  @ViewChild('modal', {static: true}) modal: WarpViewModalComponent;\n  @ViewChild('chart') chart: WarpViewChartComponent;\n  @ViewChild('gtsPopupModal') gtsPopupModal: WarpViewGtsPopupComponent;\n  @ViewChild('annotation') annotation: WarpViewAnnotationComponent;\n  @ViewChild('map') map: WarpViewMapComponent;\n  @ViewChild('timeClipElement', {static: true}) timeClipElement: ElementRef;\n  @ViewChild('GTSTree', {static: true}) GTSTree: ElementRef;\n  @ViewChild('controls', {static: true}) controls: ElementRef;\n  @ViewChild('filterInput', {static: true}) filterInput: ElementRef;\n  @ViewChild('tzSelector') tzSelector: ElementRef;\n  @ViewChild('line') line: ElementRef;\n  @ViewChild('main') main: ElementRef;\n\n  @Input('type') set type(type: string) {\n    this._type = type;\n    this.drawChart();\n  }\n\n  get type() {\n    return this._type;\n  }\n\n  @Input('gtsFilter') set gtsFilter(gtsFilter) {\n    this._gtsFilter = gtsFilter;\n    this.drawChart();\n  }\n\n  get gtsFilter() {\n    return this._gtsFilter;\n  }\n\n  @Input('isAlone') isAlone = false;\n  @Input('initialChartHeight') initialChartHeight = 400;\n  @Input('initialMapHeight') initialMapHeight = 400;\n\n  @Output('warpViewChartResize') warpViewChartResize = new EventEmitter<any>();\n  @Output('warpViewNewOptions') warpViewNewOptions = new EventEmitter<any>();\n\n  _options: Param = {\n    ...new Param(), ...{\n      showControls: true,\n      showGTSTree: true,\n      showDots: true,\n      timeZone: 'UTC',\n      timeUnit: 'us',\n      timeMode: 'date',\n      bounds: {}\n    }\n  };\n  _toHide: number[] = [];\n  showChart = true;\n  showMap = false;\n  timeClipValue = '';\n  kbdLastKeyPressed: string[] = [];\n  warningMessage = '';\n  loading = false;\n  gtsIdList: number[] = [];\n  gtsList: DataModel | GTS[] | string;\n\n  private kbdCounter = 0;\n  private gtsFilterCount = 0;\n  private gtsBrowserIndex = -1;\n  private _gtsFilter = 'x';\n  private _type = 'line';\n  private chartBounds: ChartBounds = {\n    tsmin: Number.MAX_VALUE,\n    tsmax: Number.MIN_VALUE,\n    msmax: '',\n    msmin: '',\n    marginLeft: 0\n  };\n  // key event are trapped in plot component.\n  // if one of this key is pressed, default action is prevented.\n  private preventDefaultKeyList: string[] = ['Escape', '/'];\n  private preventDefaultKeyListInModals: string[] = ['Escape', 'ArrowUp', 'ArrowDown', ' ', '/'];\n  private showLine = false;\n  private left: number;\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewPlotComponent, this._debug);\n  }\n\n  ngOnInit(): void {\n    this._options = this._options || this.defOptions;\n  }\n\n  ngAfterViewInit(): void {\n    this.drawChart(true);\n    this.resizeArea();\n  }\n\n  @HostListener('keydown', ['$event'])\n  handleKeydown(ev: KeyboardEvent) {\n    this.LOG.debug(['handleKeydown'], ev);\n    if (!this.isAlone) {\n      this.handleKeyPress(ev).then(() => {\n        // empty\n      });\n    }\n  }\n\n  stateChange(event: any) {\n    this.LOG.debug(['stateChange'], event);\n    switch (event.id) {\n      case 'timeSwitch' :\n        if (event.state) {\n          this._options.timeMode = 'timestamp';\n        } else {\n          this._options.timeMode = 'date';\n        }\n        this.drawChart(true);\n        break;\n      case 'typeSwitch' :\n        if (event.state) {\n          this._type = 'step';\n        } else {\n          this._type = 'line';\n        }\n        this.drawChart(true);\n        break;\n      case 'chartSwitch' :\n        this.showChart = event.state;\n        this.drawChart(false);\n        break;\n      case 'mapSwitch' :\n        this.showMap = event.state;\n        if (this.showMap) {\n          requestAnimationFrame(() => this.map.resize());\n        }\n        break;\n    }\n    this.warpViewNewOptions.emit(this._options);\n  }\n\n  boundsDidChange(event) {\n    this.LOG.debug(['updateBounds'], event);\n    this._options.bounds = this._options.bounds || {};\n    if (this._options.bounds.minDate !== event.bounds.min && this._options.bounds.maxDate !== event.bounds.max) {\n      this._options.bounds = this._options.bounds || {};\n      this._options.bounds.minDate = event.bounds.min;\n      this._options.bounds.maxDate = event.bounds.max;\n      this.warpViewNewOptions.emit(this._options);\n      if (event.source === 'chart') {\n        this.annotation.updateBounds(event.bounds.min, event.bounds.max, event.bounds.marginLeft);\n      } else if (event.source === 'annotation') {\n        this.chart.updateBounds(event.bounds.min, event.bounds.max);\n      }\n      this.LOG.debug(['updateBounds'],\n        GTSLib.toISOString(event.bounds.min, 1, this._options.timeZone),\n        GTSLib.toISOString(event.bounds.max, 1, this._options.timeZone));\n      this.line.nativeElement.style.left = '-100px';\n    }\n  }\n\n  onWarpViewModalClose() {\n    this.mainPlotDiv.nativeElement.focus();\n  }\n\n  warpViewSelectedGTS(event) {\n    this.LOG.debug(['warpViewSelectedGTS'], event);\n    if (!this._toHide.find(i => {\n      return i === event.gts.id;\n    }) && !event.selected) { // if not in toHide and state false, put id in toHide\n      this._toHide.push(event.gts.id);\n    } else {\n      if (event.selected) { // if in toHide and state true, remove it from toHide\n        this._toHide = this._toHide.filter(i => {\n          return i !== event.gts.id;\n        });\n      }\n    }\n    this.LOG.debug(['warpViewSelectedGTS', 'this._toHide'], this._toHide);\n    this.ngZone.run(() => {\n      this._toHide = [...this._toHide];\n    });\n  }\n\n  handleMouseMove(evt: MouseEvent) {\n    evt.preventDefault();\n    if (this.showLine && this.line) {\n      this.line.nativeElement.style.left = Math.max(evt.pageX - this.left, 50) + 'px';\n    }\n  }\n\n  handleMouseEnter(evt: MouseEvent) {\n    evt.preventDefault();\n    this.left = this.left || this.main.nativeElement.getBoundingClientRect().left;\n    this.showLine = true;\n    if (this.line) {\n      this.renderer.setStyle(this.line.nativeElement, 'display', 'block');\n    }\n  }\n\n  handleMouseOut(evt: MouseEvent) {\n    // evt.preventDefault();\n    if (this.line) {\n      this.showLine = false;\n      this.renderer.setStyle(this.line.nativeElement, 'left', '-100px');\n      this.renderer.setStyle(this.line.nativeElement, 'display', 'none');\n    }\n  }\n\n  update(options, refresh): void {\n    this.drawChart(refresh);\n  }\n\n  inputTextKeyboardEvents(e: KeyboardEvent) {\n    e.stopImmediatePropagation();\n    if (e.key === 'Enter') {\n      this.applyFilter();\n    } else if (e.key === 'Escape') {\n      this.pushKbdEvent('Escape');\n      this.modal.close();\n    }\n  }\n\n  tzSelected(event) {\n    const timeZone = this.tzSelector.nativeElement.value;\n    this.LOG.debug(['timezone', 'tzselect'], timeZone, event);\n    delete this._options.bounds;\n    this._options.timeZone = timeZone;\n    this.tzSelector.nativeElement.setAttribute('class', timeZone === 'UTC' ? 'defaulttz' : 'customtz');\n    this.drawChart();\n  }\n\n  public getTimeClip(): Promise<ChartBounds> {\n    this.LOG.debug(['getTimeClip'], this.chart.getTimeClip());\n    return this.chart.getTimeClip();\n  }\n\n  resizeChart(event) {\n    if (this.initialChartHeight !== event) {\n      this.LOG.debug(['resizeChart'], event);\n      this.initialChartHeight = event;\n      this.sizeService.change(new Size(this.width, event));\n    }\n  }\n\n  drawChart(firstDraw: boolean = false) {\n    this.LOG.debug(['drawCharts'], this._data, this._options);\n    if (!this._data || !this._data.data || this._data.data.length === 0) {\n      return;\n    }\n    if (this.timeClip) {\n      this.timeClip.close();\n    }\n    if (this.modal) {\n      this.modal.close();\n    }\n    this.LOG.debug(['PPts'], 'firstdraw ', firstDraw);\n    if (firstDraw) { // on the first draw, we can set some default options.\n      // automatically switch to timestamp mode\n      // when the first tick and last tick of all the series are in the interval [-100ms 100ms]\n      const tsLimit = 100 * GTSLib.getDivider(this._options.timeUnit);\n      const dataList = this._data.data;\n      if (dataList) {\n        let gtsList = GTSLib.flattenGtsIdArray(dataList as any, 0).res;\n        gtsList = GTSLib.flatDeep(gtsList);\n        let timestampMode = true;\n        let totalDatapoints = 0;\n        gtsList.forEach(g => {\n          this.gtsIdList.push(g.id); // usefull for gts browse shortcut\n          if (g.v.length > 0) { // if gts not empty\n            timestampMode = timestampMode && (g.v[0][0] > -tsLimit && g.v[0][0] < tsLimit);\n            timestampMode = timestampMode && (g.v[g.v.length - 1][0] > -tsLimit && g.v[g.v.length - 1][0] < tsLimit);\n            totalDatapoints += g.v.length;\n          }\n        });\n        if (timestampMode) {\n          this._options.timeMode = 'timestamp';\n        }\n        this.LOG.debug(['drawCharts', 'parsed', 'timestampMode'], timestampMode);\n      }\n    }\n    this.gtsList = this._data;\n    this._options = {...this._options};\n\n    this.LOG.debug(['drawCharts', 'parsed'], this._data, this._options);\n    this.resizeArea();\n  }\n\n  focus(event: any) {\n    // read the first 4 letters of id of all elements in the click tree\n    const idListClicked = event.path.map(el => (el.id || '').slice(0, 4));\n    // if not alone on the page, and click is not on the timezone selector and not on the map, force focus.\n    if (!this.isAlone && idListClicked.indexOf('tzSe') < 0 && idListClicked.indexOf('map-') < 0) {\n      this.mainPlotDiv.nativeElement.focus();\n    } // prevent stealing focus of the timezone selector.\n  }\n\n  private async handleKeyPress(ev: KeyboardEvent) {\n    this.LOG.debug(['handleKeyPress'], ev);\n    if (this.preventDefaultKeyList.indexOf(ev.key) >= 0) {\n      ev.preventDefault();\n    }\n    if (await this.timeClip.isOpened() || await this.modal.isOpened() || await this.gtsPopupModal.isOpened()) {\n      if (this.preventDefaultKeyListInModals.indexOf(ev.key) >= 0) {\n        ev.preventDefault();\n      }\n    }\n    if (ev.key === '/') {\n      this.modal.open();\n      this.filterInput.nativeElement.focus();\n      this.filterInput.nativeElement.select();\n    } else if (ev.key === 't') {\n      this.chart.getTimeClip().then(tc => {\n        this.timeClipValue = `<p>keep data between\n          ${this._options.timeMode === 'timestamp' ? tc.tsmin : moment.tz(tc.tsmin, this._options.timeZone).toLocaleString()} and\n          ${this._options.timeMode === 'timestamp' ? tc.tsmax : moment.tz(tc.tsmax, this._options.timeZone).toLocaleString()}\n          ${this._options.timeUnit !== 'us' ? ' (for a ' + this._options.timeUnit + ' platform)' : ''}</p>\n          <pre><code>${Math.round(tc.tsmax)} ${Math.round(tc.tsmax - tc.tsmin)} TIMECLIP</code></pre>`;\n        this.timeClip.open();\n      });\n    } else if (ev.key === 'b' || ev.key === 'B') { // browse among all gts\n      if (this.gtsBrowserIndex < 0) {\n        this.gtsBrowserIndex = 0;\n      }\n      if (ev.key === 'b') { // increment index\n        this.gtsBrowserIndex++;\n        if (this.gtsBrowserIndex === this.gtsIdList.length) {\n          this.gtsBrowserIndex = 0;\n        }\n      } else { // decrement index\n        this.gtsBrowserIndex--;\n        if (this.gtsBrowserIndex < 0) {\n          this.gtsBrowserIndex = this.gtsIdList.length - 1;\n        }\n      }\n      this._toHide = this.gtsIdList.filter(v => v !== this.gtsIdList[this.gtsBrowserIndex]); // hide all but one\n    } else if (ev.key === 'n') {\n      this._toHide = [...this.gtsIdList];\n      return false;\n    } else if (ev.key === 'a') {\n      this._toHide = [];\n    } else if (ev.key === 'Escape') {\n      this.timeClip.isOpened().then(r => {\n        if (r) {\n          this.timeClip.close();\n        }\n      });\n      this.modal.isOpened().then(r => {\n        if (r) {\n          this.modal.close();\n        }\n      });\n      this.gtsPopupModal.isOpened().then(r => {\n        if (r) {\n          this.gtsPopupModal.close();\n        }\n      });\n    } else {\n      this.pushKbdEvent(ev.key);\n    }\n    this.LOG.debug(['handleKeyPress', 'this.gtsIdList'], this._toHide, this.gtsBrowserIndex);\n  }\n\n  applyFilter() {\n    this.gtsFilterCount++;\n    this._gtsFilter = this.gtsFilterCount.toString().slice(0, 1) + this.filterInput.nativeElement.value;\n    this.modal.close();\n  }\n\n  private pushKbdEvent(key: string) {\n    this.kbdCounter++;\n    this.kbdLastKeyPressed = [key, this.kbdCounter.toString()];\n  }\n\n  getTZ() {\n    return moment.tz.names();\n  }\n\n  protected convert(data: DataModel): any[] {\n    return [];\n  }\n\n  onChartDraw($event: any, component) {\n    if (\n      this.chartBounds\n      && $event\n      && this.chartBounds.tsmin !== Math.min(this.chartBounds.tsmin, $event.tsmin)\n      && this.chartBounds.tsmax !== Math.max(this.chartBounds.tsmax, $event.tsmax)\n    ) {\n      this.chartBounds.tsmin = Math.min(this.chartBounds.tsmin, $event.tsmin);\n      this.chartBounds.tsmax = Math.max(this.chartBounds.tsmax, $event.tsmax);\n      this.annotation.setRealBounds(this.chartBounds);\n      this.chart.setRealBounds(this.chartBounds);\n      this.chartDraw.emit();\n      this.LOG.debug(['onChartDraw', 'this.chartBounds'], component, this.chartBounds, $event);\n    } else {\n      this.chartDraw.emit($event);\n    }\n    this.resizeArea();\n  }\n\n  private resizeArea() {\n    if (this.showChart && !!this.chart) {\n      let h = this.chart.el.nativeElement.getBoundingClientRect().height;\n      if (h > 0) {\n        if (!!this.GTSTree) {\n          h -= this.GTSTree.nativeElement.getBoundingClientRect().height;\n        }\n        if (!!this.controls) {\n          h -= this.controls.nativeElement.getBoundingClientRect().height;\n        }\n        this.initialChartHeight = h;\n      } else {\n        setTimeout(() => this.resizeArea(), 100);\n      }\n    }\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {AfterViewInit, Component, ElementRef, EventEmitter, Input, Output, Renderer2, ViewChild, ViewEncapsulation} from '@angular/core';\nimport {Logger} from '../../utils/logger';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-resize',\n  templateUrl: './warp-view-resize.component.html',\n  styleUrls: ['./warp-view-resize.component.scss'],\n  encapsulation: ViewEncapsulation.None\n})\nexport class WarpViewResizeComponent implements AfterViewInit {\n  @ViewChild('handleDiv', {static: true}) handleDiv: ElementRef;\n  @ViewChild('wrapper', {static: true}) wrapper: ElementRef;\n  @Input('minHeight') minHeight = '10';\n  @Input('initialHeight') initialHeight = 100;\n\n  @Input('debug') set debug(debug: boolean) {\n    this._debug = debug;\n    this.LOG.setDebug(debug);\n  }\n\n  get debug() {\n    return this._debug;\n  }\n\n  @Output('resize') resize = new EventEmitter();\n\n  private dragging = false;\n  private moveListener: EventListener;\n  private clickUpListener: EventListener;\n  private LOG: Logger;\n  private _debug = false;\n\n  constructor(private el: ElementRef, private renderer: Renderer2) {\n    this.LOG = new Logger(WarpViewResizeComponent, this._debug);\n  }\n\n  ngAfterViewInit(): void {\n    this.LOG.debug(['ngAfterViewInit'], this.initialHeight);\n    this.renderer.setStyle(this.wrapper.nativeElement, 'height', this.initialHeight + 'px');\n    // the click event on the handlebar attach mousemove and mouseup events to document.\n    this.handleDiv.nativeElement.addEventListener('mousedown', (ev: MouseEvent) => {\n      if (0 === ev.button) {\n        // keep left click only\n        this.moveListener = this.handleDraggingMove.bind(this);\n        this.clickUpListener = this.handleDraggingEnd.bind(this);\n        document.addEventListener('mousemove', this.moveListener, false);\n        document.addEventListener('mouseup', this.clickUpListener, false);\n      }\n    });\n  }\n\n  private handleDraggingEnd() {\n    this.dragging = false;\n    // the mouseup detach mousemove and mouseup events from document.\n    if (this.moveListener) {\n      document.removeEventListener('mousemove', this.moveListener, false);\n      this.moveListener = null;\n    }\n    if (this.clickUpListener) {\n      document.removeEventListener('mouseup', this.clickUpListener, false);\n      this.clickUpListener = null;\n    }\n  }\n\n  private handleDraggingMove(ev: MouseEvent) {\n    ev.preventDefault();\n    this.LOG.debug(['handleDraggingMove'], ev);\n    // compute Y of the parent div top relative to page\n    const yTopParent = this.handleDiv.nativeElement.parentElement.getBoundingClientRect().top\n      - document.body.getBoundingClientRect().top;\n    // compute new parent height\n    let h = ev.pageY - yTopParent + this.handleDiv.nativeElement.getBoundingClientRect().height / 2;\n    if (h < parseInt(this.minHeight, 10)) {\n      h = parseInt(this.minHeight, 10);\n    }\n    // apply new height\n    this.renderer.setStyle(this.handleDiv.nativeElement.parentElement, 'height', h + 'px');\n    this.LOG.debug(['handleDraggingMove'], h);\n    this.resize.emit(h);\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\nimport {AfterViewInit, Component, ElementRef, EventEmitter, Input, Output, ViewChild, ViewEncapsulation} from '@angular/core';\nimport moment from 'moment';\nimport {Logger} from '../../utils/logger';\nimport * as noUiSlider from 'nouislider';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-slider',\n  templateUrl: './warp-view-slider.component.html',\n  styleUrls: ['./warp-view-slider.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewSliderComponent implements AfterViewInit {\n  @ViewChild('slider') slider: ElementRef<HTMLDivElement>;\n\n  @Input('min') set min(m) {\n    this.LOG.debug(['min'], m);\n    this._min = m;\n    this.setOptions();\n  }\n\n  get min() {\n    return this._min;\n  }\n\n  @Input('max') set max(m) {\n    this.LOG.debug(['max'], m);\n    this._max = m;\n    this.setOptions();\n  }\n\n  get max() {\n    return this._max;\n  }\n\n\n  @Input('value') value: number;\n\n  @Input('step') set step(step: number) {\n    this.LOG.debug(['step'], step);\n    if (this._step !== step) {\n      this._step = step;\n      this.setOptions();\n    }\n  }\n\n  get step() {\n    return this._step;\n  }\n\n  @Input('mode') mode = 'timestamp';\n\n  @Input('debug') set debug(debug: boolean) {\n    this._debug = debug;\n    this.LOG.setDebug(debug);\n  }\n\n  get debug() {\n    return this._debug;\n  }\n\n  @Output('change') change = new EventEmitter();\n\n  _min: number;\n  _max: number;\n  show = false;\n  protected _uiSlider;\n  protected _step = 0;\n  protected LOG: Logger;\n  loaded = false;\n  protected manualRefresh: EventEmitter<void> = new EventEmitter<void>();\n  protected _debug = false;\n\n  constructor() {\n    this.LOG = new Logger(WarpViewSliderComponent, this.debug);\n    this.LOG.debug(['constructor'], this.debug);\n  }\n\n  ngAfterViewInit(): void {\n    this.loaded = false;\n    this.setOptions();\n  }\n\n  protected setOptions() {\n    if (!this._min && !this._max) {\n      return;\n    }\n    this.LOG.debug(['_step'], this._step);\n    const tmpVAl = Math.min(Math.max(this.value || Number.MIN_VALUE, this._min), this._max);\n    if (tmpVAl !== this.value && this.loaded) {\n      this.change.emit(tmpVAl);\n    }\n    this.value = tmpVAl;\n    this.loaded = true;\n    this.LOG.debug(['noUiSlider'], this.slider);\n    if (this.slider) {\n      if (!this._uiSlider) {\n        const opts = {\n          start: [this.value + 1],\n          tooltips: [this.getFormat()],\n          range: {min: [this._min], max: [this._max]}\n        } as any;\n        if (!!this._step && this._step > 0) {\n          opts.step = Math.floor((this._max - this._min) / this._step);\n        }\n        this._uiSlider = noUiSlider.create(this.slider.nativeElement, opts);\n        this._uiSlider.on('end', event => {\n          this.LOG.debug(['onChange'], event);\n          this.value = parseInt(event[0], 10);\n          this.change.emit({value: parseInt(event[0], 10)});\n        });\n      } else {\n        this.updateSliderOptions();\n      }\n    }\n  }\n\n  protected updateSliderOptions() {\n    // tslint:disable-next-line:no-string-literal\n    this.slider.nativeElement['noUiSlider'].set([this.value]);\n    const opts = {range: {min: [this._min], max: [this._max]}} as any;\n    if (!!this._step && this._step > 0) {\n      opts.step = Math.floor((this._max - this._min) / this._step);\n    }\n    // tslint:disable-next-line:no-string-literal\n    this.slider.nativeElement['noUiSlider'].updateOptions(opts);\n  }\n\n  format(value: number) {\n    if (this.mode !== 'timestamp') {\n      return moment(value).utc(true).format('YYYY/MM/DD hh:mm:ss');\n    } else {\n      return value.toString();\n    }\n  }\n\n  protected getFormat() {\n    return {\n      to: value => this.format(value),\n      from: value => value.replace(',-', '')\n    };\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\nimport {AfterViewInit, Component, ElementRef, Input, OnInit, ViewChild, ViewEncapsulation} from '@angular/core';\nimport {WarpViewSliderComponent} from '../warp-view-slider/warp-view-slider.component';\nimport {Logger} from '../../utils/logger';\nimport * as noUiSlider from 'nouislider';\n\n/**\n *\n */\n@Component({\n  selector: 'warpview-range-slider',\n  templateUrl: './warp-view-range-slider.component.html',\n  styleUrls: ['./warp-view-range-slider.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewRangeSliderComponent extends WarpViewSliderComponent implements OnInit, AfterViewInit {\n  @ViewChild('slider') slider: ElementRef<HTMLDivElement>;\n  @Input('minValue') minValue: number;\n  @Input('maxValue') maxValue: number;\n\n  constructor() {\n    super();\n    this.LOG = new Logger(WarpViewRangeSliderComponent, this.debug);\n    this.LOG.debug(['constructor'], this.debug);\n  }\n\n  ngOnInit(): void {\n    this.setOptions();\n    this.minValue = this.minValue || this._min;\n    this.maxValue = this.maxValue || this._max;\n  }\n\n  ngAfterViewInit(): void {\n    this.loaded = false;\n    this.setOptions();\n  }\n\n  onChange(val) {\n    this.change.emit({value: this.minValue, highValue: this.maxValue});\n    this.LOG.debug(['onChange'], val, {value: this.minValue, highValue: this.maxValue});\n  }\n\n  protected setOptions() {\n    this.LOG.debug(['setOptions'], this._min, this._max);\n    if (!this._min && !this._max) {\n      return;\n    }\n    this.loaded = true;\n    this.value = Math.max(this.value || Number.MIN_VALUE, this._min);\n    this.LOG.debug(['noUiSlider'], this.slider);\n    if (this.slider) {\n      if (!this._uiSlider) {\n        const opts = {\n          start: [this.minValue, this.maxValue],\n          connect: true,\n          tooltips: [this.getFormat(), this.getFormat()],\n          range: {min: [this._min], max: [this._max]}\n        } as any;\n        if (!!this._step && this._step > 0) {\n          opts.step = Math.floor((this._max - this._min) / this._step);\n        }\n        const uiSlider = noUiSlider.create(this.slider.nativeElement, opts);\n        uiSlider.on('end', event => {\n          this.LOG.debug(['onChange'], event);\n          this.change.emit({\n            min: parseInt(event[0], 10),\n            max: parseInt(event[1], 10)\n          });\n        });\n      } else {\n        this.updateSliderOptions();\n      }\n    }\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {Component, ElementRef, Input, NgZone, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {VisibilityState, WarpViewComponent} from '../warp-view-component';\nimport {DataModel} from '../../model/dataModel';\nimport {Param} from '../../model/param';\nimport {ColorLib} from '../../utils/color-lib';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {GTS} from '../../model/GTS';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\n\n@Component({\n  selector: 'warpview-spectrum',\n  templateUrl: './warp-view-spectrum.component.html',\n  styleUrls: ['./warp-view-spectrum.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewSpectrumComponent extends WarpViewComponent {\n\n  @Input('type') set type(type: string) {\n    this._type = type;\n    this.drawChart();\n  }\n\n  layout: Partial<any> = {\n    showlegend: false,\n    xaxis: {},\n    yaxis: {},\n    margin: {\n      t: 10,\n      b: 25,\n      r: 10,\n      l: 50\n    }\n  };\n  private _type = 'histogram2d';\n  private visibility: boolean[] = [];\n  private visibilityStatus: VisibilityState = 'unknown';\n  private maxTick = 0;\n  private minTick = 0;\n  private visibleGtsId = [];\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewSpectrumComponent, this._debug);\n  }\n\n  update(options: Param): void {\n    this.drawChart();\n  }\n\n  private drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.plotlyConfig.scrollZoom = true;\n    this.buildGraph();\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    const type = this._options.histo || {histnorm: 'density', histfunc: 'count'};\n    const dataset: Partial<any>[] = [];\n    this.LOG.debug(['convert'], this._options);\n    this.visibility = [];\n    let gtsList = GTSLib.flatDeep(GTSLib.flattenGtsIdArray([data.data] as any[], 0).res) || [];\n    this.maxTick = Number.NEGATIVE_INFINITY;\n    this.minTick = Number.POSITIVE_INFINITY;\n    this.visibleGtsId = [];\n    const nonPlottable = gtsList.filter(g => {\n      this.LOG.debug(['convert'], GTSLib.isGtsToPlot(g));\n      return (g.v && !GTSLib.isGtsToPlot(g));\n    });\n    gtsList = gtsList.filter(g => {\n      return (g.v && GTSLib.isGtsToPlot(g));\n    });\n    // initialize visibility status\n    if (this.visibilityStatus === 'unknown') {\n      this.visibilityStatus = gtsList.length > 0 ? 'plottableShown' : 'nothingPlottable';\n    }\n\n    if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n      this.layout.xaxis.type = 'linear';\n    } else {\n      this.layout.xaxis.type = 'date';\n    }\n    gtsList.forEach((gts: GTS, i) => {\n      if (gts.v && GTSLib.isGtsToPlot(gts)) {\n        const label = GTSLib.serializeGtsMetadata(gts);\n        const c = ColorLib.getColor(i, this._options.scheme);\n        const color = ((data.params || [])[gts.id] || {datasetColor: c}).datasetColor || c;\n        const series: Partial<any> = {\n          type: this._type,\n          histnorm: type.histnorm || 'density',\n          histfunc: type.histfunc || 'count',\n          contours: {\n            showlabels: true,\n            labelfont: {\n              color: 'white'\n            }\n          },\n          colorbar: {\n            tickcolor: this.getGridColor(this.el.nativeElement),\n            thickness: 0,\n            tickfont: {\n              color: this.getLabelColor(this.el.nativeElement)\n            },\n            x: 1 + gts.id / 20,\n            xpad: 0\n          },\n          showscale: this.showLegend,\n          colorscale: ColorLib.getColorGradient(gts.id, this._options.scheme),\n          autocolorscale: false,\n          name: label,\n          text: label,\n          x: [],\n          y: [],\n          line: {color},\n          hoverinfo: 'none',\n          connectgaps: false,\n          visible: this._hiddenData.filter(h => h === gts.id).length >= 0,\n        };\n        gts.v.forEach(value => {\n          const ts = value[0];\n          series.y.push(value[value.length - 1]);\n          if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n            series.x.push(ts);\n          } else {\n            series.x.push(GTSLib.toISOString(ts, this.divider, this._options.timeZone));\n          }\n        });\n        dataset.push(series);\n      }\n    });\n    this.LOG.debug(['convert', 'dataset'], dataset);\n\n    return dataset;\n  }\n\n  private buildGraph() {\n    this.LOG.debug(['drawChart', 'this.layout'], this.responsive);\n    this.LOG.debug(['drawChart', 'this.layout'], this.layout);\n    this.LOG.debug(['drawChart', 'this.plotlyConfig'], this.plotlyConfig);\n    this.layout.showlegend = this.showLegend;\n    this.layout.yaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.xaxis.color = this.getGridColor(this.el.nativeElement);\n    this.loading = false;\n  }\n}\n","import {\n  Component,\n  DoCheck,\n  ElementRef,\n  EventEmitter,\n  Input,\n  IterableDiffer,\n  IterableDiffers,\n  KeyValueDiffer,\n  KeyValueDiffers,\n  OnDestroy,\n  OnInit,\n  Output,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\nimport * as Plotlyjs from 'plotly.js-dist';\nimport {Config, Data, Layout, PlotlyHTMLElement, Plots} from 'plotly.js-dist';\nimport {Logger} from '../utils/logger';\n\nexport interface Figure {\n  data: Data[];\n  layout: Partial<Layout>;\n  frames: Partial<Config>;\n}\n\n@Component({\n  selector: 'warpview-plotly',\n  templateUrl: './plotly.component.html',\n  styleUrls: ['./plotly.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class PlotlyComponent implements OnInit, OnDestroy, DoCheck {\n  protected defaultClassName = 'js-plotly-plot';\n  protected LOG: Logger;\n  private _data;\n  private _layout;\n  private _config;\n  private _debug = false;\n  public plotlyInstance: PlotlyHTMLElement;\n  public resizeHandler?: (instance: PlotlyHTMLElement) => void;\n  public layoutDiffer: KeyValueDiffer<string, any>;\n  public dataDiffer: IterableDiffer<Partial<any>>;\n\n  @ViewChild('plot', {static: true}) plotEl: ElementRef;\n\n  /*\n   this.LOG.debug(['ngOnChanges'], changes);\n      const revision: SimpleChange = changes.revision;\n      if (changes.debug) {\n        this.debug = changes.debug.currentValue;\n      }\n      if (!!changes.data && !deepEqual(changes.data.currentValue, changes.data.previousValue)) {\n        this.updatePlot();\n      } else if (!changes.layout && ((revision && !revision.isFirstChange()) || !!changes.data || !!changes.config)) {\n        this.updatePlot();\n      }\n      if (!!changes.debug) {\n        this.LOG.setDebug(changes.debug.currentValue);\n      }\n      this.updateWindowResizeHandler();\n      this.LOG.debug(['ngOnChanges'], changes);\n   */\n  @Input() set data(data: Partial<any>[]) {\n    this._data = data;\n    this.updatePlot();\n    this.updateWindowResizeHandler();\n  }\n\n  get data(): Partial<any>[] {\n    return this._data;\n  }\n\n  @Input() set layout(layout: Partial<any>) {\n    this._layout = layout;\n    if (!!this._data && !!this.plotEl.nativeElement) {\n      try {\n        Plotlyjs.relayout(this.plotEl.nativeElement, layout);\n        this.updateWindowResizeHandler();\n      } catch (e) {\n        //\n      }\n    }\n  }\n\n  get layout(): Partial<any> {\n    return this._layout;\n  }\n\n  @Input() set config(config: Partial<Config>) {\n    this._config = config;\n    this.updatePlot();\n    this.updateWindowResizeHandler();\n  }\n\n  get config(): Partial<Config> {\n    return this._config;\n  }\n\n  @Input() set debug(debug: boolean) {\n    this._debug = debug;\n  }\n\n  get debug(): boolean {\n    return this._debug;\n  }\n\n  @Input() frames?: Partial<any>[];\n  @Input() style?: { [key: string]: string };\n\n  @Input() divId?: string;\n  @Input() revision = 0;\n  @Input() className?: string | string[];\n  @Input() useResizeHandler = false;\n\n  @Input() updateOnLayoutChange = true;\n  @Input() updateOnDataChange = true;\n  @Input() updateOnlyWithRevision = true;\n\n  @Output() initialized = new EventEmitter<PlotlyHTMLElement>();\n  @Output() update = new EventEmitter<Figure>();\n  @Output() purge = new EventEmitter<Figure>();\n  @Output() error = new EventEmitter<Error>();\n\n  @Output() afterExport = new EventEmitter();\n  @Output() afterPlot = new EventEmitter();\n  @Output() animated = new EventEmitter();\n  @Output() animatingFrame = new EventEmitter();\n  @Output() animationInterrupted = new EventEmitter();\n  @Output() autoSize = new EventEmitter();\n  @Output() beforeExport = new EventEmitter();\n  @Output() buttonClicked = new EventEmitter();\n  @Output() click = new EventEmitter();\n  @Output() plotly_click = new EventEmitter();\n  @Output() clickAnnotation = new EventEmitter();\n  @Output() deselect = new EventEmitter();\n  @Output() doubleClick = new EventEmitter();\n  @Output() framework = new EventEmitter();\n  @Output() hover = new EventEmitter();\n  @Output() legendClick = new EventEmitter();\n  @Output() legendDoubleClick = new EventEmitter();\n  @Output() relayout = new EventEmitter();\n  @Output() restyle = new EventEmitter();\n  @Output() redraw = new EventEmitter();\n  @Output() selected = new EventEmitter();\n  @Output() selecting = new EventEmitter();\n  @Output() sliderChange = new EventEmitter();\n  @Output() sliderEnd = new EventEmitter();\n  @Output() sliderStart = new EventEmitter();\n  @Output() transitioning = new EventEmitter();\n  @Output() transitionInterrupted = new EventEmitter();\n  @Output() unhover = new EventEmitter();\n  @Output() relayouting = new EventEmitter();\n\n  public eventNames = [\n    // 'afterExport',\n    //   'afterPlot', // 'animated', 'animatingFrame', 'animationInterrupted', 'autoSize',\n    // 'beforeExport', 'buttonClicked', 'clickAnnotation', 'deselect', 'doubleClick', 'framework',\n    'hover', 'unhover',\n    // 'legendClick', 'legendDoubleClick',\n    'relayout',\n    // 'restyle', 'redraw', 'selected', 'selecting', 'sliderChange',\n    // 'sliderEnd', 'sliderStart', 'transitioning', 'transitionInterrupted', 'relayouting'\n  ];\n  rect: any;\n\n  constructor(\n    public iterableDiffers: IterableDiffers,\n    public el: ElementRef,\n    public keyValueDiffers: KeyValueDiffers\n  ) {\n    this.LOG = new Logger(PlotlyComponent, this.debug);\n  }\n\n  ngOnInit() {\n    this.createPlot().then(() => {\n      const figure = this.createFigure();\n      this.LOG.debug(['figure'], figure);\n      this.initialized.emit(this.plotlyInstance);\n    });\n  }\n\n  ngOnDestroy() {\n    if (typeof this.resizeHandler === 'function') {\n      this.getWindow().removeEventListener('resize', this.resizeHandler as any);\n      this.resizeHandler = undefined;\n    }\n\n    const figure = this.createFigure();\n    this.purge.emit(figure);\n    this.remove(this.plotlyInstance);\n  }\n\n  ngDoCheck() {\n    if (this.updateOnlyWithRevision) {\n      return false;\n    }\n    let shouldUpdate = false;\n    if (this.updateOnLayoutChange) {\n      if (this.layoutDiffer) {\n        const layoutHasDiff = this.layoutDiffer.diff(this.layout);\n        if (layoutHasDiff) {\n          shouldUpdate = true;\n        }\n      } else if (this.layout) {\n        this.layoutDiffer = this.keyValueDiffers.find(this.layout).create();\n      } else {\n        this.layoutDiffer = undefined;\n      }\n    }\n\n    if (this.updateOnDataChange) {\n      if (this.dataDiffer) {\n        const dataHasDiff = this.dataDiffer.diff(this.data);\n        if (dataHasDiff) {\n          shouldUpdate = true;\n        }\n      } else if (Array.isArray(this.data)) {\n        this.dataDiffer = this.iterableDiffers.find(this.data).create(this.dataDifferTrackBy);\n      } else {\n        this.dataDiffer = undefined;\n      }\n    }\n    if (shouldUpdate && this.plotlyInstance) {\n      this.updatePlot();\n    }\n  }\n\n  getWindow(): any {\n    return window;\n  }\n\n  getBoundingClientRect() {\n    return this.rect;\n  }\n\n  getClassName(): string {\n    let classes = [this.defaultClassName];\n    if (Array.isArray(this.className)) {\n      classes = classes.concat(this.className);\n    } else if (!!this.className) {\n      classes.push(this.className);\n    }\n\n    return classes.join(' ');\n  }\n\n  restyleChart(properties: any, curves: any[]) {\n    Plotlyjs.restyle(this.plotlyInstance, properties, curves);\n  }\n\n  createPlot(): Promise<void> {\n    this.LOG.debug(['createPlot'], this.data, this.layout, this.config, this.plotlyInstance);\n    return Plotlyjs.react(this.plotEl.nativeElement, this.data, this.layout, this.config).then(plotlyInstance => {\n      this.rect = this.el.nativeElement.getBoundingClientRect();\n      this.plotlyInstance = plotlyInstance;\n      this.LOG.debug(['plotlyInstance'], plotlyInstance);\n      this.getWindow().gd = this.debug ? plotlyInstance : undefined;\n\n      this.eventNames.forEach(name => {\n        const eventName = `plotly_${name.toLowerCase()}`;\n        // @ts-ignore\n        plotlyInstance.on(eventName, (data: any) => {\n          this.LOG.debug(['plotlyEvent', eventName], data);\n          (this[name] as EventEmitter<any>).emit(data);\n        });\n      });\n\n      plotlyInstance.on('plotly_click', (data: any) => {\n        this.click.emit(data);\n        this.plotly_click.emit(data);\n      });\n\n      this.updateWindowResizeHandler();\n      this.afterPlot.emit(plotlyInstance);\n    }, err => {\n      console.error('Error while plotting:', err);\n      this.error.emit(err);\n    });\n  }\n\n  createFigure(): Figure {\n    const p: any = this.plotlyInstance;\n    return {\n      data: p.data,\n      layout: p.layout,\n      frames: p._transitionData ? p._transitionData._frames : null\n    };\n  }\n\n  updatePlot() {\n    this.LOG.debug(['updatePlot'], this.data, this.layout, {...this.config});\n    if (!this.plotlyInstance) {\n      const error = new Error(`Plotly component wasn't initialized`);\n      this.error.emit(error);\n      return;\n    }\n    Plotlyjs.purge(this.plotlyInstance);\n    this.createPlot().then(() => {\n      const figure = this.createFigure();\n      this.update.emit(figure);\n    }, err => {\n      console.error('Error while updating plot:', err);\n      this.error.emit(err);\n    });\n  }\n\n  updateWindowResizeHandler() {\n    if (this.useResizeHandler) {\n      if (this.resizeHandler === undefined) {\n        this.resizeHandler = () => setTimeout(() => Plots.resize(this.plotlyInstance));\n        this.getWindow().addEventListener('resize', this.resizeHandler as any);\n      }\n    } else {\n      if (typeof this.resizeHandler === 'function') {\n        this.getWindow().removeEventListener('resize', this.resizeHandler as any);\n        this.resizeHandler = undefined;\n      }\n    }\n  }\n\n  dataDifferTrackBy(_: number, item: any): any {\n    const obj = Object.assign({}, item, {uid: ''});\n    return JSON.stringify(obj);\n  }\n\n\n  remove(div: PlotlyHTMLElement) {\n    Plotlyjs.purge(div);\n    delete this.plotlyInstance;\n  }\n\n  resize(layout: { width: number; height: any }) {\n    Plotlyjs.relayout(this.plotEl.nativeElement, layout);\n  }\n}\n","import {Component, ElementRef, Input, NgZone, OnInit, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {DataModel} from '../../model/dataModel';\nimport {Param} from '../../model/param';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {ColorLib} from '../../utils/color-lib';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {GTS} from '../../model/GTS';\nimport moment from 'moment-timezone';\n\n@Component({\n  selector: 'warpview-box',\n  templateUrl: './warp-view-box.component.html',\n  styleUrls: ['./warp-view-box.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewBoxComponent extends WarpViewComponent implements OnInit {\n\n  @Input('type') set type(type: string) {\n    this._type = type;\n    this.drawChart();\n  }\n\n  layout: Partial<any> = {\n    showlegend: false,\n    xaxis: {\n      type: '-'\n    },\n    yaxis: {zeroline: false},\n    boxmode: 'group',\n    margin: {\n      t: 10,\n      b: 25,\n      r: 10,\n      l: 10\n    }\n  };\n  private _type = 'box';\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewBoxComponent, this._debug);\n  }\n\n  ngOnInit() {\n    this.drawChart();\n  }\n\n  update(options: Param): void {\n    this.drawChart();\n  }\n\n  private drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.plotlyConfig.scrollZoom = true;\n    this.buildGraph();\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    const dataset: Partial<any>[] = [];\n    this.LOG.debug(['convert'], this._options, this._type);\n    let gtsList = GTSLib.flatDeep(GTSLib.flattenGtsIdArray(data.data as any[], 0).res);\n    gtsList = gtsList.filter(g => {\n      return (g.v && GTSLib.isGtsToPlot(g));\n    });\n    const pattern = 'YYYY/MM/DD hh:mm:ss';\n    const format = pattern.slice(0, pattern.lastIndexOf(this._options.split || 'D') + 1);\n    gtsList.forEach((gts: GTS, i) => {\n      if (gts.v) {\n        const label = GTSLib.serializeGtsMetadata(gts);\n        const c = ColorLib.getColor(gts.id, this._options.scheme);\n        const color = ((data.params || [])[i] || {datasetColor: c}).datasetColor || c;\n        const series: Partial<any> = {\n          type: 'box',\n          boxmean: 'sd',\n          marker: {color},\n          name: label,\n          x: this._type === 'box' ? undefined : [],\n          y: [],\n          //  hoverinfo: 'none',\n          boxpoints: false\n        };\n        if (!!this._options.showDots) {\n          series.boxpoints = 'all';\n        }\n        gts.v.forEach(value => {\n          series.y.push(value[value.length - 1]);\n          if (this._type === 'box-date') {\n            series.x.push(GTSLib.toISOString(value[0], this.divider, this._options.timeZone));\n          }\n        });\n        dataset.push(series);\n      }\n    });\n    this.LOG.debug(['convert', 'dataset'], dataset, format);\n    return dataset;\n  }\n\n  private buildGraph() {\n    this.LOG.debug(['drawChart', 'this.layout'], this.responsive);\n    this.LOG.debug(['drawChart', 'this.layout'], this.layout);\n    this.LOG.debug(['drawChart', 'this.plotlyConfig'], this.plotlyConfig);\n    this.layout.showlegend = this.showLegend;\n    this.layout.xaxis.showticklabels = this._type === 'box-date';\n    this.layout.yaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.xaxis.color = this.getGridColor(this.el.nativeElement);\n    this.loading = false;\n  }\n\n  hover(data: any) {\n\n  }\n}\n","import {Component, ElementRef, Input, NgZone, OnInit, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {Param} from '../../model/param';\nimport {DataModel} from '../../model/dataModel';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {GTS} from '../../model/GTS';\nimport {ColorLib} from '../../utils/color-lib';\n\n@Component({\n  selector: 'warpview-3d-line',\n  templateUrl: './warp-view-3d-line.component.html',\n  styleUrls: ['./warp-view-3d-line.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpView3dLineComponent extends WarpViewComponent implements OnInit {\n\n  @Input('type') set type(type: string) {\n    this._type = type;\n    this.drawChart();\n  }\n\n  layout: Partial<any> = {\n    showlegend: false,\n    xaxis: {},\n    yaxis: {},\n    zaxis: {},\n    margin: {\n      t: 10,\n      b: 25,\n      r: 10,\n      l: 10\n    }\n  };\n  private _type = 'line3d';\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpView3dLineComponent, this._debug);\n  }\n\n  ngOnInit() {\n    this.drawChart();\n  }\n\n  update(options: Param): void {\n    this.drawChart();\n  }\n\n  private drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.plotlyConfig.scrollZoom = true;\n    this.buildGraph();\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    const dataset: Partial<any>[] = [];\n    this.LOG.debug(['convert'], data, this._options, this._type);\n    GTSLib.flatDeep(GTSLib.flattenGtsIdArray(data.data as any[], 0).res)\n      .filter(g => (g.v && GTSLib.isGts(g)))\n      .forEach((gts: GTS, i) => {\n        if (gts.v) {\n          const label = GTSLib.serializeGtsMetadata(gts);\n          const c = ColorLib.getColor(gts.id, this._options.scheme);\n          const color = ((data.params || [])[i] || {datasetColor: c}).datasetColor || c;\n          const series: Partial<any> = {\n            mode: 'line',\n            type: 'scatter3d',\n            marker: {\n              color: ColorLib.transparentize(color),\n              size: 3,\n              symbol: 'circle',\n              line: {\n                color,\n                width: 0\n              }\n            },\n            line: {\n              color,\n              width: 1\n            },\n            name: label,\n            x: [],\n            y: [],\n            z: [],\n            //     hoverinfo: 'none',\n          };\n          gts.v.forEach(value => {\n            if (value.length > 2) { // lat lon\n              series.x.push(value[1]);\n              series.y.push(value[2]);\n              series.z.push(value[3]);\n            } else { // time value\n              series.x.push(value[0]);\n              series.y.push(value[1]);\n              series.z.push(1);\n            }\n          });\n          dataset.push(series);\n        }\n      });\n    return dataset;\n  }\n\n  private buildGraph() {\n    this.LOG.debug(['drawChart', 'this.layout'], this.responsive);\n    this.LOG.debug(['drawChart', 'this.layout'], this.layout);\n    this.LOG.debug(['drawChart', 'this.plotlyConfig'], this.plotlyConfig);\n    this.layout.showlegend = this.showLegend;\n    this.layout.yaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.xaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.zaxis.color = this.getGridColor(this.el.nativeElement);\n    this.loading = false;\n  }\n}\n","import {Component, ElementRef, Input, NgZone, OnInit, Renderer2, ViewEncapsulation} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {Param} from '../../model/param';\nimport {DataModel} from '../../model/dataModel';\nimport {GTSLib} from '../../utils/gts.lib';\nimport {GTS} from '../../model/GTS';\nimport {ColorLib} from '../../utils/color-lib';\nimport {MapLib} from '../../utils/map-lib';\n\n@Component({\n  selector: 'warpview-globe',\n  templateUrl: './warp-view-globe.component.html',\n  styleUrls: ['./warp-view-globe.component.scss'],\n  encapsulation: ViewEncapsulation.ShadowDom\n})\nexport class WarpViewGlobeComponent extends WarpViewComponent implements OnInit {\n\n\n  @Input('type') set type(type: string) {\n    this._type = type;\n    this.drawChart();\n  }\n\n  layout: Partial<any> = {\n    showlegend: false,\n    margin: {\n      t: 10,\n      b: 25,\n      r: 10,\n      l: 10\n    },\n    geo: {\n      projection: {\n        type: 'orthographic',\n      },\n      showframe: true,\n      fitbounds: 'locations',\n      showocean: true,\n      oceancolor: ColorLib.transparentize('#004eff', 0.2),\n      showland: true,\n      landcolor: ColorLib.transparentize('#6F694E', 0.2),\n      showlakes: true,\n      lakecolor: ColorLib.transparentize('#004eff', 0.2),\n      showcountries: true,\n      lonaxis: {\n        showgrid: true,\n        gridcolor: 'rgb(102, 102, 102)'\n      },\n      lataxis: {\n        showgrid: true,\n        gridcolor: 'rgb(102, 102, 102)'\n      }\n    }\n  };\n  private _type = 'scattergeo';\n  private geoData: { path: { lat: number, lon: number }[] }[] = [];\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewGlobeComponent, this._debug);\n  }\n\n  ngOnInit() {\n    this.drawChart();\n  }\n\n  update(options: Param): void {\n    this.drawChart();\n  }\n\n  private drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.plotlyConfig.scrollZoom = true;\n    this.buildGraph();\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    const dataset: Partial<any>[] = [];\n    this.geoData = [];\n    this.LOG.debug(['convert'], data, this._options, this._type);\n    GTSLib.flatDeep(GTSLib.flattenGtsIdArray(data.data as any[], 0).res)\n      .filter(g => (g.v && GTSLib.isGts(g)))\n      .forEach((gts: GTS, i) => {\n        if (gts.v) {\n          const geoData = {path: []};\n          const label = GTSLib.serializeGtsMetadata(gts);\n          const c = ColorLib.getColor(gts.id, this._options.scheme);\n          const color = ((data.params || [])[i] || {datasetColor: c}).datasetColor || c;\n          const series: Partial<any> = {\n            mode: 'lines',\n            type: 'scattergeo',\n            marker: {\n              color: ColorLib.transparentize(color),\n              size: 3,\n              symbol: 'circle',\n              line: {\n                color,\n                width: 0\n              }\n            },\n            line: {\n              color,\n              width: 1\n            },\n            name: label,\n            lon: [],\n            lat: [],\n            hoverinfo: 'none',\n          };\n          gts.v.forEach(value => {\n            if (value.length > 2) {\n              series.lat.push(value[1]);\n              series.lon.push(value[2]);\n              geoData.path.push({lat: value[1], lon: value[2]});\n            }\n          });\n          this.geoData.push(geoData);\n          dataset.push(series);\n        }\n      });\n    return dataset;\n  }\n\n  private buildGraph() {\n    this.LOG.debug(['drawChart', 'this.layout'], this._responsive);\n    this.LOG.debug(['drawChart', 'this.layout'], this.layout);\n    this.LOG.debug(['drawChart', 'this.plotlyConfig'], this.plotlyConfig);\n    this.layout.showlegend = this._showLegend;\n    const bounds = MapLib.getBoundsArray(this.geoData, [], [], []);\n    this.LOG.debug(['drawChart', 'bounds'], bounds);\n    this.layout.geo.lonaxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout.geo.lataxis.range = [bounds[0][0], bounds[1][0]];\n    this.layout.geo.lonaxis.range = [bounds[0][1], bounds[1][1]];\n    this.layout.geo.lataxis.color = this.getGridColor(this.el.nativeElement);\n    this.layout = {...this.layout};\n    this.loading = false;\n  }\n\n}\n","import {\n  Component,\n  ElementRef,\n  EventEmitter,\n  Input,\n  NgZone,\n  OnDestroy,\n  OnInit,\n  Output,\n  Renderer2,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport deepEqual from 'deep-equal';\nimport {ChartLib} from '../../utils/chart-lib';\nimport {Param} from '../../model/param';\nimport {DataModel} from '../../model/dataModel';\nimport {ColorLib} from '../../utils/color-lib';\nimport * as d3 from 'd3';\nimport eventDrops from 'event-drops';\nimport {GTSLib} from '../../utils/gts.lib';\nimport moment from 'moment-timezone';\nimport {select} from 'd3-selection';\n\n@Component({\n  selector: 'warpview-event-drop',\n  templateUrl: './warp-view-event-drop.component.html',\n  styleUrls: ['./warp-view-event-drop.component.scss'],\n  encapsulation: ViewEncapsulation.None\n})\nexport class WarpViewEventDropComponent extends WarpViewComponent implements OnInit, OnDestroy {\n  @ViewChild('elemChart', {static: true}) elemChart: ElementRef;\n\n  @Input('type') set type(type: string) {\n    this._type = type;\n    this.drawChart();\n  }\n\n\n  @Input('hiddenData') set hiddenData(hiddenData: number[]) {\n    const previousVisibility = JSON.stringify(this.visibility);\n    this.LOG.debug(['hiddenData', 'previousVisibility'], previousVisibility);\n    this._hiddenData = hiddenData;\n    this.visibility = [];\n    this.visibleGtsId.forEach(id => this.visibility.push(hiddenData.indexOf(id) < 0 && (id !== -1)));\n    this.LOG.debug(['hiddenData', 'hiddendygraphfullv'], this.visibility);\n    const newVisibility = JSON.stringify(this.visibility);\n    this.LOG.debug(['hiddenData', 'json'], previousVisibility, newVisibility);\n    if (previousVisibility !== newVisibility) {\n      this.drawChart();\n      this.LOG.debug(['hiddendygraphtrig', 'destroy'], 'redraw by visibility change');\n    }\n  }\n\n  @Output('pointHover') pointHover = new EventEmitter<any>();\n  @Output('warpViewChartResize') warpViewChartResize = new EventEmitter<any>();\n  @Output('chartDraw') chartDraw = new EventEmitter<any>();\n  @Output('boundsDidChange') boundsDidChange = new EventEmitter<any>();\n\n  private visibility: boolean[] = [];\n  private maxTick = Number.MIN_VALUE;\n  private minTick = Number.MAX_VALUE;\n  private visibleGtsId = [];\n  private _type = 'drops';\n  private eventConf = {\n    d3,\n    axis: {\n      verticalGrid: true,\n      tickPadding: 6,\n    },\n    indicator: false,\n    label: {\n      text: row => row.name,\n    },\n    drop: {\n      date: d => new Date(d.date),\n      color: d => d.color,\n      onMouseOver: g => {\n        this.LOG.debug(['onMouseOver'], g);\n        this.pointHover.emit({\n          x: d3.event.offsetX,\n          y: d3.event.offsetY\n        });\n        const t = d3\n          .select(this.toolTip.nativeElement);\n        t.transition()\n          .duration(200)\n          .style('opacity', 1)\n          .style('pointer-events', 'auto');\n        t.html(`<div class=\"tooltip-body\">\n<b class=\"tooltip-date\">${this._options.timeMode === 'timestamp'\n          ? g.date\n          : (moment(g.date.valueOf()).utc().toISOString() || '')}</b>\n<div><i class=\"chip\"  style=\"background-color: ${ColorLib.transparentize(g.color, 0.7)};border: 2px solid ${g.color};\"></i>\n${GTSLib.formatLabel(g.name)}: <span class=\"value\">${g.value}</span>\n</div></div>`\n        )\n          .style('left', `${d3.event.offsetX - 30}px`)\n          .style('top', `${d3.event.offsetY + 20}px`);\n      },\n      onMouseOut: () => {\n        select(this.toolTip.nativeElement)\n          .transition()\n          .duration(500)\n          .style('opacity', 0)\n          .style('pointer-events', 'none');\n      },\n    },\n  };\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewEventDropComponent, this._debug);\n  }\n\n\n  ngOnInit(): void {\n    this._options = this._options || this.defOptions;\n  }\n\n  ngOnDestroy(): void {\n    if (!!this.elemChart) {\n      select(this.elemChart.nativeElement).remove();\n    }\n  }\n\n  update(options, refresh): void {\n    this.LOG.debug(['onOptions', 'before'], this._options, options);\n    if (!deepEqual(options, this._options)) {\n      this.LOG.debug(['options', 'changed'], options);\n      this._options = ChartLib.mergeDeep(this._options, options as Param) as Param;\n    }\n    this.drawChart();\n  }\n\n  updateBounds(min, max) {\n    this.LOG.debug(['updateBounds'], min, max, this._options);\n    this._options.bounds.minDate = min;\n    this._options.bounds.maxDate = max;\n\n    if (this._options.timeMode && this._options.timeMode === 'timestamp') {\n      this.eventConf['range'] = {start: min, end: max};\n    } else {\n      this.eventConf['range'] = {\n        start: moment.tz(moment.utc(this.minTick / this.divider), this._options.timeZone).toDate(),\n        end: moment.tz(moment.utc(this.maxTick / this.divider), this._options.timeZone).toDate(),\n      };\n    }\n    this.eventConf = {...this.eventConf};\n    this.LOG.debug(['updateBounds'], this.eventConf);\n  }\n\n  drawChart() {\n    if (!this.initChart(this.el)) {\n      return;\n    }\n    this.loading = false;\n    this.LOG.debug(['drawChart', 'plotlyData'], this.plotlyData, this._type);\n    if (this.elemChart.nativeElement) {\n      setTimeout(() => select(this.elemChart.nativeElement).data([this.plotlyData]).call(eventDrops(this.eventConf)));\n      this.loading = false;\n      this.chartDraw.emit();\n    }\n  }\n\n  protected convert(data: DataModel): any[] {\n    this.LOG.debug(['convert'], data);\n    let labelsSize = 0;\n    const gtsList = GTSLib.flatDeep(data.data as any[]);\n    const dataList = [];\n    this.LOG.debug(['convert', 'gtsList'], gtsList);\n    if (!gtsList || gtsList.length === 0 || gtsList[0].length < 2) {\n      return;\n    }\n    gtsList.forEach((gts, i) => {\n      const c = ColorLib.getColor(gts.id || i, this._options.scheme);\n      const color = ((data.params || [])[i] || {datasetColor: c}).datasetColor || c;\n      const gtsName = GTSLib.serializeGtsMetadata(gts);\n      labelsSize = Math.max(gtsName.length * 8);\n      const dataSet = {name: gtsName, color, data: []};\n      const size = (gts.v || []).length;\n      for (let v = 0; v < size; v++) {\n        const point = (gts.v || [])[v];\n        const ts = point[0];\n        this.minTick = Math.min(this.minTick, ts);\n        this.maxTick = Math.max(this.maxTick, ts);\n        let value = point[point.length - 1];\n        if (isNaN(value)) {\n          value = 1;\n        }\n        dataSet.data.push({\n          date: moment.tz(moment.utc(ts / this.divider), this._options.timeZone).toDate(),\n          color,\n          value,\n          name: dataSet.name\n        });\n      }\n      dataList.push(dataSet);\n    });\n    this.LOG.debug(['convert', 'dataList'], dataList);\n    this.eventConf.label ['width'] = labelsSize;\n    this.eventConf  ['range'] = {\n      start: moment.tz(moment.utc(this.minTick / this.divider), this._options.timeZone).toDate(),\n      end: moment.tz(moment.utc(this.maxTick / this.divider), this._options.timeZone).toDate(),\n    };\n    return dataList;\n  }\n}\n","import {Component, ElementRef, EventEmitter, Input, NgZone, Output, Renderer2} from '@angular/core';\nimport {WarpViewComponent} from '../warp-view-component';\nimport {Size, SizeService} from '../../services/resize.service';\nimport {Logger} from '../../utils/logger';\nimport {Param} from '../../model/param';\nimport {DataModel} from '../../model/dataModel';\nimport {ChartLib} from '../../utils/chart-lib';\nimport {ResizedEvent} from 'angular-resize-event';\nimport {GTSLib} from '../../utils/gts.lib';\n\n@Component({\n  selector: 'warpview-result-tile',\n  templateUrl: './warp-view-result-tile.component.html',\n  styleUrls: ['./warp-view-result-tile.component.scss']\n})\nexport class WarpViewResultTileComponent extends WarpViewComponent {\n\n  @Input('type') set type(type: string) {\n    this._type = type;\n  }\n\n  get type(): string {\n    if (this.dataModel && this.dataModel.globalParams) {\n      return this.dataModel.globalParams.type || this._options.type || this._type || 'plot';\n    } else {\n      return this._type || 'plot';\n    }\n  }\n\n  @Input('standalone') standalone = true;\n\n  @Output('pointHover') pointHover = new EventEmitter<any>();\n  @Output('warpViewChartResize') warpViewChartResize = new EventEmitter<any>();\n  @Output('chartDraw') chartDraw = new EventEmitter<any>();\n  @Output('boundsDidChange') boundsDidChange = new EventEmitter<any>();\n  @Output('warpViewNewOptions') warpViewNewOptions = new EventEmitter<any>();\n\n  loading = true;\n  dataModel: DataModel;\n  graphs = {\n    spectrum: ['histogram2dcontour', 'histogram2d'],\n    chart: ['line', 'spline', 'step', 'step-after', 'step-before', 'area', 'scatter'],\n    pie: ['pie', 'donut'],\n    polar: ['polar'],\n    radar: ['radar'],\n    bar: ['bar'],\n    bubble: ['bubble'],\n    annotation: ['annotation'],\n    'gts-tree': ['gts-tree'],\n    datagrid: ['datagrid'],\n    display: ['display'],\n    drilldown: ['drilldown'],\n    image: ['image'],\n    map: ['map'],\n    gauge: ['gauge', 'bullet'],\n    plot: ['plot'],\n    box: ['box', 'box-date'],\n    line3d: ['line3d'],\n    globe: ['globe'],\n    drops: ['drops']\n  };\n\n  private _type;\n  private isRefresh = false;\n\n  constructor(\n    public el: ElementRef,\n    public renderer: Renderer2,\n    public sizeService: SizeService,\n    public ngZone: NgZone\n  ) {\n    super(el, renderer, sizeService, ngZone);\n    this.LOG = new Logger(WarpViewResultTileComponent, this._debug);\n  }\n\n  protected update(options: Param, refresh: boolean): void {\n    setTimeout(() => this.loading = !refresh);\n    this.LOG.debug(['parseGTS', 'data'], this._data);\n    this.dataModel = this._data;\n    if (!!this.dataModel) {\n      this._options = ChartLib.mergeDeep(this._options, options) as Param;\n      this._options = ChartLib.mergeDeep(ChartLib.mergeDeep(this.defOptions, options),\n        this._data ? this._data.globalParams || {} : {}) as Param;\n      this.LOG.debug(['parseGTS', 'data'], this._data);\n      this.dataModel = this._data;\n      if (this._options) {\n        this._unit = this._options.unit || this._unit;\n        this._type = this._options.type || this._type || 'plot';\n      }\n      this.LOG.debug(['parseGTS', '_type'], this._type);\n      setTimeout(() => this.loading = false);\n    }\n  }\n\n  protected convert(data: DataModel): Partial<any>[] {\n    setTimeout(() => this.loading = !this.isRefresh);\n    this.LOG.debug(['convert', 'data'], this._data, data);\n    this.dataModel = data;\n    if (this.dataModel.globalParams) {\n      this._unit = this.dataModel.globalParams.unit || this._unit;\n      this._type = this.dataModel.globalParams.type || this._type || 'plot';\n    }\n    this.LOG.debug(['convert', '_type'], this._type);\n    return [];\n  }\n\n  onResized(event: ResizedEvent) {\n    this.width = event.newWidth;\n    this.height = event.newHeight;\n    this.LOG.debug(['onResized'], event.newWidth, event.newHeight);\n    this.sizeService.change(new Size(this.width, this.height));\n  }\n\n  chartDrawn() {\n    this.LOG.debug(['chartDrawn']);\n    setTimeout(() => this.loading = false);\n    this.chartDraw.emit();\n  }\n\n  setResult(data: string, isRefresh: boolean) {\n    this.isRefresh = isRefresh;\n    if (data) {\n      this._data = GTSLib.getData(data);\n      this._options.isRefresh = isRefresh;\n      this.update(this._options, isRefresh);\n      this.LOG.debug(['onData'], this._data);\n    }\n  }\n\n  onWarpViewNewOptions(opts) {\n    this.warpViewNewOptions.emit(opts);\n  }\n}\n","/*\n *  Copyright 2020  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */\n\nimport {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {WarpViewChartComponent} from './elements/warp-view-chart/warp-view-chart.component';\nimport {WarpViewTileComponent} from './elements/warp-view-tile/warp-view-tile.component';\nimport {WarpViewSpinnerComponent} from './elements/warp-view-spinner/warp-view-spinner.component';\nimport {HttpClientModule} from '@angular/common/http';\nimport {HttpErrorHandler} from './services/http-error-handler.service';\nimport {WarpViewToggleComponent} from './elements/warp-view-toggle/warp-view-toggle.component';\nimport {WarpViewBarComponent} from './elements/warp-view-bar/warp-view-bar.component';\nimport {WarpViewBubbleComponent} from './elements/warp-view-bubble/warp-view-bubble.component';\nimport {WarpViewDatagridComponent} from './elements/warp-view-datagrid/warp-view-datagrid.component';\nimport {WarpViewPaginableComponent} from './elements/warp-view-datagrid/warp-view-paginable/warp-view-paginable.component';\nimport {WarpViewDisplayComponent} from './elements/warp-view-display/warp-view-display.component';\nimport {WarpViewDrillDownComponent} from './elements/warp-view-drill-down/warp-view-drill-down.component';\nimport {CalendarHeatmapComponent} from './elements/warp-view-drill-down/calendar-heatmap/calendar-heatmap.component';\nimport {WarpViewGtsPopupComponent} from './elements/warp-view-gts-popup/warp-view-gts-popup.component';\nimport {WarpViewModalComponent} from './elements/warp-view-modal/warp-view-modal.component';\nimport {WarpViewGtsTreeComponent} from './elements/warp-view-gts-tree/warp-view-gts-tree.component';\nimport {WarpViewTreeViewComponent} from './elements/warp-view-gts-tree/warp-view-tree-view/warp-view-tree-view.component';\nimport {WarpViewChipComponent} from './elements/warp-view-gts-tree/warp-view-chip/warp-view-chip.component';\nimport {WarpViewImageComponent} from './elements/warp-view-image/warp-view-image.component';\nimport {WarpViewMapComponent} from './elements/warp-view-map/warp-view-map.component';\nimport {WarpViewHeatmapSlidersComponent} from './elements/warp-view-map/warp-view-heatmap-sliders/warp-view-heatmap-sliders.component';\nimport {WarpViewPieComponent} from './elements/warp-view-pie/warp-view-pie.component';\nimport {WarpViewGaugeComponent} from './elements/warp-view-gauge/warp-view-gauge.component';\nimport {WarpViewAnnotationComponent} from './elements/warp-view-annotation/warp-view-annotation.component';\nimport {WarpViewPolarComponent} from './elements/warp-view-polar/warp-view-polar.component';\nimport {WarpViewRadarComponent} from './elements/warp-view-radar/warp-view-radar.component';\nimport {WarpViewPlotComponent} from './elements/warp-view-plot/warp-view-plot.component';\nimport {WarpViewResizeComponent} from './elements/warp-view-resize/warp-view-resize.component';\nimport {WarpViewSliderComponent} from './elements/warp-view-slider/warp-view-slider.component';\nimport {WarpViewRangeSliderComponent} from './elements/warp-view-range-slider/warp-view-range-slider.component';\nimport {FormsModule} from '@angular/forms';\nimport {AngularResizedEventModule} from 'angular-resize-event';\nimport {SizeService} from './services/resize.service';\nimport {WarpViewSpectrumComponent} from './elements/warp-view-spectrum/warp-view-spectrum.component';\nimport {PlotlyComponent} from './plotly/plotly.component';\nimport {WarpViewBoxComponent} from './elements/warp-view-box/warp-view-box.component';\nimport {WarpView3dLineComponent} from './elements/warp-view-3d-line/warp-view-3d-line.component';\nimport {WarpViewGlobeComponent} from './elements/warp-view-globe/warp-view-globe.component';\nimport {WarpViewEventDropComponent} from './elements/warp-view-event-drop/warp-view-event-drop.component';\nimport {WarpViewResultTileComponent} from './elements/warp-view-result-tile/warp-view-result-tile.component';\n\n@NgModule({\n  declarations: [\n    WarpViewTileComponent,\n    WarpViewChartComponent,\n    WarpViewSpinnerComponent,\n    WarpViewToggleComponent,\n    WarpViewBarComponent,\n    WarpViewBubbleComponent,\n    WarpViewDatagridComponent,\n    WarpViewPaginableComponent,\n    WarpViewDisplayComponent,\n    WarpViewDrillDownComponent,\n    CalendarHeatmapComponent,\n    WarpViewGtsPopupComponent,\n    WarpViewModalComponent,\n    WarpViewGtsTreeComponent,\n    WarpViewTreeViewComponent,\n    WarpViewChipComponent,\n    WarpViewImageComponent,\n    WarpViewMapComponent,\n    WarpViewHeatmapSlidersComponent,\n    WarpViewPieComponent,\n    WarpViewGaugeComponent,\n    WarpViewAnnotationComponent,\n    WarpViewPolarComponent,\n    WarpViewRadarComponent,\n    WarpViewPlotComponent,\n    WarpViewResizeComponent,\n    WarpViewSliderComponent,\n    WarpViewRangeSliderComponent,\n    WarpViewSpectrumComponent,\n    PlotlyComponent,\n    WarpViewBoxComponent,\n    WarpView3dLineComponent,\n    WarpViewGlobeComponent,\n    WarpViewEventDropComponent,\n    WarpViewResultTileComponent\n  ],\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    AngularResizedEventModule,\n    FormsModule\n  ],\n  exports: [\n    WarpViewTileComponent,\n    WarpViewChartComponent,\n    WarpViewSpinnerComponent,\n    WarpViewToggleComponent,\n    WarpViewBarComponent,\n    WarpViewBubbleComponent,\n    WarpViewDatagridComponent,\n    WarpViewPaginableComponent,\n    WarpViewDisplayComponent,\n    WarpViewDrillDownComponent,\n    CalendarHeatmapComponent,\n    WarpViewGtsPopupComponent,\n    WarpViewModalComponent,\n    WarpViewGtsTreeComponent,\n    WarpViewTreeViewComponent,\n    WarpViewChipComponent,\n    WarpViewImageComponent,\n    WarpViewMapComponent,\n    WarpViewHeatmapSlidersComponent,\n    WarpViewPieComponent,\n    WarpViewGaugeComponent,\n    WarpViewAnnotationComponent,\n    WarpViewPolarComponent,\n    WarpViewRadarComponent,\n    WarpViewPlotComponent,\n    WarpViewResizeComponent,\n    WarpViewSliderComponent,\n    WarpViewRangeSliderComponent,\n    WarpViewSpectrumComponent,\n    WarpViewBoxComponent,\n    WarpView3dLineComponent,\n    WarpViewGlobeComponent,\n    WarpViewEventDropComponent,\n    WarpViewResultTileComponent\n  ],\n  providers: [HttpErrorHandler, SizeService],\n  entryComponents: [\n    WarpViewTileComponent,\n    WarpViewChartComponent,\n    WarpViewSpinnerComponent,\n    WarpViewToggleComponent,\n    WarpViewBarComponent,\n    WarpViewBubbleComponent,\n    WarpViewDatagridComponent,\n    WarpViewPaginableComponent,\n    WarpViewDisplayComponent,\n    WarpViewDrillDownComponent,\n    CalendarHeatmapComponent,\n    WarpViewGtsPopupComponent,\n    WarpViewModalComponent,\n    WarpViewGtsTreeComponent,\n    WarpViewTreeViewComponent,\n    WarpViewChipComponent,\n    WarpViewImageComponent,\n    WarpViewMapComponent,\n    WarpViewHeatmapSlidersComponent,\n    WarpViewPieComponent,\n    WarpViewGaugeComponent,\n    WarpViewAnnotationComponent,\n    WarpViewPolarComponent,\n    WarpViewRadarComponent,\n    WarpViewPlotComponent,\n    WarpViewResizeComponent,\n    WarpViewSliderComponent,\n    WarpViewRangeSliderComponent,\n    WarpViewSpectrumComponent,\n    PlotlyComponent,\n    WarpViewBoxComponent,\n    WarpView3dLineComponent,\n    WarpViewGlobeComponent,\n    WarpViewEventDropComponent,\n    WarpViewResultTileComponent\n  ]\n})\nexport class WarpViewAngularModule {\n}\n"]}