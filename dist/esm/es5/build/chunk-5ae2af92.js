var LEVEL,Logger=function(){function t(t,n){void 0===n&&(n=!1),this.isDebug=!1,this.className=t.name,this.isDebug=n}return t.prototype.log=function(t,n,r){var e=[];switch(e.push("["+this.className+"] "+n.join(" - ")),e=e.concat(r),t){case LEVEL.DEBUG:this.isDebug&&console.debug.apply(console,e);break;case LEVEL.ERROR:console.error.apply(console,e);break;case LEVEL.INFO:console.log.apply(console,e);break;case LEVEL.WARN:console.warn.apply(console,e);break;default:this.isDebug&&console.log.apply(console,e)}},t.prototype.debug=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.log(LEVEL.DEBUG,t,n)},t.prototype.error=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.log(LEVEL.ERROR,t,n)},t.prototype.warn=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.log(LEVEL.WARN,t,n)},t.prototype.info=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.log(LEVEL.INFO,t,n)},t}();!function(t){t[t.DEBUG=0]="DEBUG",t[t.ERROR=1]="ERROR",t[t.WARN=2]="WARN",t[t.INFO=3]="INFO"}(LEVEL||(LEVEL={}));var DataModel=function(){},GTSLib=function(){function t(){}return t.cleanArray=function(t){return t.filter(function(t){return!!t})},t.unique=function(t){for(var n={},r=[],e=0,s=t.length;e<s;++e)n.hasOwnProperty(t[e])||(r.push(t[e]),n[t[e]]=1);return r},t.isArray=function(t){return t&&"object"==typeof t&&t instanceof Array&&"number"==typeof t.length&&"function"==typeof t.splice&&!t.propertyIsEnumerable("length")},t.isValidResponse=function(n){var r;try{r=JSON.parse(n)}catch(t){return this.LOG.error(["isValidResponse"],"Response non JSON compliant",n),!1}return!!t.isArray(r)||(this.LOG.error(["isValidResponse"],"Response isn't an Array",r),!1)},t.isEmbeddedImage=function(t){return!("string"!=typeof t||!/^data:image/.test(t))},t.isEmbeddedImageObject=function(n){return!(null===n||null===n.image||null===n.caption||!t.isEmbeddedImage(n.image))},t.isPositionArray=function(n){if(!n||!n.positions)return!1;if(t.isPositionsArrayWithValues(n)||t.isPositionsArrayWithTwoValues(n))return!0;for(var r in n.positions){if(n.positions[r].length<2||n.positions[r].length>3)return!1;for(var e in n.positions[r])if("number"!=typeof n.positions[r][e])return!1}return!0},t.isPositionsArrayWithValues=function(t){if(null===t||null===t.positions)return!1;for(var n in t.positions){if(3!==t.positions[n].length)return!1;for(var r in t.positions[n])if("number"!=typeof t.positions[n][r])return!1}return!0},t.isPositionsArrayWithTwoValues=function(t){if(null===t||null===t.positions)return!1;for(var n in t.positions){if(4!==t.positions[n].length)return!1;for(var r in t.positions[n])if("number"!=typeof t.positions[n][r])return!1}return!0},t.gtsFromJSON=function(t,n){return{gts:{c:t.c,l:t.l,a:t.a,v:t.v,id:n}}},t.gtsFromJSONList=function(n,r){var e,s=[];return(n||[]).forEach(function(n,a){var o=n;n.gts&&(o=n.gts),e=void 0!==r&&""!==r?r+"-"+a:a,t.isArray(o)&&s.push(t.gtsFromJSONList(o,e)),t.isGts(o)&&s.push(t.gtsFromJSON(o,e)),t.isEmbeddedImage(o)&&s.push({image:o,caption:"Image",id:e}),t.isEmbeddedImageObject(o)&&s.push({image:o.image,caption:o.caption,id:e})}),{content:s||[]}},t.flatDeep=function(n){return t.isArray(n)||(n=[n]),n.reduce(function(n,r){return Array.isArray(r)?n.concat(t.flatDeep(r)):n.concat(r)},[])},t.flattenGtsIdArray=function(n,r){var e=[];return t.isGts(n)&&(n=[n]),n.forEach(function(n){if(t.isArray(n)){var s=t.flattenGtsIdArray(n,r);e.push(s.res),r=s.r}else n.v&&(n.id=r,e.push(n),r++)}),{res:e,r:r}},t.sanitizeNames=function(t){return t.replace(/{/g,"&#123;").replace(/}/g,"&#125;").replace(/,/g,"&#44;").replace(/>/g,"&#62;").replace(/</g,"&#60;").replace(/"/g,"&#34;").replace(/'/g,"&#39;")},t.serializeGtsMetadata=function(t){var n=this,r=[],e=[];return t.l&&Object.keys(t.l).forEach(function(e){r.push(n.sanitizeNames(e+"="+t.l[e]))}),t.a&&Object.keys(t.a).forEach(function(r){e.push(n.sanitizeNames(r+"="+t.a[r]))}),this.sanitizeNames(t.c)+"{"+r.join(",")+(e.length>0?",":"")+e.join(",")+"}"},t.gtsToPath=function(t,n){void 0===n&&(n=1e3);for(var r=[],e=0;e<t.v.length;e++){var s=t.v[e];4===s.length&&r.push({ts:Math.floor(s[0]/n),lat:s[1],lon:s[2],val:s[3]}),5===s.length&&r.push({ts:Math.floor(s[0]/n),lat:s[1],lon:s[2],elev:s[3],val:s[4]})}return r},t.equalMetadata=function(t,n){if(!(void 0!==t.c&&void 0!==n.c&&void 0!==t.l&&void 0!==n.l&&t.l instanceof Object&&n.l instanceof Object))return this.LOG.error(["equalMetadata"],"Error in GTS, metadata is not well formed"),!1;if(t.c!==n.c)return!1;for(var r in t.l)if(!n.l.hasOwnProperty(r)||t.l[r]!==n.l[r])return!1;for(var r in n.l)if(!t.l.hasOwnProperty(r))return!1;return!0},t.isGts=function(n){return!(!n||null===n.c||null===n.l||null===n.a||null===n.v||!t.isArray(n.v))},t.isGtsToPlot=function(n){if(!t.isGts(n)||0===n.v.length)return!1;for(var r=0;r<n.v.length;r++)if(null!==n.v[r][n.v[r].length-1]){if("number"==typeof n.v[r][n.v[r].length-1]||void 0!==n.v[r][n.v[r].length-1].constructor.prototype.toFixed)return!0;break}return!1},t.isGtsToAnnotate=function(n){if(!t.isGts(n)||0===n.v.length)return!1;for(var r=0;r<n.v.length;r++)if(null!==n.v[r][n.v[r].length-1]){if("number"!=typeof n.v[r][n.v[r].length-1]&&n.v[r][n.v[r].length-1].constructor&&"Big"!==n.v[r][n.v[r].length-1].constructor.name&&void 0===n.v[r][n.v[r].length-1].constructor.prototype.toFixed)return!0;break}return!1},t.gtsSort=function(t){t.isSorted||(t.v=t.v.sort(function(t,n){return t[0]-n[0]}),t.isSorted=!0)},t.getData=function(n){return"string"==typeof n?t.getData(JSON.parse(n)):n&&n.hasOwnProperty("data")?n:t.isArray(n)&&n.length>0&&n[0].data?n[0]:t.isArray(n)?{data:n}:new DataModel},t.getDivider=function(t){var n=1e3;return"ms"===t&&(n=1),"ns"===t&&(n=1e6),n},t}();GTSLib.LOG=new Logger(GTSLib),GTSLib.formatLabel=function(t){var n=t.split("{"),r="<span class=\"gtsInfo\"><span class='gts-classname'>"+n[0]+"</span>";if(n.length>1){r+="<span class='gts-separator'>{</span>";var e=n[1].substr(0,n[1].length-1).split(",");e.length>0&&e.forEach(function(t,n){var s=t.split("=");t.length>1&&(r+="<span><span class='gts-labelname'>"+s[0]+"</span><span class='gts-separator'>=</span><span class='gts-labelvalue'>"+s[1]+"</span>",n!==e.length-1&&(r+="<span>, </span>"))}),r+="<span class='gts-separator'>}</span>"}if(n.length>2){r+="<span class='gts-separator'>{</span>";var s=n[2].substr(0,n[2].length-1).split(",");s.length>0&&s.forEach(function(t,n){var e=t.split("=");t.length>1&&(r+="<span><span class='gts-attrname'>"+e[0]+"</span><span class='gts-separator'>=</span><span class='gts-attrvalue'>"+e[1]+"</span>",n!==s.length-1&&(r+="<span>, </span>"))}),r+="<span class='gts-separator'>}</span>"}return r+="</span>"};export{GTSLib as a,Logger as b,DataModel as c};