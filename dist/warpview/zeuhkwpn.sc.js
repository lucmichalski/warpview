/*! Built with http://stenciljs.com */
const{h:t}=window.warpview;import{b as a,a as e}from"./chunk-18306f64.js";import{b as s,a as i,c as h}from"./chunk-32614226.js";import{a as r}from"./chunk-07b61ac6.js";class d{constructor(){this.responsive=!1,this.showLegend=!0,this.options=new s,this.width="",this.height="",this.elemsCount=15,this.page=0,this.LOG=new i(d),this._options={timeMode:"date"},this._data=[]}onData(t,a){a!==t&&(this.LOG.debug(["data"],t),this.drawChart())}onOptions(t,a){a!==t&&(this.LOG.debug(["options"],t),this.drawChart())}drawChart(){if(this._options=h.mergeDeep(this._options,this.options),this.LOG.debug(["drawChart","_options"],this._options),this.height=(this.responsive?this.el.parentElement.clientHeight:this.height||600)+"",this.width=(this.responsive?this.el.parentElement.clientWidth:this.width||800)+"",!this.data)return;let t,s=this.data;"string"==typeof s&&(s=JSON.parse(s)),e.isArray(s)&&s[0]&&(s[0]instanceof a||s[0].hasOwnProperty("data"))&&(s=s[0]),t=s instanceof a||s.hasOwnProperty("data")?s.data:s,this._data=this.parseData(e.flatDeep(t)),this.LOG.debug(["drawChart","_data"],this._data)}getHeaderParam(t,a,e,s){return this.data.params&&this.data.params[t]&&this.data.params[t][e]&&this.data.params[t][e][a]?this.data.params[t][e][a]:this.data.globalParams&&this.data.globalParams[e]&&this.data.globalParams[e][a]?this.data.globalParams[e][a]:s}parseData(t){const a=[];return this.LOG.debug(["parseData"],t),t.forEach((t,s)=>{let i={name:"",values:[],headers:[]};e.isGts(t)?(this.LOG.debug(["parseData","isGts"],t),i.name=e.serializeGtsMetadata(t),i.values=t.v):(this.LOG.debug(["parseData","is not a Gts"],t),i.values=e.isArray(t)?t:[t]),i.headers=[this.getHeaderParam(s,0,"headers","Date")],t.v.length>0&&t.v[0].length>2&&i.headers.push(this.getHeaderParam(s,1,"headers","Latitude")),t.v.length>0&&t.v[0].length>3&&i.headers.push(this.getHeaderParam(s,2,"headers","Longitude")),t.v.length>0&&t.v[0].length>4&&i.headers.push(this.getHeaderParam(s,3,"headers","Elevation")),i.headers.push(this.getHeaderParam(s,t.v[0].length-1,"headers","Value")),a.push(i)}),this.LOG.debug(["parseData","flatData"],a),a}componentWillLoad(){this.drawChart()}render(){return t("div",{class:"wrapper"},this._data.map(a=>t("warp-view-paginable",{data:a,options:this._options})))}static get is(){return"warp-view-datagrid"}static get encapsulation(){return"shadow"}static get properties(){return{_data:{state:!0},data:{type:String,attr:"data",watchCallbacks:["onData"]},el:{elementRef:!0},elemsCount:{type:Number,attr:"elems-count"},height:{type:String,attr:"height",mutable:!0},options:{type:"Any",attr:"options",watchCallbacks:["onOptions"]},page:{state:!0},responsive:{type:Boolean,attr:"responsive"},showLegend:{type:Boolean,attr:"show-legend"},width:{type:String,attr:"width",mutable:!0}}}static get style(){return"/*!\n *  Copyright 2018  SenX S.A.S.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n *\n */"}}class n{constructor(){this.options=new s,this.elemsCount=15,this.page=0,this.pages=[],this.displayedValues=[],this.LOG=new i(n),this._options={timeMode:"date"},this.windowed=5}formatDate(t){return"date"===this._options.timeMode?r.utc(t/1e3).toISOString():t.toString()}goto(t){this.page=t,this.drawGridData()}next(){this.page=Math.min(this.page+1,this._data.values.length-1),this.drawGridData()}prev(){this.page=Math.max(this.page-1,0),this.drawGridData()}drawGridData(){if(this._options=h.mergeDeep(this._options,this.options),this.LOG.debug(["drawGridData","_options"],this._options),this.data){this.pages=[];for(let t=0;t<this.data.values.length/this.elemsCount;t++)this.pages.push(t);this._data=Object.assign({},this.data),this.displayedValues=this._data.values.slice(Math.max(0,this.elemsCount*this.page),Math.min(this.elemsCount*(this.page+1),this._data.values.length)),this.LOG.debug(["drawGridData","_data"],this.data)}}componentWillLoad(){this.drawGridData()}render(){return t("div",{class:"wrapper"},this._data?t("div",null,t("div",{class:"heading",innerHTML:e.formatLabel(this._data.name)}),t("table",null,t("thead",null,this._data.headers.map(a=>t("th",null,a))),t("tbody",null,this.displayedValues.map((a,e)=>t("tr",{class:e%2==0?"odd":"even"},a.map((a,e)=>t("td",null,0===e?this.formatDate(a):a)))))),t("div",{class:"center"},t("div",{class:"pagination"},0!==this.page?t("div",{class:"prev hoverable",onClick:()=>this.prev()},"<"):"",this.page-this.windowed>0?t("div",{class:"index disabled"},"..."):"",this.pages.map(a=>a>=this.page-this.windowed&&a<=this.page+this.windowed?t("div",{class:"index "+(this.page===a?"active":"hoverable"),onClick:()=>this.goto(a)},a):""),this.page+this.windowed<this.pages.length?t("div",{class:"index disabled"},"..."):"",this.page!==this._data.values.length-1?t("div",{class:"next hoverable",onClick:()=>this.next()},">"):""))):"")}static get is(){return"warp-view-paginable"}static get encapsulation(){return"shadow"}static get properties(){return{data:{type:"Any",attr:"data"},elemsCount:{type:Number,attr:"elems-count"},options:{type:"Any",attr:"options"},page:{state:!0}}}static get style(){return"[data-warp-view-paginable-host]   table[data-warp-view-paginable]{width:100%;color:var(--warp-view-font-color,#000)}[data-warp-view-paginable-host]   table[data-warp-view-paginable]   td[data-warp-view-paginable], [data-warp-view-paginable-host]   table[data-warp-view-paginable]   th[data-warp-view-paginable]{padding:var(--warp-view-datagrid-cell-padding,5px)}[data-warp-view-paginable-host]   table[data-warp-view-paginable]   .odd[data-warp-view-paginable]{background-color:var(--warp-view-datagrid-odd-bg-color,#fff);color:var(--warp-view-datagrid-odd-color,#000)}[data-warp-view-paginable-host]   table[data-warp-view-paginable]   .even[data-warp-view-paginable]{background-color:var(--warp-view-datagrid-even-bg-color,#ddd);color:var(--warp-view-datagrid-even-color,#000)}[data-warp-view-paginable-host]   .center[data-warp-view-paginable]{text-align:center}[data-warp-view-paginable-host]   .center[data-warp-view-paginable]   .pagination[data-warp-view-paginable]{display:inline-block}[data-warp-view-paginable-host]   .center[data-warp-view-paginable]   .pagination[data-warp-view-paginable]   .index[data-warp-view-paginable], [data-warp-view-paginable-host]   .center[data-warp-view-paginable]   .pagination[data-warp-view-paginable]   .next[data-warp-view-paginable], [data-warp-view-paginable-host]   .center[data-warp-view-paginable]   .pagination[data-warp-view-paginable]   .prev[data-warp-view-paginable]{color:var(--warp-view-font-color,#000);float:left;padding:8px 16px;text-decoration:none;-webkit-transition:background-color .3s;transition:background-color .3s;border:1px solid var(--warp-view-pagination-border-color,#ddd);margin:0;cursor:pointer;background-color:var(--warp-view-pagination-bg-color,#fff)}[data-warp-view-paginable-host]   .center[data-warp-view-paginable]   .pagination[data-warp-view-paginable]   .index.active[data-warp-view-paginable], [data-warp-view-paginable-host]   .center[data-warp-view-paginable]   .pagination[data-warp-view-paginable]   .next.active[data-warp-view-paginable], [data-warp-view-paginable-host]   .center[data-warp-view-paginable]   .pagination[data-warp-view-paginable]   .prev.active[data-warp-view-paginable]{background-color:var(--warp-view-pagination-active-bg-color,#4caf50);color:var(--warp-view-pagination-active-color,#fff);border:1px solid var(--warp-view-pagination-active-border-color,#4caf50)}[data-warp-view-paginable-host]   .center[data-warp-view-paginable]   .pagination[data-warp-view-paginable]   .index.hoverable[data-warp-view-paginable]:hover, [data-warp-view-paginable-host]   .center[data-warp-view-paginable]   .pagination[data-warp-view-paginable]   .next.hoverable[data-warp-view-paginable]:hover, [data-warp-view-paginable-host]   .center[data-warp-view-paginable]   .pagination[data-warp-view-paginable]   .prev.hoverable[data-warp-view-paginable]:hover{background-color:var(--warp-view-pagination-hover-bg-color,#ddd);color:var(--warp-view-pagination-hover-color,#000);border:1px solid var(--warp-view-pagination-hover-border-color,#ddd)}[data-warp-view-paginable-host]   .center[data-warp-view-paginable]   .pagination[data-warp-view-paginable]   .index.disabled[data-warp-view-paginable], [data-warp-view-paginable-host]   .center[data-warp-view-paginable]   .pagination[data-warp-view-paginable]   .next.disabled[data-warp-view-paginable], [data-warp-view-paginable-host]   .center[data-warp-view-paginable]   .pagination[data-warp-view-paginable]   .prev.disabled[data-warp-view-paginable]{cursor:auto;color:var(--warp-view-pagination-disabled-color,#ddd)}[data-warp-view-paginable-host]   .gts-classname[data-warp-view-paginable]{color:var(--gts-classname-font-color,#0074d9)}[data-warp-view-paginable-host]   .gts-labelname[data-warp-view-paginable]{color:var(--gts-labelname-font-color,#19a979)}[data-warp-view-paginable-host]   .gts-attrname[data-warp-view-paginable]{color:var(--gts-labelname-font-color,#ed4a7b)}[data-warp-view-paginable-host]   .gts-separator[data-warp-view-paginable]{color:var(--gts-separator-font-color,#bbb)}[data-warp-view-paginable-host]   .gts-labelvalue[data-warp-view-paginable]{color:var(--gts-labelvalue-font-color,#aaa);font-style:italic}[data-warp-view-paginable-host]   .gts-attrvalue[data-warp-view-paginable]{color:var(--gts-labelvalue-font-color,#aaa);font-style:italic}[data-warp-view-paginable-host]   .round[data-warp-view-paginable]{border-radius:50%;background-color:#bbb;display:inline-block;width:12px;height:12px;border:2px solid #454545}[data-warp-view-paginable-host]   ul[data-warp-view-paginable]{list-style:none}"}}export{d as WarpViewDatagrid,n as WarpViewPaginable};